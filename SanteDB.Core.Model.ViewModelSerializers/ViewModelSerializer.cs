//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace SanteDB.Core.Model.Json.Formatter {
    using SanteDB.Core.Model;
    using System;


    /// <summary>Serializes <see cref="SanteDB.Core.Model.Subscription.SubscriptionDefinition"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class SubscriptionDefinitionViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Subscription.SubscriptionDefinition);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Subscription.SubscriptionDefinition _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Subscription.SubscriptionDefinition)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Subscription.SubscriptionDefinition)), e);
            }
            if (context.ShouldSerialize("uuid")) {
                context.JsonContext.WritePropertyUtil(w, "uuid", _strong.Uuid, context);
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("name")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("order")) {
                context.JsonContext.WritePropertyUtil(w, "order", _strong.Order, context);
            }
            if (context.ShouldSerialize("definitions")) {
                if (((_strong.ClientDefinitions == null) 
                            || (_strong.ClientDefinitions.Count == 0))) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "definitions", _strong.ClientDefinitions, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Subscription.SubscriptionDefinition _retVal = new SanteDB.Core.Model.Subscription.SubscriptionDefinition();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Subscription.SubscriptionDefinition))) {
                        return ((SanteDB.Core.Model.Subscription.SubscriptionDefinition)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "uuid":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Guid), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("uuid", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Uuid = ((System.Guid)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "order":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(int), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("order", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Order = ((int)(_instance));
                    }
                    break;
case "definitions":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Subscription.SubscriptionClientDefinition>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("definitions", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClientDefinitions = ((System.Collections.Generic.List<SanteDB.Core.Model.Subscription.SubscriptionClientDefinition>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Security.SecurityApplication"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class SecurityApplicationViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Security.SecurityApplication);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Security.SecurityApplication _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Security.SecurityApplication)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Security.SecurityApplication)), e);
            }
            if (context.ShouldSerialize("applicationSecret")) {
                if ((_strong.ApplicationSecret == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "applicationSecret", _strong.ApplicationSecret, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("lockout")) {
                if ((_strong.LockoutXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lockout", _strong.LockoutXml, context);
                }
            }
            if (context.ShouldSerialize("lockoutModel")) {
                if ((_strong.Lockout == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lockoutModel", _strong.Lockout, context);
                }
            }
            if (context.ShouldSerialize("invalidAuth")) {
                if ((_strong.InvalidAuthAttempts == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "invalidAuth", _strong.InvalidAuthAttempts, context);
                }
            }
            if (context.ShouldSerialize("lastAuthenticationTime")) {
                if ((_strong.LastAuthenticationXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lastAuthenticationTime", _strong.LastAuthenticationXml, context);
                }
            }
            if (context.ShouldSerialize("lastAuthenticationTimeModel")) {
                if ((_strong.LastAuthentication == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lastAuthenticationTimeModel", _strong.LastAuthentication, context);
                }
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Security.SecurityApplication _retVal = new SanteDB.Core.Model.Security.SecurityApplication();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Security.SecurityApplication))) {
                        return ((SanteDB.Core.Model.Security.SecurityApplication)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "applicationSecret":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("applicationSecret", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ApplicationSecret = ((string)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "lockout":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lockout", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LockoutXml = ((string)(_instance));
                    }
                    break;
case "lockoutModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lockoutModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Lockout = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "invalidAuth":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<int>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("invalidAuth", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.InvalidAuthAttempts = ((System.Nullable<int>)(_instance));
                    }
                    break;
case "lastAuthenticationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lastAuthenticationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LastAuthenticationXml = ((string)(_instance));
                    }
                    break;
case "lastAuthenticationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lastAuthenticationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LastAuthentication = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Security.SecurityChallenge"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class SecurityChallengeViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Security.SecurityChallenge);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Security.SecurityChallenge _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Security.SecurityChallenge)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Security.SecurityChallenge)), e);
            }
            if (context.ShouldSerialize("text")) {
                if ((_strong.ChallengeText == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "text", _strong.ChallengeText, context);
                }
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Security.SecurityChallenge _retVal = new SanteDB.Core.Model.Security.SecurityChallenge();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Security.SecurityChallenge))) {
                        return ((SanteDB.Core.Model.Security.SecurityChallenge)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "text":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("text", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ChallengeText = ((string)(_instance));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Security.SecurityDevice"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class SecurityDeviceViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Security.SecurityDevice);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Security.SecurityDevice _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Security.SecurityDevice)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Security.SecurityDevice)), e);
            }
            if (context.ShouldSerialize("deviceSecret")) {
                if ((_strong.DeviceSecret == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "deviceSecret", _strong.DeviceSecret, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("lockout")) {
                if ((_strong.LockoutXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lockout", _strong.LockoutXml, context);
                }
            }
            if (context.ShouldSerialize("lockoutModel")) {
                if ((_strong.Lockout == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lockoutModel", _strong.Lockout, context);
                }
            }
            if (context.ShouldSerialize("invalidAuth")) {
                if ((_strong.InvalidAuthAttempts == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "invalidAuth", _strong.InvalidAuthAttempts, context);
                }
            }
            if (context.ShouldSerialize("lastAuthenticationTime")) {
                if ((_strong.LastAuthenticationXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lastAuthenticationTime", _strong.LastAuthenticationXml, context);
                }
            }
            if (context.ShouldSerialize("lastAuthenticationTimeModel")) {
                if ((_strong.LastAuthentication == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lastAuthenticationTimeModel", _strong.LastAuthentication, context);
                }
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Security.SecurityDevice _retVal = new SanteDB.Core.Model.Security.SecurityDevice();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Security.SecurityDevice))) {
                        return ((SanteDB.Core.Model.Security.SecurityDevice)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "deviceSecret":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("deviceSecret", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeviceSecret = ((string)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "lockout":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lockout", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LockoutXml = ((string)(_instance));
                    }
                    break;
case "lockoutModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lockoutModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Lockout = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "invalidAuth":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<int>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("invalidAuth", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.InvalidAuthAttempts = ((System.Nullable<int>)(_instance));
                    }
                    break;
case "lastAuthenticationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lastAuthenticationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LastAuthenticationXml = ((string)(_instance));
                    }
                    break;
case "lastAuthenticationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lastAuthenticationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LastAuthentication = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Security.SecurityEntity"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class SecurityEntityViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Security.SecurityEntity);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Security.SecurityEntity _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Security.SecurityEntity)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Security.SecurityEntity)), e);
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Security.SecurityEntity _retVal = new SanteDB.Core.Model.Security.SecurityEntity();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Security.SecurityEntity))) {
                        return ((SanteDB.Core.Model.Security.SecurityEntity)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Security.SecurityPolicy"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class SecurityPolicyViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Security.SecurityPolicy);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Security.SecurityPolicy _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Security.SecurityPolicy)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Security.SecurityPolicy)), e);
            }
            if (context.ShouldSerialize("handler")) {
                if ((_strong.Handler == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "handler", _strong.Handler, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("oid")) {
                if ((_strong.Oid == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "oid", _strong.Oid, context);
                }
            }
            if (context.ShouldSerialize("isPublic")) {
                context.JsonContext.WritePropertyUtil(w, "isPublic", _strong.IsPublic, context);
            }
            if (context.ShouldSerialize("canOverride")) {
                context.JsonContext.WritePropertyUtil(w, "canOverride", _strong.CanOverride, context);
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Security.SecurityPolicy _retVal = new SanteDB.Core.Model.Security.SecurityPolicy();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Security.SecurityPolicy))) {
                        return ((SanteDB.Core.Model.Security.SecurityPolicy)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "handler":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("handler", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Handler = ((string)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "oid":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("oid", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Oid = ((string)(_instance));
                    }
                    break;
case "isPublic":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isPublic", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsPublic = ((bool)(_instance));
                    }
                    break;
case "canOverride":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("canOverride", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CanOverride = ((bool)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            string _strong = null;
            if ((o == null)) {
                return null;
            }
            try {
                _strong = o.ToString();
            }
            catch (System.Exception e) {
                return null;
            }
            SanteDB.Core.Model.Security.SecurityPolicy _retVal = new SanteDB.Core.Model.Security.SecurityPolicy();
            _retVal.Oid = _strong;
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            if ((o == null)) {
                return null;
            }
            SanteDB.Core.Model.Security.SecurityPolicy _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Security.SecurityPolicy)(o));
            }
            catch (System.Exception e) {
                return null;
            }
            return _strong.Oid;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Security.SecurityPolicyInstance"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class SecurityPolicyInstanceViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Security.SecurityPolicyInstance);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Security.SecurityPolicyInstance _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Security.SecurityPolicyInstance)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Security.SecurityPolicyInstance)), e);
            }
            if (context.ShouldSerialize("policy")) {
                if ((_strong.PolicyKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.PolicyKey, context);
                }
            }
            if (context.ShouldSerialize("policyModel")) {
                if ((_strong.Policy == null)) {
                    if ((_strong.PolicyKey.HasValue && context.ShouldForceLoad("policyModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityPolicy _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityPolicy>(_strong, "Policy");
                        if ((_delay != null)) {
                            _strong.Policy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policyModel", _strong.Policy, context);
                        }
                        else {
                            context.RegisterMissTarget("policyModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policyModel", _strong.Policy, context);
                }
            }
            if (context.ShouldSerialize("grant")) {
                context.JsonContext.WritePropertyUtil(w, "grant", _strong.GrantType, context);
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityEntity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityEntity>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Security.SecurityPolicyInstance _retVal = new SanteDB.Core.Model.Security.SecurityPolicyInstance();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Security.SecurityPolicyInstance))) {
                        return ((SanteDB.Core.Model.Security.SecurityPolicyInstance)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PolicyKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "policyModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityPolicy), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policyModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policy = ((SanteDB.Core.Model.Security.SecurityPolicy)(_instance));
                    }
                    break;
case "grant":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.PolicyGrantType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("grant", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GrantType = ((SanteDB.Core.Model.Security.PolicyGrantType)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityEntity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Security.SecurityEntity)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Security.SecurityProvenance"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class SecurityProvenanceViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Security.SecurityProvenance);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Security.SecurityProvenance _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Security.SecurityProvenance)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Security.SecurityProvenance)), e);
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("application")) {
                if ((_strong.ApplicationKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "application", _strong.ApplicationKey, context);
                }
            }
            if (context.ShouldSerialize("user")) {
                if ((_strong.UserKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "user", _strong.UserKey, context);
                }
            }
            if (context.ShouldSerialize("device")) {
                if ((_strong.DeviceKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "device", _strong.DeviceKey, context);
                }
            }
            if (context.ShouldSerialize("session")) {
                if ((_strong.SessionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "session", _strong.SessionKey, context);
                }
            }
            if (context.ShouldSerialize("extern")) {
                if ((_strong.ExternalSecurityObjectRefKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extern", _strong.ExternalSecurityObjectRefKey, context);
                }
            }
            if (context.ShouldSerialize("externClass")) {
                if ((_strong.ExternalSecurityObjectRefType == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "externClass", _strong.ExternalSecurityObjectRefType, context);
                }
            }
            if (context.ShouldSerialize("deviceModel")) {
                if ((_strong.Device == null)) {
                    if ((_strong.DeviceKey.HasValue && context.ShouldForceLoad("deviceModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityDevice _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityDevice>(_strong, "Device");
                        if ((_delay != null)) {
                            _strong.Device = _delay;
                            context.JsonContext.WritePropertyUtil(w, "deviceModel", _strong.Device, context);
                        }
                        else {
                            context.RegisterMissTarget("deviceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "deviceModel", _strong.Device, context);
                }
            }
            if (context.ShouldSerialize("userModel")) {
                if ((_strong.User == null)) {
                    if ((_strong.UserKey.HasValue && context.ShouldForceLoad("userModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityUser _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityUser>(_strong, "User");
                        if ((_delay != null)) {
                            _strong.User = _delay;
                            context.JsonContext.WritePropertyUtil(w, "userModel", _strong.User, context);
                        }
                        else {
                            context.RegisterMissTarget("userModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "userModel", _strong.User, context);
                }
            }
            if (context.ShouldSerialize("applicationModel")) {
                if ((_strong.Application == null)) {
                    if ((_strong.ApplicationKey.HasValue && context.ShouldForceLoad("applicationModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityApplication _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityApplication>(_strong, "Application");
                        if ((_delay != null)) {
                            _strong.Application = _delay;
                            context.JsonContext.WritePropertyUtil(w, "applicationModel", _strong.Application, context);
                        }
                        else {
                            context.RegisterMissTarget("applicationModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "applicationModel", _strong.Application, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Security.SecurityProvenance _retVal = new SanteDB.Core.Model.Security.SecurityProvenance();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Security.SecurityProvenance))) {
                        return ((SanteDB.Core.Model.Security.SecurityProvenance)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "application":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("application", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ApplicationKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "user":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("user", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UserKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "device":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("device", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeviceKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "session":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("session", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SessionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "extern":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extern", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalSecurityObjectRefKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "externClass":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("externClass", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalSecurityObjectRefType = ((string)(_instance));
                    }
                    break;
case "deviceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityDevice), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("deviceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Device = ((SanteDB.Core.Model.Security.SecurityDevice)(_instance));
                    }
                    break;
case "userModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityUser), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("userModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.User = ((SanteDB.Core.Model.Security.SecurityUser)(_instance));
                    }
                    break;
case "applicationModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityApplication), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("applicationModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Application = ((SanteDB.Core.Model.Security.SecurityApplication)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Security.SecurityRole"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class SecurityRoleViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Security.SecurityRole);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Security.SecurityRole _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Security.SecurityRole)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Security.SecurityRole)), e);
            }
            if (context.ShouldSerialize("name")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("description")) {
                if ((_strong.Description == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "description", _strong.Description, context);
                }
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Security.SecurityRole _retVal = new SanteDB.Core.Model.Security.SecurityRole();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Security.SecurityRole))) {
                        return ((SanteDB.Core.Model.Security.SecurityRole)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "description":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("description", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Description = ((string)(_instance));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Security.SecurityUser"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class SecurityUserViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Security.SecurityUser);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Security.SecurityUser _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Security.SecurityUser)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Security.SecurityUser)), e);
            }
            if (context.ShouldSerialize("email")) {
                if ((_strong.Email == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "email", _strong.Email, context);
                }
            }
            if (context.ShouldSerialize("emailConfirmed")) {
                context.JsonContext.WritePropertyUtil(w, "emailConfirmed", _strong.EmailConfirmed, context);
            }
            if (context.ShouldSerialize("invalidLoginAttempts")) {
                context.JsonContext.WritePropertyUtil(w, "invalidLoginAttempts", _strong.InvalidLoginAttempts, context);
            }
            if (context.ShouldSerialize("lockoutModel")) {
                if ((_strong.Lockout == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lockoutModel", _strong.Lockout, context);
                }
            }
            if (context.ShouldSerialize("lockout")) {
                if ((_strong.LockoutXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lockout", _strong.LockoutXml, context);
                }
            }
            if (context.ShouldSerialize("password")) {
                if ((_strong.Password == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "password", _strong.Password, context);
                }
            }
            if (context.ShouldSerialize("securityStamp")) {
                if ((_strong.SecurityHash == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "securityStamp", _strong.SecurityHash, context);
                }
            }
            if (context.ShouldSerialize("twoFactorEnabled")) {
                context.JsonContext.WritePropertyUtil(w, "twoFactorEnabled", _strong.TwoFactorEnabled, context);
            }
            if (context.ShouldSerialize("userName")) {
                if ((_strong.UserName == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "userName", _strong.UserName, context);
                }
            }
            if (context.ShouldSerialize("photo")) {
                if ((_strong.UserPhoto == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "photo", _strong.UserPhoto, context);
                }
            }
            if (context.ShouldSerialize("lastLoginTimeModel")) {
                if ((_strong.LastLoginTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lastLoginTimeModel", _strong.LastLoginTime, context);
                }
            }
            if (context.ShouldSerialize("lastLoginTime")) {
                if ((_strong.LastLoginTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lastLoginTime", _strong.LastLoginTimeXml, context);
                }
            }
            if (context.ShouldSerialize("passwordExpiryModel")) {
                if ((_strong.PasswordExpiration == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "passwordExpiryModel", _strong.PasswordExpiration, context);
                }
            }
            if (context.ShouldSerialize("passwordExpiry")) {
                if ((_strong.PasswordExpirationXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "passwordExpiry", _strong.PasswordExpirationXml, context);
                }
            }
            if (context.ShouldSerialize("phoneNumber")) {
                if ((_strong.PhoneNumber == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "phoneNumber", _strong.PhoneNumber, context);
                }
            }
            if (context.ShouldSerialize("phoneNumberConfirmed")) {
                context.JsonContext.WritePropertyUtil(w, "phoneNumberConfirmed", _strong.PhoneNumberConfirmed, context);
            }
            if (context.ShouldSerialize("twoFactorMechanism")) {
                if ((_strong.TwoFactorMechnaismKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "twoFactorMechanism", _strong.TwoFactorMechnaismKey, context);
                }
            }
            if (context.ShouldSerialize("userClass")) {
                context.JsonContext.WritePropertyUtil(w, "userClass", _strong.UserClass, context);
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Security.SecurityUser _retVal = new SanteDB.Core.Model.Security.SecurityUser();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Security.SecurityUser))) {
                        return ((SanteDB.Core.Model.Security.SecurityUser)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "email":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("email", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Email = ((string)(_instance));
                    }
                    break;
case "emailConfirmed":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("emailConfirmed", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.EmailConfirmed = ((bool)(_instance));
                    }
                    break;
case "invalidLoginAttempts":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(int), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("invalidLoginAttempts", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.InvalidLoginAttempts = ((int)(_instance));
                    }
                    break;
case "lockoutModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lockoutModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Lockout = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "lockout":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lockout", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LockoutXml = ((string)(_instance));
                    }
                    break;
case "password":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("password", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Password = ((string)(_instance));
                    }
                    break;
case "securityStamp":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("securityStamp", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SecurityHash = ((string)(_instance));
                    }
                    break;
case "twoFactorEnabled":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("twoFactorEnabled", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TwoFactorEnabled = ((bool)(_instance));
                    }
                    break;
case "userName":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("userName", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UserName = ((string)(_instance));
                    }
                    break;
case "photo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(byte[]), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("photo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UserPhoto = ((byte[])(_instance));
                    }
                    break;
case "lastLoginTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lastLoginTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LastLoginTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "lastLoginTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lastLoginTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LastLoginTimeXml = ((string)(_instance));
                    }
                    break;
case "passwordExpiryModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("passwordExpiryModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PasswordExpiration = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "passwordExpiry":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("passwordExpiry", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PasswordExpirationXml = ((string)(_instance));
                    }
                    break;
case "phoneNumber":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("phoneNumber", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PhoneNumber = ((string)(_instance));
                    }
                    break;
case "phoneNumberConfirmed":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("phoneNumberConfirmed", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PhoneNumberConfirmed = ((bool)(_instance));
                    }
                    break;
case "twoFactorMechanism":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("twoFactorMechanism", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TwoFactorMechnaismKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "userClass":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Guid), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("userClass", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UserClass = ((System.Guid)(_instance));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Roles.Patient"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class PatientViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Roles.Patient);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Roles.Patient _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Roles.Patient)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Roles.Patient)), e);
            }
            if (context.ShouldSerialize("multipleBirthOrder")) {
                if ((_strong.MultipleBirthOrder == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "multipleBirthOrder", _strong.MultipleBirthOrder, context);
                }
            }
            if (context.ShouldSerialize("livingArrangement")) {
                if ((_strong.LivingArrangementKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "livingArrangement", _strong.LivingArrangementKey, context);
                }
            }
            if (context.ShouldSerialize("religion")) {
                if ((_strong.ReligiousAffiliationKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "religion", _strong.ReligiousAffiliationKey, context);
                }
            }
            if (context.ShouldSerialize("livingArrangementModel")) {
                if ((_strong.LivingArrangement == null)) {
                    if ((_strong.LivingArrangementKey.HasValue && context.ShouldForceLoad("livingArrangementModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "LivingArrangement");
                        if ((_delay != null)) {
                            _strong.LivingArrangement = _delay;
                            context.JsonContext.WritePropertyUtil(w, "livingArrangementModel", _strong.LivingArrangement, context);
                        }
                        else {
                            context.RegisterMissTarget("livingArrangementModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "livingArrangementModel", _strong.LivingArrangement, context);
                }
            }
            if (context.ShouldSerialize("religionModel")) {
                if ((_strong.ReligiousAffiliation == null)) {
                    if ((_strong.ReligiousAffiliationKey.HasValue && context.ShouldForceLoad("religionModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReligiousAffiliation");
                        if ((_delay != null)) {
                            _strong.ReligiousAffiliation = _delay;
                            context.JsonContext.WritePropertyUtil(w, "religionModel", _strong.ReligiousAffiliation, context);
                        }
                        else {
                            context.RegisterMissTarget("religionModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "religionModel", _strong.ReligiousAffiliation, context);
                }
            }
            if (context.ShouldSerialize("ethnicity")) {
                if ((_strong.EthnicGroupKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "ethnicity", _strong.EthnicGroupKey, context);
                }
            }
            if (context.ShouldSerialize("ethnicityModel")) {
                if ((_strong.EthnicGroup == null)) {
                    if ((_strong.EthnicGroupKey.HasValue && context.ShouldForceLoad("ethnicityModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "EthnicGroup");
                        if ((_delay != null)) {
                            _strong.EthnicGroup = _delay;
                            context.JsonContext.WritePropertyUtil(w, "ethnicityModel", _strong.EthnicGroup, context);
                        }
                        else {
                            context.RegisterMissTarget("ethnicityModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "ethnicityModel", _strong.EthnicGroup, context);
                }
            }
            if (context.ShouldSerialize("educationLevelModel")) {
                if ((_strong.EducationLevel == null)) {
                    if ((_strong.EducationLevelKey.HasValue && context.ShouldForceLoad("educationLevelModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "EducationLevel");
                        if ((_delay != null)) {
                            _strong.EducationLevel = _delay;
                            context.JsonContext.WritePropertyUtil(w, "educationLevelModel", _strong.EducationLevel, context);
                        }
                        else {
                            context.RegisterMissTarget("educationLevelModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "educationLevelModel", _strong.EducationLevel, context);
                }
            }
            if (context.ShouldSerialize("educationLevel")) {
                if ((_strong.EducationLevelKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "educationLevel", _strong.EducationLevelKey, context);
                }
            }
            if (context.ShouldSerialize("dateOfBirthPrecision")) {
                if ((_strong.DateOfBirthPrecision == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "dateOfBirthPrecision", _strong.DateOfBirthPrecision, context);
                }
            }
            if (context.ShouldSerialize("genderConcept")) {
                if ((_strong.GenderConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "genderConcept", _strong.GenderConceptKey, context);
                }
            }
            if (context.ShouldSerialize("genderConceptModel")) {
                if ((_strong.GenderConcept == null)) {
                    if ((_strong.GenderConceptKey.HasValue && context.ShouldForceLoad("genderConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "GenderConcept");
                        if ((_delay != null)) {
                            _strong.GenderConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "genderConceptModel", _strong.GenderConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("genderConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "genderConceptModel", _strong.GenderConcept, context);
                }
            }
            if (context.ShouldSerialize("dateOfBirth")) {
                if ((_strong.DateOfBirthXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "dateOfBirth", _strong.DateOfBirthXml, context);
                }
            }
            if (context.ShouldSerialize("language")) {
                if (((_strong.LanguageCommunication == null) 
                            || (_strong.LanguageCommunication.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("language", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.PersonLanguageCommunication> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.PersonLanguageCommunication>(_strong, "LanguageCommunication"));
                        if ((_delay.Count > 0)) {
                            _strong.LanguageCommunication = _delay;
                            context.JsonContext.WritePropertyUtil(w, "language", _strong.LanguageCommunication, context);
                        }
                        else {
                            context.RegisterMissTarget("language", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "language", _strong.LanguageCommunication, context);
                }
            }
            if (context.ShouldSerialize("occupation")) {
                if ((_strong.OccupationKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "occupation", _strong.OccupationKey, context);
                }
            }
            if (context.ShouldSerialize("occupationModel")) {
                if ((_strong.Occupation == null)) {
                    if ((_strong.OccupationKey.HasValue && context.ShouldForceLoad("occupationModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Occupation");
                        if ((_delay != null)) {
                            _strong.Occupation = _delay;
                            context.JsonContext.WritePropertyUtil(w, "occupationModel", _strong.Occupation, context);
                        }
                        else {
                            context.RegisterMissTarget("occupationModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "occupationModel", _strong.Occupation, context);
                }
            }
            if (context.ShouldSerialize("maritalStatusModel")) {
                if ((_strong.MaritalStatus == null)) {
                    if ((_strong.MaritalStatusKey.HasValue && context.ShouldForceLoad("maritalStatusModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MaritalStatus");
                        if ((_delay != null)) {
                            _strong.MaritalStatus = _delay;
                            context.JsonContext.WritePropertyUtil(w, "maritalStatusModel", _strong.MaritalStatus, context);
                        }
                        else {
                            context.RegisterMissTarget("maritalStatusModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "maritalStatusModel", _strong.MaritalStatus, context);
                }
            }
            if (context.ShouldSerialize("maritalStatus")) {
                if ((_strong.MaritalStatusKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "maritalStatus", _strong.MaritalStatusKey, context);
                }
            }
            if (context.ShouldSerialize("deceasedDate")) {
                if ((_strong.DeceasedDateXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "deceasedDate", _strong.DeceasedDateXml, context);
                }
            }
            if (context.ShouldSerialize("deceasedDatePrecision")) {
                if ((_strong.DeceasedDatePrecision == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "deceasedDatePrecision", _strong.DeceasedDatePrecision, context);
                }
            }
            if (context.ShouldSerialize("vipStatus")) {
                if ((_strong.VipStatusKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "vipStatus", _strong.VipStatusKey, context);
                }
            }
            if (context.ShouldSerialize("vipStatusModel")) {
                if ((_strong.VipStatus == null)) {
                    if ((_strong.VipStatusKey.HasValue && context.ShouldForceLoad("vipStatusModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "VipStatus");
                        if ((_delay != null)) {
                            _strong.VipStatus = _delay;
                            context.JsonContext.WritePropertyUtil(w, "vipStatusModel", _strong.VipStatus, context);
                        }
                        else {
                            context.RegisterMissTarget("vipStatusModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "vipStatusModel", _strong.VipStatus, context);
                }
            }
            if (context.ShouldSerialize("nationality")) {
                if ((_strong.NationalityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "nationality", _strong.NationalityKey, context);
                }
            }
            if (context.ShouldSerialize("nationalityModel")) {
                if ((_strong.Nationality == null)) {
                    if ((_strong.NationalityKey.HasValue && context.ShouldForceLoad("nationalityModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Nationality");
                        if ((_delay != null)) {
                            _strong.Nationality = _delay;
                            context.JsonContext.WritePropertyUtil(w, "nationalityModel", _strong.Nationality, context);
                        }
                        else {
                            context.RegisterMissTarget("nationalityModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "nationalityModel", _strong.Nationality, context);
                }
            }
            if (context.ShouldSerialize("address")) {
                if (((_strong.Addresses == null) 
                            || (_strong.Addresses.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("address", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityAddress>(_strong, "Addresses"));
                        if ((_delay.Count > 0)) {
                            _strong.Addresses = _delay;
                            context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                        }
                        else {
                            context.RegisterMissTarget("address", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("creationActModel")) {
                if ((_strong.CreationAct == null)) {
                    if ((_strong.CreationActKey.HasValue && context.ShouldForceLoad("creationActModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "CreationAct");
                        if ((_delay != null)) {
                            _strong.CreationAct = _delay;
                            context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                        }
                        else {
                            context.RegisterMissTarget("creationActModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                }
            }
            if (context.ShouldSerialize("creationAct")) {
                if ((_strong.CreationActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationAct", _strong.CreationActKey, context);
                }
            }
            if (context.ShouldSerialize("determinerConceptModel")) {
                if ((_strong.DeterminerConcept == null)) {
                    if ((_strong.DeterminerConceptKey.HasValue && context.ShouldForceLoad("determinerConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DeterminerConcept");
                        if ((_delay != null)) {
                            _strong.DeterminerConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("determinerConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                }
            }
            if (context.ShouldSerialize("determinerConcept")) {
                if ((_strong.DeterminerConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConcept", _strong.DeterminerConceptKey, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.Names == null) 
                            || (_strong.Names.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityName>(_strong, "Names"));
                        if ((_delay.Count > 0)) {
                            _strong.Names = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("telecom")) {
                if (((_strong.Telecoms == null) 
                            || (_strong.Telecoms.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("telecom", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityTelecomAddress>(_strong, "Telecoms"));
                        if ((_delay.Count > 0)) {
                            _strong.Telecoms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                        }
                        else {
                            context.RegisterMissTarget("telecom", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                }
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Roles.Patient _retVal = new SanteDB.Core.Model.Roles.Patient();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Roles.Patient))) {
                        return ((SanteDB.Core.Model.Roles.Patient)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "multipleBirthOrder":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<int>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("multipleBirthOrder", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MultipleBirthOrder = ((System.Nullable<int>)(_instance));
                    }
                    break;
case "livingArrangement":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("livingArrangement", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LivingArrangementKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "religion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("religion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReligiousAffiliationKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "livingArrangementModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("livingArrangementModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LivingArrangement = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "religionModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("religionModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReligiousAffiliation = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "ethnicity":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("ethnicity", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.EthnicGroupKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "ethnicityModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("ethnicityModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.EthnicGroup = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "educationLevelModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("educationLevelModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.EducationLevel = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "educationLevel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("educationLevel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.EducationLevelKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "dateOfBirthPrecision":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("dateOfBirthPrecision", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DateOfBirthPrecision = ((System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>)(_instance));
                    }
                    break;
case "genderConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("genderConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GenderConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "genderConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("genderConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GenderConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "dateOfBirth":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("dateOfBirth", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DateOfBirthXml = ((string)(_instance));
                    }
                    break;
case "language":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.PersonLanguageCommunication>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("language", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LanguageCommunication = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.PersonLanguageCommunication>)(_instance));
                    }
                    break;
case "occupation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("occupation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.OccupationKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "occupationModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("occupationModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Occupation = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "maritalStatusModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("maritalStatusModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MaritalStatus = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "maritalStatus":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("maritalStatus", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MaritalStatusKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "deceasedDate":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("deceasedDate", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeceasedDateXml = ((string)(_instance));
                    }
                    break;
case "deceasedDatePrecision":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("deceasedDatePrecision", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeceasedDatePrecision = ((System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>)(_instance));
                    }
                    break;
case "vipStatus":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("vipStatus", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VipStatusKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "vipStatusModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("vipStatusModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VipStatus = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "nationality":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("nationality", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.NationalityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "nationalityModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("nationalityModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Nationality = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "address":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("address", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Addresses = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationActModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationActModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationAct = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "creationAct":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationAct", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "determinerConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "determinerConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Names = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>)(_instance));
                    }
                    break;
case "telecom":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("telecom", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Telecoms = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Roles.Provider"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ProviderViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Roles.Provider);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Roles.Provider _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Roles.Provider)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Roles.Provider)), e);
            }
            if (context.ShouldSerialize("providerSpecialty")) {
                if ((_strong.SpecialtyKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "providerSpecialty", _strong.SpecialtyKey, context);
                }
            }
            if (context.ShouldSerialize("providerSpecialtyModel")) {
                if ((_strong.Specialty == null)) {
                    if ((_strong.SpecialtyKey.HasValue && context.ShouldForceLoad("providerSpecialtyModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Specialty");
                        if ((_delay != null)) {
                            _strong.Specialty = _delay;
                            context.JsonContext.WritePropertyUtil(w, "providerSpecialtyModel", _strong.Specialty, context);
                        }
                        else {
                            context.RegisterMissTarget("providerSpecialtyModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "providerSpecialtyModel", _strong.Specialty, context);
                }
            }
            if (context.ShouldSerialize("dateOfBirthPrecision")) {
                if ((_strong.DateOfBirthPrecision == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "dateOfBirthPrecision", _strong.DateOfBirthPrecision, context);
                }
            }
            if (context.ShouldSerialize("genderConcept")) {
                if ((_strong.GenderConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "genderConcept", _strong.GenderConceptKey, context);
                }
            }
            if (context.ShouldSerialize("genderConceptModel")) {
                if ((_strong.GenderConcept == null)) {
                    if ((_strong.GenderConceptKey.HasValue && context.ShouldForceLoad("genderConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "GenderConcept");
                        if ((_delay != null)) {
                            _strong.GenderConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "genderConceptModel", _strong.GenderConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("genderConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "genderConceptModel", _strong.GenderConcept, context);
                }
            }
            if (context.ShouldSerialize("dateOfBirth")) {
                if ((_strong.DateOfBirthXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "dateOfBirth", _strong.DateOfBirthXml, context);
                }
            }
            if (context.ShouldSerialize("language")) {
                if (((_strong.LanguageCommunication == null) 
                            || (_strong.LanguageCommunication.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("language", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.PersonLanguageCommunication> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.PersonLanguageCommunication>(_strong, "LanguageCommunication"));
                        if ((_delay.Count > 0)) {
                            _strong.LanguageCommunication = _delay;
                            context.JsonContext.WritePropertyUtil(w, "language", _strong.LanguageCommunication, context);
                        }
                        else {
                            context.RegisterMissTarget("language", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "language", _strong.LanguageCommunication, context);
                }
            }
            if (context.ShouldSerialize("occupation")) {
                if ((_strong.OccupationKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "occupation", _strong.OccupationKey, context);
                }
            }
            if (context.ShouldSerialize("occupationModel")) {
                if ((_strong.Occupation == null)) {
                    if ((_strong.OccupationKey.HasValue && context.ShouldForceLoad("occupationModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Occupation");
                        if ((_delay != null)) {
                            _strong.Occupation = _delay;
                            context.JsonContext.WritePropertyUtil(w, "occupationModel", _strong.Occupation, context);
                        }
                        else {
                            context.RegisterMissTarget("occupationModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "occupationModel", _strong.Occupation, context);
                }
            }
            if (context.ShouldSerialize("maritalStatusModel")) {
                if ((_strong.MaritalStatus == null)) {
                    if ((_strong.MaritalStatusKey.HasValue && context.ShouldForceLoad("maritalStatusModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MaritalStatus");
                        if ((_delay != null)) {
                            _strong.MaritalStatus = _delay;
                            context.JsonContext.WritePropertyUtil(w, "maritalStatusModel", _strong.MaritalStatus, context);
                        }
                        else {
                            context.RegisterMissTarget("maritalStatusModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "maritalStatusModel", _strong.MaritalStatus, context);
                }
            }
            if (context.ShouldSerialize("maritalStatus")) {
                if ((_strong.MaritalStatusKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "maritalStatus", _strong.MaritalStatusKey, context);
                }
            }
            if (context.ShouldSerialize("deceasedDate")) {
                if ((_strong.DeceasedDateXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "deceasedDate", _strong.DeceasedDateXml, context);
                }
            }
            if (context.ShouldSerialize("deceasedDatePrecision")) {
                if ((_strong.DeceasedDatePrecision == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "deceasedDatePrecision", _strong.DeceasedDatePrecision, context);
                }
            }
            if (context.ShouldSerialize("vipStatus")) {
                if ((_strong.VipStatusKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "vipStatus", _strong.VipStatusKey, context);
                }
            }
            if (context.ShouldSerialize("vipStatusModel")) {
                if ((_strong.VipStatus == null)) {
                    if ((_strong.VipStatusKey.HasValue && context.ShouldForceLoad("vipStatusModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "VipStatus");
                        if ((_delay != null)) {
                            _strong.VipStatus = _delay;
                            context.JsonContext.WritePropertyUtil(w, "vipStatusModel", _strong.VipStatus, context);
                        }
                        else {
                            context.RegisterMissTarget("vipStatusModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "vipStatusModel", _strong.VipStatus, context);
                }
            }
            if (context.ShouldSerialize("nationality")) {
                if ((_strong.NationalityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "nationality", _strong.NationalityKey, context);
                }
            }
            if (context.ShouldSerialize("nationalityModel")) {
                if ((_strong.Nationality == null)) {
                    if ((_strong.NationalityKey.HasValue && context.ShouldForceLoad("nationalityModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Nationality");
                        if ((_delay != null)) {
                            _strong.Nationality = _delay;
                            context.JsonContext.WritePropertyUtil(w, "nationalityModel", _strong.Nationality, context);
                        }
                        else {
                            context.RegisterMissTarget("nationalityModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "nationalityModel", _strong.Nationality, context);
                }
            }
            if (context.ShouldSerialize("address")) {
                if (((_strong.Addresses == null) 
                            || (_strong.Addresses.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("address", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityAddress>(_strong, "Addresses"));
                        if ((_delay.Count > 0)) {
                            _strong.Addresses = _delay;
                            context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                        }
                        else {
                            context.RegisterMissTarget("address", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("creationActModel")) {
                if ((_strong.CreationAct == null)) {
                    if ((_strong.CreationActKey.HasValue && context.ShouldForceLoad("creationActModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "CreationAct");
                        if ((_delay != null)) {
                            _strong.CreationAct = _delay;
                            context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                        }
                        else {
                            context.RegisterMissTarget("creationActModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                }
            }
            if (context.ShouldSerialize("creationAct")) {
                if ((_strong.CreationActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationAct", _strong.CreationActKey, context);
                }
            }
            if (context.ShouldSerialize("determinerConceptModel")) {
                if ((_strong.DeterminerConcept == null)) {
                    if ((_strong.DeterminerConceptKey.HasValue && context.ShouldForceLoad("determinerConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DeterminerConcept");
                        if ((_delay != null)) {
                            _strong.DeterminerConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("determinerConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                }
            }
            if (context.ShouldSerialize("determinerConcept")) {
                if ((_strong.DeterminerConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConcept", _strong.DeterminerConceptKey, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.Names == null) 
                            || (_strong.Names.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityName>(_strong, "Names"));
                        if ((_delay.Count > 0)) {
                            _strong.Names = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("telecom")) {
                if (((_strong.Telecoms == null) 
                            || (_strong.Telecoms.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("telecom", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityTelecomAddress>(_strong, "Telecoms"));
                        if ((_delay.Count > 0)) {
                            _strong.Telecoms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                        }
                        else {
                            context.RegisterMissTarget("telecom", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                }
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Roles.Provider _retVal = new SanteDB.Core.Model.Roles.Provider();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Roles.Provider))) {
                        return ((SanteDB.Core.Model.Roles.Provider)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "providerSpecialty":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("providerSpecialty", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SpecialtyKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "providerSpecialtyModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("providerSpecialtyModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Specialty = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "dateOfBirthPrecision":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("dateOfBirthPrecision", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DateOfBirthPrecision = ((System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>)(_instance));
                    }
                    break;
case "genderConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("genderConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GenderConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "genderConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("genderConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GenderConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "dateOfBirth":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("dateOfBirth", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DateOfBirthXml = ((string)(_instance));
                    }
                    break;
case "language":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.PersonLanguageCommunication>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("language", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LanguageCommunication = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.PersonLanguageCommunication>)(_instance));
                    }
                    break;
case "occupation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("occupation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.OccupationKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "occupationModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("occupationModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Occupation = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "maritalStatusModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("maritalStatusModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MaritalStatus = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "maritalStatus":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("maritalStatus", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MaritalStatusKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "deceasedDate":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("deceasedDate", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeceasedDateXml = ((string)(_instance));
                    }
                    break;
case "deceasedDatePrecision":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("deceasedDatePrecision", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeceasedDatePrecision = ((System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>)(_instance));
                    }
                    break;
case "vipStatus":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("vipStatus", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VipStatusKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "vipStatusModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("vipStatusModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VipStatus = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "nationality":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("nationality", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.NationalityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "nationalityModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("nationalityModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Nationality = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "address":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("address", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Addresses = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationActModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationActModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationAct = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "creationAct":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationAct", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "determinerConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "determinerConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Names = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>)(_instance));
                    }
                    break;
case "telecom":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("telecom", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Telecoms = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Patch.PatchCollection"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class PatchCollectionViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Patch.PatchCollection);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Patch.PatchCollection _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Patch.PatchCollection)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Patch.PatchCollection)), e);
            }
            if (context.ShouldSerialize("patch")) {
                if (((_strong.Patches == null) 
                            || (_strong.Patches.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("patch", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Patch.Patch> _delay = null;
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "patch", _strong.Patches, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Patch.PatchCollection _retVal = new SanteDB.Core.Model.Patch.PatchCollection();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Patch.PatchCollection))) {
                        return ((SanteDB.Core.Model.Patch.PatchCollection)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "patch":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Patch.Patch>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("patch", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Patches = ((System.Collections.Generic.List<SanteDB.Core.Model.Patch.Patch>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Patch.Patch"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class PatchViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Patch.Patch);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Patch.Patch _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Patch.Patch)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Patch.Patch)), e);
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.Version == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.Version, context);
                }
            }
            if (context.ShouldSerialize("appliesTo")) {
                if ((_strong.AppliesTo == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "appliesTo", _strong.AppliesTo, context);
                }
            }
            if (context.ShouldSerialize("change")) {
                if (((_strong.Operation == null) 
                            || (_strong.Operation.Count == 0))) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "change", _strong.Operation, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Patch.Patch _retVal = new SanteDB.Core.Model.Patch.Patch();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Patch.Patch))) {
                        return ((SanteDB.Core.Model.Patch.Patch)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Version = ((string)(_instance));
                    }
                    break;
case "appliesTo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Patch.PatchTarget), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("appliesTo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AppliesTo = ((SanteDB.Core.Model.Patch.PatchTarget)(_instance));
                    }
                    break;
case "change":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Patch.PatchOperation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("change", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Operation = ((System.Collections.Generic.List<SanteDB.Core.Model.Patch.PatchOperation>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.ApplicationEntity"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ApplicationEntityViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.ApplicationEntity);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.ApplicationEntity _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.ApplicationEntity)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.ApplicationEntity)), e);
            }
            if (context.ShouldSerialize("securityApplicationModel")) {
                if ((_strong.SecurityApplication == null)) {
                    if ((_strong.SecurityApplicationKey.HasValue && context.ShouldForceLoad("securityApplicationModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityApplication _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityApplication>(_strong, "SecurityApplication");
                        if ((_delay != null)) {
                            _strong.SecurityApplication = _delay;
                            context.JsonContext.WritePropertyUtil(w, "securityApplicationModel", _strong.SecurityApplication, context);
                        }
                        else {
                            context.RegisterMissTarget("securityApplicationModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "securityApplicationModel", _strong.SecurityApplication, context);
                }
            }
            if (context.ShouldSerialize("securityApplication")) {
                if ((_strong.SecurityApplicationKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "securityApplication", _strong.SecurityApplicationKey, context);
                }
            }
            if (context.ShouldSerialize("softwareName")) {
                if ((_strong.SoftwareName == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "softwareName", _strong.SoftwareName, context);
                }
            }
            if (context.ShouldSerialize("vendorName")) {
                if ((_strong.VendorName == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "vendorName", _strong.VendorName, context);
                }
            }
            if (context.ShouldSerialize("versionName")) {
                if ((_strong.VersionName == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "versionName", _strong.VersionName, context);
                }
            }
            if (context.ShouldSerialize("address")) {
                if (((_strong.Addresses == null) 
                            || (_strong.Addresses.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("address", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityAddress>(_strong, "Addresses"));
                        if ((_delay.Count > 0)) {
                            _strong.Addresses = _delay;
                            context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                        }
                        else {
                            context.RegisterMissTarget("address", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("creationActModel")) {
                if ((_strong.CreationAct == null)) {
                    if ((_strong.CreationActKey.HasValue && context.ShouldForceLoad("creationActModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "CreationAct");
                        if ((_delay != null)) {
                            _strong.CreationAct = _delay;
                            context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                        }
                        else {
                            context.RegisterMissTarget("creationActModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                }
            }
            if (context.ShouldSerialize("creationAct")) {
                if ((_strong.CreationActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationAct", _strong.CreationActKey, context);
                }
            }
            if (context.ShouldSerialize("determinerConceptModel")) {
                if ((_strong.DeterminerConcept == null)) {
                    if ((_strong.DeterminerConceptKey.HasValue && context.ShouldForceLoad("determinerConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DeterminerConcept");
                        if ((_delay != null)) {
                            _strong.DeterminerConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("determinerConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                }
            }
            if (context.ShouldSerialize("determinerConcept")) {
                if ((_strong.DeterminerConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConcept", _strong.DeterminerConceptKey, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.Names == null) 
                            || (_strong.Names.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityName>(_strong, "Names"));
                        if ((_delay.Count > 0)) {
                            _strong.Names = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("telecom")) {
                if (((_strong.Telecoms == null) 
                            || (_strong.Telecoms.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("telecom", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityTelecomAddress>(_strong, "Telecoms"));
                        if ((_delay.Count > 0)) {
                            _strong.Telecoms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                        }
                        else {
                            context.RegisterMissTarget("telecom", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                }
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.ApplicationEntity _retVal = new SanteDB.Core.Model.Entities.ApplicationEntity();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.ApplicationEntity))) {
                        return ((SanteDB.Core.Model.Entities.ApplicationEntity)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "securityApplicationModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityApplication), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("securityApplicationModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SecurityApplication = ((SanteDB.Core.Model.Security.SecurityApplication)(_instance));
                    }
                    break;
case "securityApplication":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("securityApplication", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SecurityApplicationKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "softwareName":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("softwareName", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SoftwareName = ((string)(_instance));
                    }
                    break;
case "vendorName":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("vendorName", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VendorName = ((string)(_instance));
                    }
                    break;
case "versionName":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("versionName", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionName = ((string)(_instance));
                    }
                    break;
case "address":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("address", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Addresses = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationActModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationActModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationAct = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "creationAct":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationAct", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "determinerConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "determinerConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Names = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>)(_instance));
                    }
                    break;
case "telecom":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("telecom", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Telecoms = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.Container"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ContainerViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.Container);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.Container _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.Container)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.Container)), e);
            }
            if (context.ShouldSerialize("lotNumber")) {
                if ((_strong.LotNumber == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lotNumber", _strong.LotNumber, context);
                }
            }
            if (context.ShouldSerialize("capacityQuantity")) {
                if ((_strong.CapacityQuantity == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "capacityQuantity", _strong.CapacityQuantity, context);
                }
            }
            if (context.ShouldSerialize("diameterQuantity")) {
                if ((_strong.DiameterQuantity == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "diameterQuantity", _strong.DiameterQuantity, context);
                }
            }
            if (context.ShouldSerialize("heightQuantity")) {
                if ((_strong.HeightQuantity == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "heightQuantity", _strong.HeightQuantity, context);
                }
            }
            if (context.ShouldSerialize("expiryDate")) {
                if ((_strong.ExpiryDate == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "expiryDate", _strong.ExpiryDate, context);
                }
            }
            if (context.ShouldSerialize("formConceptModel")) {
                if ((_strong.FormConcept == null)) {
                    if ((_strong.FormConceptKey.HasValue && context.ShouldForceLoad("formConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "FormConcept");
                        if ((_delay != null)) {
                            _strong.FormConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "formConceptModel", _strong.FormConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("formConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "formConceptModel", _strong.FormConcept, context);
                }
            }
            if (context.ShouldSerialize("formConcept")) {
                if ((_strong.FormConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "formConcept", _strong.FormConceptKey, context);
                }
            }
            if (context.ShouldSerialize("isAdministrable")) {
                context.JsonContext.WritePropertyUtil(w, "isAdministrable", _strong.IsAdministrable, context);
            }
            if (context.ShouldSerialize("quantity")) {
                if ((_strong.Quantity == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "quantity", _strong.Quantity, context);
                }
            }
            if (context.ShouldSerialize("quantityConceptModel")) {
                if ((_strong.QuantityConcept == null)) {
                    if ((_strong.QuantityConceptKey.HasValue && context.ShouldForceLoad("quantityConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "QuantityConcept");
                        if ((_delay != null)) {
                            _strong.QuantityConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "quantityConceptModel", _strong.QuantityConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("quantityConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "quantityConceptModel", _strong.QuantityConcept, context);
                }
            }
            if (context.ShouldSerialize("quantityConcept")) {
                if ((_strong.QuantityConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "quantityConcept", _strong.QuantityConceptKey, context);
                }
            }
            if (context.ShouldSerialize("address")) {
                if (((_strong.Addresses == null) 
                            || (_strong.Addresses.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("address", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityAddress>(_strong, "Addresses"));
                        if ((_delay.Count > 0)) {
                            _strong.Addresses = _delay;
                            context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                        }
                        else {
                            context.RegisterMissTarget("address", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("creationActModel")) {
                if ((_strong.CreationAct == null)) {
                    if ((_strong.CreationActKey.HasValue && context.ShouldForceLoad("creationActModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "CreationAct");
                        if ((_delay != null)) {
                            _strong.CreationAct = _delay;
                            context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                        }
                        else {
                            context.RegisterMissTarget("creationActModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                }
            }
            if (context.ShouldSerialize("creationAct")) {
                if ((_strong.CreationActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationAct", _strong.CreationActKey, context);
                }
            }
            if (context.ShouldSerialize("determinerConceptModel")) {
                if ((_strong.DeterminerConcept == null)) {
                    if ((_strong.DeterminerConceptKey.HasValue && context.ShouldForceLoad("determinerConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DeterminerConcept");
                        if ((_delay != null)) {
                            _strong.DeterminerConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("determinerConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                }
            }
            if (context.ShouldSerialize("determinerConcept")) {
                if ((_strong.DeterminerConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConcept", _strong.DeterminerConceptKey, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.Names == null) 
                            || (_strong.Names.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityName>(_strong, "Names"));
                        if ((_delay.Count > 0)) {
                            _strong.Names = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("telecom")) {
                if (((_strong.Telecoms == null) 
                            || (_strong.Telecoms.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("telecom", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityTelecomAddress>(_strong, "Telecoms"));
                        if ((_delay.Count > 0)) {
                            _strong.Telecoms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                        }
                        else {
                            context.RegisterMissTarget("telecom", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                }
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.Container _retVal = new SanteDB.Core.Model.Entities.Container();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.Container))) {
                        return ((SanteDB.Core.Model.Entities.Container)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "lotNumber":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lotNumber", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LotNumber = ((string)(_instance));
                    }
                    break;
case "capacityQuantity":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<decimal>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("capacityQuantity", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CapacityQuantity = ((System.Nullable<decimal>)(_instance));
                    }
                    break;
case "diameterQuantity":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<decimal>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("diameterQuantity", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DiameterQuantity = ((System.Nullable<decimal>)(_instance));
                    }
                    break;
case "heightQuantity":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<decimal>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("heightQuantity", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.HeightQuantity = ((System.Nullable<decimal>)(_instance));
                    }
                    break;
case "expiryDate":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTime>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("expiryDate", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExpiryDate = ((System.Nullable<System.DateTime>)(_instance));
                    }
                    break;
case "formConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("formConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.FormConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "formConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("formConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.FormConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "isAdministrable":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isAdministrable", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsAdministrable = ((bool)(_instance));
                    }
                    break;
case "quantity":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<decimal>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("quantity", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Quantity = ((System.Nullable<decimal>)(_instance));
                    }
                    break;
case "quantityConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("quantityConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.QuantityConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "quantityConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("quantityConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.QuantityConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "address":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("address", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Addresses = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationActModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationActModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationAct = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "creationAct":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationAct", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "determinerConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "determinerConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Names = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>)(_instance));
                    }
                    break;
case "telecom":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("telecom", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Telecoms = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.DeviceEntity"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class DeviceEntityViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.DeviceEntity);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.DeviceEntity _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.DeviceEntity)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.DeviceEntity)), e);
            }
            if (context.ShouldSerialize("manufacturerModelName")) {
                if ((_strong.ManufacturerModelName == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "manufacturerModelName", _strong.ManufacturerModelName, context);
                }
            }
            if (context.ShouldSerialize("operatingSystemName")) {
                if ((_strong.OperatingSystemName == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "operatingSystemName", _strong.OperatingSystemName, context);
                }
            }
            if (context.ShouldSerialize("securityDeviceModel")) {
                if ((_strong.SecurityDevice == null)) {
                    if ((_strong.SecurityDeviceKey.HasValue && context.ShouldForceLoad("securityDeviceModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityDevice _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityDevice>(_strong, "SecurityDevice");
                        if ((_delay != null)) {
                            _strong.SecurityDevice = _delay;
                            context.JsonContext.WritePropertyUtil(w, "securityDeviceModel", _strong.SecurityDevice, context);
                        }
                        else {
                            context.RegisterMissTarget("securityDeviceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "securityDeviceModel", _strong.SecurityDevice, context);
                }
            }
            if (context.ShouldSerialize("securityDevice")) {
                if ((_strong.SecurityDeviceKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "securityDevice", _strong.SecurityDeviceKey, context);
                }
            }
            if (context.ShouldSerialize("address")) {
                if (((_strong.Addresses == null) 
                            || (_strong.Addresses.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("address", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityAddress>(_strong, "Addresses"));
                        if ((_delay.Count > 0)) {
                            _strong.Addresses = _delay;
                            context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                        }
                        else {
                            context.RegisterMissTarget("address", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("creationActModel")) {
                if ((_strong.CreationAct == null)) {
                    if ((_strong.CreationActKey.HasValue && context.ShouldForceLoad("creationActModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "CreationAct");
                        if ((_delay != null)) {
                            _strong.CreationAct = _delay;
                            context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                        }
                        else {
                            context.RegisterMissTarget("creationActModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                }
            }
            if (context.ShouldSerialize("creationAct")) {
                if ((_strong.CreationActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationAct", _strong.CreationActKey, context);
                }
            }
            if (context.ShouldSerialize("determinerConceptModel")) {
                if ((_strong.DeterminerConcept == null)) {
                    if ((_strong.DeterminerConceptKey.HasValue && context.ShouldForceLoad("determinerConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DeterminerConcept");
                        if ((_delay != null)) {
                            _strong.DeterminerConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("determinerConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                }
            }
            if (context.ShouldSerialize("determinerConcept")) {
                if ((_strong.DeterminerConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConcept", _strong.DeterminerConceptKey, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.Names == null) 
                            || (_strong.Names.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityName>(_strong, "Names"));
                        if ((_delay.Count > 0)) {
                            _strong.Names = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("telecom")) {
                if (((_strong.Telecoms == null) 
                            || (_strong.Telecoms.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("telecom", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityTelecomAddress>(_strong, "Telecoms"));
                        if ((_delay.Count > 0)) {
                            _strong.Telecoms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                        }
                        else {
                            context.RegisterMissTarget("telecom", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                }
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.DeviceEntity _retVal = new SanteDB.Core.Model.Entities.DeviceEntity();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.DeviceEntity))) {
                        return ((SanteDB.Core.Model.Entities.DeviceEntity)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "manufacturerModelName":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("manufacturerModelName", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ManufacturerModelName = ((string)(_instance));
                    }
                    break;
case "operatingSystemName":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operatingSystemName", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.OperatingSystemName = ((string)(_instance));
                    }
                    break;
case "securityDeviceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityDevice), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("securityDeviceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SecurityDevice = ((SanteDB.Core.Model.Security.SecurityDevice)(_instance));
                    }
                    break;
case "securityDevice":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("securityDevice", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SecurityDeviceKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "address":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("address", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Addresses = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationActModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationActModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationAct = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "creationAct":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationAct", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "determinerConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "determinerConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Names = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>)(_instance));
                    }
                    break;
case "telecom":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("telecom", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Telecoms = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.Entity"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class EntityViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.Entity);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.Entity _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.Entity)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.Entity)), e);
            }
            if (context.ShouldSerialize("address")) {
                if (((_strong.Addresses == null) 
                            || (_strong.Addresses.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("address", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityAddress>(_strong, "Addresses"));
                        if ((_delay.Count > 0)) {
                            _strong.Addresses = _delay;
                            context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                        }
                        else {
                            context.RegisterMissTarget("address", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("creationActModel")) {
                if ((_strong.CreationAct == null)) {
                    if ((_strong.CreationActKey.HasValue && context.ShouldForceLoad("creationActModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "CreationAct");
                        if ((_delay != null)) {
                            _strong.CreationAct = _delay;
                            context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                        }
                        else {
                            context.RegisterMissTarget("creationActModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                }
            }
            if (context.ShouldSerialize("creationAct")) {
                if ((_strong.CreationActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationAct", _strong.CreationActKey, context);
                }
            }
            if (context.ShouldSerialize("determinerConceptModel")) {
                if ((_strong.DeterminerConcept == null)) {
                    if ((_strong.DeterminerConceptKey.HasValue && context.ShouldForceLoad("determinerConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DeterminerConcept");
                        if ((_delay != null)) {
                            _strong.DeterminerConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("determinerConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                }
            }
            if (context.ShouldSerialize("determinerConcept")) {
                if ((_strong.DeterminerConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConcept", _strong.DeterminerConceptKey, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.Names == null) 
                            || (_strong.Names.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityName>(_strong, "Names"));
                        if ((_delay.Count > 0)) {
                            _strong.Names = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("telecom")) {
                if (((_strong.Telecoms == null) 
                            || (_strong.Telecoms.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("telecom", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityTelecomAddress>(_strong, "Telecoms"));
                        if ((_delay.Count > 0)) {
                            _strong.Telecoms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                        }
                        else {
                            context.RegisterMissTarget("telecom", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                }
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.Entity _retVal = new SanteDB.Core.Model.Entities.Entity();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.Entity))) {
                        return ((SanteDB.Core.Model.Entities.Entity)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationAct":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationAct", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "determinerConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "address":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("address", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Addresses = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "creationActModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationActModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationAct = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "determinerConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Names = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>)(_instance));
                    }
                    break;
case "telecom":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("telecom", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Telecoms = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.EntityAddress"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class EntityAddressViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.EntityAddress);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.EntityAddress _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.EntityAddress)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.EntityAddress)), e);
            }
            if (context.ShouldSerialize("useModel")) {
                if ((_strong.AddressUse == null)) {
                    if ((_strong.AddressUseKey.HasValue && context.ShouldForceLoad("useModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "AddressUse");
                        if ((_delay != null)) {
                            _strong.AddressUse = _delay;
                            context.JsonContext.WritePropertyUtil(w, "useModel", _strong.AddressUse, context);
                        }
                        else {
                            context.RegisterMissTarget("useModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "useModel", _strong.AddressUse, context);
                }
            }
            if (context.ShouldSerialize("externId")) {
                if ((_strong.ExternalKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "externId", _strong.ExternalKey, context);
                }
            }
            if (context.ShouldSerialize("use")) {
                if ((_strong.AddressUseKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "use", _strong.AddressUseKey, context);
                }
            }
            if (context.ShouldSerialize("component")) {
                if (((_strong.Component == null) 
                            || (_strong.Component.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("component", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddressComponent> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityAddressComponent>(_strong, "Component"));
                        if ((_delay.Count > 0)) {
                            _strong.Component = _delay;
                            context.JsonContext.WritePropertyUtil(w, "component", _strong.Component, context);
                        }
                        else {
                            context.RegisterMissTarget("component", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "component", _strong.Component, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.EntityAddress _retVal = new SanteDB.Core.Model.Entities.EntityAddress();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.EntityAddress))) {
                        return ((SanteDB.Core.Model.Entities.EntityAddress)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "useModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("useModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AddressUse = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "externId":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("externId", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalKey = ((string)(_instance));
                    }
                    break;
case "use":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("use", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AddressUseKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "component":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddressComponent>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("component", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Component = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddressComponent>)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.EntityAddressComponent"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class AddressComponentViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.EntityAddressComponent);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.EntityAddressComponent _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.EntityAddressComponent)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.EntityAddressComponent)), e);
            }
            if (context.ShouldSerialize("type")) {
                if ((_strong.ComponentTypeKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "type", _strong.ComponentTypeKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                context.JsonContext.WritePropertyUtil(w, "sequence", _strong.OrderSequence, context);
            }
            if (context.ShouldSerialize("typeModel")) {
                if ((_strong.ComponentType == null)) {
                    if ((_strong.ComponentTypeKey.HasValue && context.ShouldForceLoad("typeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ComponentType");
                        if ((_delay != null)) {
                            _strong.ComponentType = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeModel", _strong.ComponentType, context);
                        }
                        else {
                            context.RegisterMissTarget("typeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeModel", _strong.ComponentType, context);
                }
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.Value == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.Value, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.EntityAddress _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.EntityAddress>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.EntityAddressComponent _retVal = new SanteDB.Core.Model.Entities.EntityAddressComponent();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.EntityAddressComponent))) {
                        return ((SanteDB.Core.Model.Entities.EntityAddressComponent)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "type":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("type", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ComponentTypeKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(long), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.OrderSequence = ((long)(_instance));
                    }
                    break;
case "typeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ComponentType = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Value = ((string)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.EntityAddress), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Entities.EntityAddress)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            string _strong = null;
            if ((o == null)) {
                return null;
            }
            try {
                _strong = o.ToString();
            }
            catch (System.Exception e) {
                return null;
            }
            SanteDB.Core.Model.Entities.EntityAddressComponent _retVal = new SanteDB.Core.Model.Entities.EntityAddressComponent();
            _retVal.Value = _strong;
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            if ((o == null)) {
                return null;
            }
            SanteDB.Core.Model.Entities.EntityAddressComponent _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.EntityAddressComponent)(o));
            }
            catch (System.Exception e) {
                return null;
            }
            return _strong.Value;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.EntityName"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class EntityNameViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.EntityName);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.EntityName _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.EntityName)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.EntityName)), e);
            }
            if (context.ShouldSerialize("externId")) {
                if ((_strong.ExternalKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "externId", _strong.ExternalKey, context);
                }
            }
            if (context.ShouldSerialize("component")) {
                if (((_strong.Component == null) 
                            || (_strong.Component.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("component", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityNameComponent> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityNameComponent>(_strong, "Component"));
                        if ((_delay.Count > 0)) {
                            _strong.Component = _delay;
                            context.JsonContext.WritePropertyUtil(w, "component", _strong.Component, context);
                        }
                        else {
                            context.RegisterMissTarget("component", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "component", _strong.Component, context);
                }
            }
            if (context.ShouldSerialize("useModel")) {
                if ((_strong.NameUse == null)) {
                    if ((_strong.NameUseKey.HasValue && context.ShouldForceLoad("useModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "NameUse");
                        if ((_delay != null)) {
                            _strong.NameUse = _delay;
                            context.JsonContext.WritePropertyUtil(w, "useModel", _strong.NameUse, context);
                        }
                        else {
                            context.RegisterMissTarget("useModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "useModel", _strong.NameUse, context);
                }
            }
            if (context.ShouldSerialize("use")) {
                if ((_strong.NameUseKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "use", _strong.NameUseKey, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.EntityName _retVal = new SanteDB.Core.Model.Entities.EntityName();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.EntityName))) {
                        return ((SanteDB.Core.Model.Entities.EntityName)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "externId":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("externId", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalKey = ((string)(_instance));
                    }
                    break;
case "component":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityNameComponent>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("component", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Component = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityNameComponent>)(_instance));
                    }
                    break;
case "useModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("useModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.NameUse = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "use":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("use", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.NameUseKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.EntityNameComponent"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class EntityNameComponentViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.EntityNameComponent);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.EntityNameComponent _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.EntityNameComponent)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.EntityNameComponent)), e);
            }
            if (context.ShouldSerialize("type")) {
                if ((_strong.ComponentTypeKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "type", _strong.ComponentTypeKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                context.JsonContext.WritePropertyUtil(w, "sequence", _strong.OrderSequence, context);
            }
            if (context.ShouldSerialize("typeModel")) {
                if ((_strong.ComponentType == null)) {
                    if ((_strong.ComponentTypeKey.HasValue && context.ShouldForceLoad("typeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ComponentType");
                        if ((_delay != null)) {
                            _strong.ComponentType = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeModel", _strong.ComponentType, context);
                        }
                        else {
                            context.RegisterMissTarget("typeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeModel", _strong.ComponentType, context);
                }
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.Value == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.Value, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.EntityName _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.EntityName>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.EntityNameComponent _retVal = new SanteDB.Core.Model.Entities.EntityNameComponent();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.EntityNameComponent))) {
                        return ((SanteDB.Core.Model.Entities.EntityNameComponent)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "type":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("type", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ComponentTypeKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(long), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.OrderSequence = ((long)(_instance));
                    }
                    break;
case "typeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ComponentType = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Value = ((string)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.EntityName), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Entities.EntityName)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            string _strong = null;
            if ((o == null)) {
                return null;
            }
            try {
                _strong = o.ToString();
            }
            catch (System.Exception e) {
                return null;
            }
            SanteDB.Core.Model.Entities.EntityNameComponent _retVal = new SanteDB.Core.Model.Entities.EntityNameComponent();
            _retVal.Value = _strong;
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            if ((o == null)) {
                return null;
            }
            SanteDB.Core.Model.Entities.EntityNameComponent _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.EntityNameComponent)(o));
            }
            catch (System.Exception e) {
                return null;
            }
            return _strong.Value;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.EntityRelationship"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class EntityRelationshipViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.EntityRelationship);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.EntityRelationship _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.EntityRelationship)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.EntityRelationship)), e);
            }
            if (context.ShouldSerialize("holderModel")) {
                if ((_strong.Holder == null)) {
                    if ((_strong.HolderKey.HasValue && context.ShouldForceLoad("holderModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "Holder");
                        if ((_delay != null)) {
                            _strong.Holder = _delay;
                            context.JsonContext.WritePropertyUtil(w, "holderModel", _strong.Holder, context);
                        }
                        else {
                            context.RegisterMissTarget("holderModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "holderModel", _strong.Holder, context);
                }
            }
            if (context.ShouldSerialize("externId")) {
                if ((_strong.ExternalKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "externId", _strong.ExternalKey, context);
                }
            }
            if (context.ShouldSerialize("holder")) {
                if ((_strong.HolderKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "holder", _strong.HolderKey, context);
                }
            }
            if (context.ShouldSerialize("negationInd")) {
                if ((_strong.NegationIndicator == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "negationInd", _strong.NegationIndicator, context);
                }
            }
            if (context.ShouldSerialize("strength")) {
                if ((_strong.Strength == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "strength", _strong.Strength, context);
                }
            }
            if (context.ShouldSerialize("quantity")) {
                if ((_strong.Quantity == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "quantity", _strong.Quantity, context);
                }
            }
            if (context.ShouldSerialize("relationshipTypeModel")) {
                if ((_strong.RelationshipType == null)) {
                    if ((_strong.RelationshipTypeKey.HasValue && context.ShouldForceLoad("relationshipTypeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "RelationshipType");
                        if ((_delay != null)) {
                            _strong.RelationshipType = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationshipTypeModel", _strong.RelationshipType, context);
                        }
                        else {
                            context.RegisterMissTarget("relationshipTypeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationshipTypeModel", _strong.RelationshipType, context);
                }
            }
            if (context.ShouldSerialize("relationshipType")) {
                if ((_strong.RelationshipTypeKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationshipType", _strong.RelationshipTypeKey, context);
                }
            }
            if (context.ShouldSerialize("relationshipRoleModel")) {
                if ((_strong.RelationshipRole == null)) {
                    if ((_strong.RelationshipRoleKey.HasValue && context.ShouldForceLoad("relationshipRoleModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "RelationshipRole");
                        if ((_delay != null)) {
                            _strong.RelationshipRole = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationshipRoleModel", _strong.RelationshipRole, context);
                        }
                        else {
                            context.RegisterMissTarget("relationshipRoleModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationshipRoleModel", _strong.RelationshipRole, context);
                }
            }
            if (context.ShouldSerialize("relationshipRole")) {
                if ((_strong.RelationshipRoleKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationshipRole", _strong.RelationshipRoleKey, context);
                }
            }
            if (context.ShouldSerialize("classificationModel")) {
                if ((_strong.Classification == null)) {
                    if ((_strong.ClassificationKey.HasValue && context.ShouldForceLoad("classificationModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Classification");
                        if ((_delay != null)) {
                            _strong.Classification = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classificationModel", _strong.Classification, context);
                        }
                        else {
                            context.RegisterMissTarget("classificationModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classificationModel", _strong.Classification, context);
                }
            }
            if (context.ShouldSerialize("classification")) {
                if ((_strong.ClassificationKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classification", _strong.ClassificationKey, context);
                }
            }
            if (context.ShouldSerialize("targetModel")) {
                if ((_strong.TargetEntity == null)) {
                    if ((_strong.TargetEntityKey.HasValue && context.ShouldForceLoad("targetModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "TargetEntity");
                        if ((_delay != null)) {
                            _strong.TargetEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "targetModel", _strong.TargetEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("targetModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "targetModel", _strong.TargetEntity, context);
                }
            }
            if (context.ShouldSerialize("target")) {
                if ((_strong.TargetEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "target", _strong.TargetEntityKey, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.EntityRelationship _retVal = new SanteDB.Core.Model.Entities.EntityRelationship();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.EntityRelationship))) {
                        return ((SanteDB.Core.Model.Entities.EntityRelationship)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "holderModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("holderModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Holder = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "externId":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("externId", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalKey = ((string)(_instance));
                    }
                    break;
case "holder":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("holder", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.HolderKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "negationInd":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<bool>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("negationInd", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.NegationIndicator = ((System.Nullable<bool>)(_instance));
                    }
                    break;
case "strength":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<double>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("strength", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Strength = ((System.Nullable<double>)(_instance));
                    }
                    break;
case "quantity":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<int>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("quantity", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Quantity = ((System.Nullable<int>)(_instance));
                    }
                    break;
case "relationshipTypeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationshipTypeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.RelationshipType = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "relationshipType":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationshipType", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.RelationshipTypeKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "relationshipRoleModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationshipRoleModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.RelationshipRole = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "relationshipRole":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationshipRole", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.RelationshipRoleKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classificationModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classificationModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Classification = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "classification":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classification", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassificationKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "targetModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("targetModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TargetEntity = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "target":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("target", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TargetEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.EntityTelecomAddress"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class EntityTelecomAddressViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.EntityTelecomAddress);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.EntityTelecomAddress _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.EntityTelecomAddress)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.EntityTelecomAddress)), e);
            }
            if (context.ShouldSerialize("useModel")) {
                if ((_strong.AddressUse == null)) {
                    if ((_strong.AddressUseKey.HasValue && context.ShouldForceLoad("useModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "AddressUse");
                        if ((_delay != null)) {
                            _strong.AddressUse = _delay;
                            context.JsonContext.WritePropertyUtil(w, "useModel", _strong.AddressUse, context);
                        }
                        else {
                            context.RegisterMissTarget("useModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "useModel", _strong.AddressUse, context);
                }
            }
            if (context.ShouldSerialize("externId")) {
                if ((_strong.ExternalKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "externId", _strong.ExternalKey, context);
                }
            }
            if (context.ShouldSerialize("use")) {
                if ((_strong.AddressUseKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "use", _strong.AddressUseKey, context);
                }
            }
            if (context.ShouldSerialize("typeModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("type")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "type", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.Value == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.Value, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.EntityTelecomAddress _retVal = new SanteDB.Core.Model.Entities.EntityTelecomAddress();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.EntityTelecomAddress))) {
                        return ((SanteDB.Core.Model.Entities.EntityTelecomAddress)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "useModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("useModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AddressUse = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "externId":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("externId", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalKey = ((string)(_instance));
                    }
                    break;
case "use":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("use", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AddressUseKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "type":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("type", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Value = ((string)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.ManufacturedMaterial"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ManufacturedMaterialViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.ManufacturedMaterial);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.ManufacturedMaterial _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.ManufacturedMaterial)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.ManufacturedMaterial)), e);
            }
            if (context.ShouldSerialize("lotNumber")) {
                if ((_strong.LotNumber == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lotNumber", _strong.LotNumber, context);
                }
            }
            if (context.ShouldSerialize("expiryDate")) {
                if ((_strong.ExpiryDate == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "expiryDate", _strong.ExpiryDate, context);
                }
            }
            if (context.ShouldSerialize("formConceptModel")) {
                if ((_strong.FormConcept == null)) {
                    if ((_strong.FormConceptKey.HasValue && context.ShouldForceLoad("formConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "FormConcept");
                        if ((_delay != null)) {
                            _strong.FormConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "formConceptModel", _strong.FormConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("formConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "formConceptModel", _strong.FormConcept, context);
                }
            }
            if (context.ShouldSerialize("formConcept")) {
                if ((_strong.FormConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "formConcept", _strong.FormConceptKey, context);
                }
            }
            if (context.ShouldSerialize("isAdministrable")) {
                context.JsonContext.WritePropertyUtil(w, "isAdministrable", _strong.IsAdministrable, context);
            }
            if (context.ShouldSerialize("quantity")) {
                if ((_strong.Quantity == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "quantity", _strong.Quantity, context);
                }
            }
            if (context.ShouldSerialize("quantityConceptModel")) {
                if ((_strong.QuantityConcept == null)) {
                    if ((_strong.QuantityConceptKey.HasValue && context.ShouldForceLoad("quantityConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "QuantityConcept");
                        if ((_delay != null)) {
                            _strong.QuantityConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "quantityConceptModel", _strong.QuantityConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("quantityConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "quantityConceptModel", _strong.QuantityConcept, context);
                }
            }
            if (context.ShouldSerialize("quantityConcept")) {
                if ((_strong.QuantityConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "quantityConcept", _strong.QuantityConceptKey, context);
                }
            }
            if (context.ShouldSerialize("address")) {
                if (((_strong.Addresses == null) 
                            || (_strong.Addresses.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("address", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityAddress>(_strong, "Addresses"));
                        if ((_delay.Count > 0)) {
                            _strong.Addresses = _delay;
                            context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                        }
                        else {
                            context.RegisterMissTarget("address", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("creationActModel")) {
                if ((_strong.CreationAct == null)) {
                    if ((_strong.CreationActKey.HasValue && context.ShouldForceLoad("creationActModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "CreationAct");
                        if ((_delay != null)) {
                            _strong.CreationAct = _delay;
                            context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                        }
                        else {
                            context.RegisterMissTarget("creationActModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                }
            }
            if (context.ShouldSerialize("creationAct")) {
                if ((_strong.CreationActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationAct", _strong.CreationActKey, context);
                }
            }
            if (context.ShouldSerialize("determinerConceptModel")) {
                if ((_strong.DeterminerConcept == null)) {
                    if ((_strong.DeterminerConceptKey.HasValue && context.ShouldForceLoad("determinerConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DeterminerConcept");
                        if ((_delay != null)) {
                            _strong.DeterminerConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("determinerConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                }
            }
            if (context.ShouldSerialize("determinerConcept")) {
                if ((_strong.DeterminerConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConcept", _strong.DeterminerConceptKey, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.Names == null) 
                            || (_strong.Names.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityName>(_strong, "Names"));
                        if ((_delay.Count > 0)) {
                            _strong.Names = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("telecom")) {
                if (((_strong.Telecoms == null) 
                            || (_strong.Telecoms.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("telecom", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityTelecomAddress>(_strong, "Telecoms"));
                        if ((_delay.Count > 0)) {
                            _strong.Telecoms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                        }
                        else {
                            context.RegisterMissTarget("telecom", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                }
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.ManufacturedMaterial _retVal = new SanteDB.Core.Model.Entities.ManufacturedMaterial();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.ManufacturedMaterial))) {
                        return ((SanteDB.Core.Model.Entities.ManufacturedMaterial)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "lotNumber":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lotNumber", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LotNumber = ((string)(_instance));
                    }
                    break;
case "expiryDate":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTime>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("expiryDate", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExpiryDate = ((System.Nullable<System.DateTime>)(_instance));
                    }
                    break;
case "formConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("formConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.FormConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "formConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("formConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.FormConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "isAdministrable":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isAdministrable", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsAdministrable = ((bool)(_instance));
                    }
                    break;
case "quantity":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<decimal>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("quantity", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Quantity = ((System.Nullable<decimal>)(_instance));
                    }
                    break;
case "quantityConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("quantityConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.QuantityConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "quantityConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("quantityConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.QuantityConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "address":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("address", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Addresses = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationActModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationActModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationAct = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "creationAct":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationAct", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "determinerConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "determinerConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Names = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>)(_instance));
                    }
                    break;
case "telecom":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("telecom", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Telecoms = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.Material"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class MaterialViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.Material);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.Material _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.Material)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.Material)), e);
            }
            if (context.ShouldSerialize("expiryDate")) {
                if ((_strong.ExpiryDate == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "expiryDate", _strong.ExpiryDate, context);
                }
            }
            if (context.ShouldSerialize("formConceptModel")) {
                if ((_strong.FormConcept == null)) {
                    if ((_strong.FormConceptKey.HasValue && context.ShouldForceLoad("formConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "FormConcept");
                        if ((_delay != null)) {
                            _strong.FormConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "formConceptModel", _strong.FormConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("formConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "formConceptModel", _strong.FormConcept, context);
                }
            }
            if (context.ShouldSerialize("formConcept")) {
                if ((_strong.FormConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "formConcept", _strong.FormConceptKey, context);
                }
            }
            if (context.ShouldSerialize("isAdministrable")) {
                context.JsonContext.WritePropertyUtil(w, "isAdministrable", _strong.IsAdministrable, context);
            }
            if (context.ShouldSerialize("quantity")) {
                if ((_strong.Quantity == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "quantity", _strong.Quantity, context);
                }
            }
            if (context.ShouldSerialize("quantityConceptModel")) {
                if ((_strong.QuantityConcept == null)) {
                    if ((_strong.QuantityConceptKey.HasValue && context.ShouldForceLoad("quantityConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "QuantityConcept");
                        if ((_delay != null)) {
                            _strong.QuantityConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "quantityConceptModel", _strong.QuantityConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("quantityConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "quantityConceptModel", _strong.QuantityConcept, context);
                }
            }
            if (context.ShouldSerialize("quantityConcept")) {
                if ((_strong.QuantityConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "quantityConcept", _strong.QuantityConceptKey, context);
                }
            }
            if (context.ShouldSerialize("address")) {
                if (((_strong.Addresses == null) 
                            || (_strong.Addresses.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("address", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityAddress>(_strong, "Addresses"));
                        if ((_delay.Count > 0)) {
                            _strong.Addresses = _delay;
                            context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                        }
                        else {
                            context.RegisterMissTarget("address", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("creationActModel")) {
                if ((_strong.CreationAct == null)) {
                    if ((_strong.CreationActKey.HasValue && context.ShouldForceLoad("creationActModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "CreationAct");
                        if ((_delay != null)) {
                            _strong.CreationAct = _delay;
                            context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                        }
                        else {
                            context.RegisterMissTarget("creationActModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                }
            }
            if (context.ShouldSerialize("creationAct")) {
                if ((_strong.CreationActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationAct", _strong.CreationActKey, context);
                }
            }
            if (context.ShouldSerialize("determinerConceptModel")) {
                if ((_strong.DeterminerConcept == null)) {
                    if ((_strong.DeterminerConceptKey.HasValue && context.ShouldForceLoad("determinerConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DeterminerConcept");
                        if ((_delay != null)) {
                            _strong.DeterminerConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("determinerConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                }
            }
            if (context.ShouldSerialize("determinerConcept")) {
                if ((_strong.DeterminerConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConcept", _strong.DeterminerConceptKey, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.Names == null) 
                            || (_strong.Names.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityName>(_strong, "Names"));
                        if ((_delay.Count > 0)) {
                            _strong.Names = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("telecom")) {
                if (((_strong.Telecoms == null) 
                            || (_strong.Telecoms.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("telecom", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityTelecomAddress>(_strong, "Telecoms"));
                        if ((_delay.Count > 0)) {
                            _strong.Telecoms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                        }
                        else {
                            context.RegisterMissTarget("telecom", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                }
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.Material _retVal = new SanteDB.Core.Model.Entities.Material();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.Material))) {
                        return ((SanteDB.Core.Model.Entities.Material)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "formConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("formConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.FormConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "quantityConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("quantityConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.QuantityConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "expiryDate":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTime>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("expiryDate", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExpiryDate = ((System.Nullable<System.DateTime>)(_instance));
                    }
                    break;
case "formConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("formConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.FormConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "isAdministrable":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isAdministrable", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsAdministrable = ((bool)(_instance));
                    }
                    break;
case "quantity":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<decimal>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("quantity", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Quantity = ((System.Nullable<decimal>)(_instance));
                    }
                    break;
case "quantityConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("quantityConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.QuantityConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "address":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("address", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Addresses = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationActModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationActModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationAct = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "creationAct":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationAct", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "determinerConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "determinerConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Names = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>)(_instance));
                    }
                    break;
case "telecom":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("telecom", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Telecoms = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.NonPersonLivingSubject"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class NonPersonLivingSubjectViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.NonPersonLivingSubject);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.NonPersonLivingSubject _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.NonPersonLivingSubject)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.NonPersonLivingSubject)), e);
            }
            if (context.ShouldSerialize("strain")) {
                if ((_strong.StrainKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "strain", _strong.StrainKey, context);
                }
            }
            if (context.ShouldSerialize("strainModel")) {
                if ((_strong.Strain == null)) {
                    if ((_strong.StrainKey.HasValue && context.ShouldForceLoad("strainModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Strain");
                        if ((_delay != null)) {
                            _strong.Strain = _delay;
                            context.JsonContext.WritePropertyUtil(w, "strainModel", _strong.Strain, context);
                        }
                        else {
                            context.RegisterMissTarget("strainModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "strainModel", _strong.Strain, context);
                }
            }
            if (context.ShouldSerialize("address")) {
                if (((_strong.Addresses == null) 
                            || (_strong.Addresses.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("address", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityAddress>(_strong, "Addresses"));
                        if ((_delay.Count > 0)) {
                            _strong.Addresses = _delay;
                            context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                        }
                        else {
                            context.RegisterMissTarget("address", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("creationActModel")) {
                if ((_strong.CreationAct == null)) {
                    if ((_strong.CreationActKey.HasValue && context.ShouldForceLoad("creationActModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "CreationAct");
                        if ((_delay != null)) {
                            _strong.CreationAct = _delay;
                            context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                        }
                        else {
                            context.RegisterMissTarget("creationActModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                }
            }
            if (context.ShouldSerialize("creationAct")) {
                if ((_strong.CreationActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationAct", _strong.CreationActKey, context);
                }
            }
            if (context.ShouldSerialize("determinerConceptModel")) {
                if ((_strong.DeterminerConcept == null)) {
                    if ((_strong.DeterminerConceptKey.HasValue && context.ShouldForceLoad("determinerConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DeterminerConcept");
                        if ((_delay != null)) {
                            _strong.DeterminerConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("determinerConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                }
            }
            if (context.ShouldSerialize("determinerConcept")) {
                if ((_strong.DeterminerConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConcept", _strong.DeterminerConceptKey, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.Names == null) 
                            || (_strong.Names.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityName>(_strong, "Names"));
                        if ((_delay.Count > 0)) {
                            _strong.Names = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("telecom")) {
                if (((_strong.Telecoms == null) 
                            || (_strong.Telecoms.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("telecom", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityTelecomAddress>(_strong, "Telecoms"));
                        if ((_delay.Count > 0)) {
                            _strong.Telecoms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                        }
                        else {
                            context.RegisterMissTarget("telecom", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                }
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.NonPersonLivingSubject _retVal = new SanteDB.Core.Model.Entities.NonPersonLivingSubject();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.NonPersonLivingSubject))) {
                        return ((SanteDB.Core.Model.Entities.NonPersonLivingSubject)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "strain":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("strain", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StrainKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "strainModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("strainModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Strain = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "address":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("address", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Addresses = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationActModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationActModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationAct = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "creationAct":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationAct", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "determinerConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "determinerConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Names = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>)(_instance));
                    }
                    break;
case "telecom":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("telecom", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Telecoms = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.Organization"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class OrganizationViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.Organization);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.Organization _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.Organization)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.Organization)), e);
            }
            if (context.ShouldSerialize("industryConceptModel")) {
                if ((_strong.IndustryConcept == null)) {
                    if ((_strong.IndustryConceptKey.HasValue && context.ShouldForceLoad("industryConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "IndustryConcept");
                        if ((_delay != null)) {
                            _strong.IndustryConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "industryConceptModel", _strong.IndustryConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("industryConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "industryConceptModel", _strong.IndustryConcept, context);
                }
            }
            if (context.ShouldSerialize("industryConcept")) {
                if ((_strong.IndustryConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "industryConcept", _strong.IndustryConceptKey, context);
                }
            }
            if (context.ShouldSerialize("address")) {
                if (((_strong.Addresses == null) 
                            || (_strong.Addresses.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("address", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityAddress>(_strong, "Addresses"));
                        if ((_delay.Count > 0)) {
                            _strong.Addresses = _delay;
                            context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                        }
                        else {
                            context.RegisterMissTarget("address", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("creationActModel")) {
                if ((_strong.CreationAct == null)) {
                    if ((_strong.CreationActKey.HasValue && context.ShouldForceLoad("creationActModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "CreationAct");
                        if ((_delay != null)) {
                            _strong.CreationAct = _delay;
                            context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                        }
                        else {
                            context.RegisterMissTarget("creationActModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                }
            }
            if (context.ShouldSerialize("creationAct")) {
                if ((_strong.CreationActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationAct", _strong.CreationActKey, context);
                }
            }
            if (context.ShouldSerialize("determinerConceptModel")) {
                if ((_strong.DeterminerConcept == null)) {
                    if ((_strong.DeterminerConceptKey.HasValue && context.ShouldForceLoad("determinerConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DeterminerConcept");
                        if ((_delay != null)) {
                            _strong.DeterminerConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("determinerConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                }
            }
            if (context.ShouldSerialize("determinerConcept")) {
                if ((_strong.DeterminerConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConcept", _strong.DeterminerConceptKey, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.Names == null) 
                            || (_strong.Names.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityName>(_strong, "Names"));
                        if ((_delay.Count > 0)) {
                            _strong.Names = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("telecom")) {
                if (((_strong.Telecoms == null) 
                            || (_strong.Telecoms.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("telecom", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityTelecomAddress>(_strong, "Telecoms"));
                        if ((_delay.Count > 0)) {
                            _strong.Telecoms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                        }
                        else {
                            context.RegisterMissTarget("telecom", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                }
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.Organization _retVal = new SanteDB.Core.Model.Entities.Organization();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.Organization))) {
                        return ((SanteDB.Core.Model.Entities.Organization)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "industryConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("industryConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IndustryConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "industryConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("industryConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IndustryConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "address":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("address", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Addresses = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationActModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationActModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationAct = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "creationAct":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationAct", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "determinerConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "determinerConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Names = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>)(_instance));
                    }
                    break;
case "telecom":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("telecom", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Telecoms = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.Person"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class PersonViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.Person);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.Person _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.Person)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.Person)), e);
            }
            if (context.ShouldSerialize("dateOfBirthPrecision")) {
                if ((_strong.DateOfBirthPrecision == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "dateOfBirthPrecision", _strong.DateOfBirthPrecision, context);
                }
            }
            if (context.ShouldSerialize("genderConcept")) {
                if ((_strong.GenderConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "genderConcept", _strong.GenderConceptKey, context);
                }
            }
            if (context.ShouldSerialize("genderConceptModel")) {
                if ((_strong.GenderConcept == null)) {
                    if ((_strong.GenderConceptKey.HasValue && context.ShouldForceLoad("genderConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "GenderConcept");
                        if ((_delay != null)) {
                            _strong.GenderConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "genderConceptModel", _strong.GenderConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("genderConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "genderConceptModel", _strong.GenderConcept, context);
                }
            }
            if (context.ShouldSerialize("dateOfBirth")) {
                if ((_strong.DateOfBirthXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "dateOfBirth", _strong.DateOfBirthXml, context);
                }
            }
            if (context.ShouldSerialize("language")) {
                if (((_strong.LanguageCommunication == null) 
                            || (_strong.LanguageCommunication.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("language", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.PersonLanguageCommunication> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.PersonLanguageCommunication>(_strong, "LanguageCommunication"));
                        if ((_delay.Count > 0)) {
                            _strong.LanguageCommunication = _delay;
                            context.JsonContext.WritePropertyUtil(w, "language", _strong.LanguageCommunication, context);
                        }
                        else {
                            context.RegisterMissTarget("language", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "language", _strong.LanguageCommunication, context);
                }
            }
            if (context.ShouldSerialize("occupation")) {
                if ((_strong.OccupationKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "occupation", _strong.OccupationKey, context);
                }
            }
            if (context.ShouldSerialize("occupationModel")) {
                if ((_strong.Occupation == null)) {
                    if ((_strong.OccupationKey.HasValue && context.ShouldForceLoad("occupationModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Occupation");
                        if ((_delay != null)) {
                            _strong.Occupation = _delay;
                            context.JsonContext.WritePropertyUtil(w, "occupationModel", _strong.Occupation, context);
                        }
                        else {
                            context.RegisterMissTarget("occupationModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "occupationModel", _strong.Occupation, context);
                }
            }
            if (context.ShouldSerialize("maritalStatusModel")) {
                if ((_strong.MaritalStatus == null)) {
                    if ((_strong.MaritalStatusKey.HasValue && context.ShouldForceLoad("maritalStatusModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MaritalStatus");
                        if ((_delay != null)) {
                            _strong.MaritalStatus = _delay;
                            context.JsonContext.WritePropertyUtil(w, "maritalStatusModel", _strong.MaritalStatus, context);
                        }
                        else {
                            context.RegisterMissTarget("maritalStatusModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "maritalStatusModel", _strong.MaritalStatus, context);
                }
            }
            if (context.ShouldSerialize("maritalStatus")) {
                if ((_strong.MaritalStatusKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "maritalStatus", _strong.MaritalStatusKey, context);
                }
            }
            if (context.ShouldSerialize("deceasedDate")) {
                if ((_strong.DeceasedDateXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "deceasedDate", _strong.DeceasedDateXml, context);
                }
            }
            if (context.ShouldSerialize("deceasedDatePrecision")) {
                if ((_strong.DeceasedDatePrecision == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "deceasedDatePrecision", _strong.DeceasedDatePrecision, context);
                }
            }
            if (context.ShouldSerialize("vipStatus")) {
                if ((_strong.VipStatusKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "vipStatus", _strong.VipStatusKey, context);
                }
            }
            if (context.ShouldSerialize("vipStatusModel")) {
                if ((_strong.VipStatus == null)) {
                    if ((_strong.VipStatusKey.HasValue && context.ShouldForceLoad("vipStatusModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "VipStatus");
                        if ((_delay != null)) {
                            _strong.VipStatus = _delay;
                            context.JsonContext.WritePropertyUtil(w, "vipStatusModel", _strong.VipStatus, context);
                        }
                        else {
                            context.RegisterMissTarget("vipStatusModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "vipStatusModel", _strong.VipStatus, context);
                }
            }
            if (context.ShouldSerialize("nationality")) {
                if ((_strong.NationalityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "nationality", _strong.NationalityKey, context);
                }
            }
            if (context.ShouldSerialize("nationalityModel")) {
                if ((_strong.Nationality == null)) {
                    if ((_strong.NationalityKey.HasValue && context.ShouldForceLoad("nationalityModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Nationality");
                        if ((_delay != null)) {
                            _strong.Nationality = _delay;
                            context.JsonContext.WritePropertyUtil(w, "nationalityModel", _strong.Nationality, context);
                        }
                        else {
                            context.RegisterMissTarget("nationalityModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "nationalityModel", _strong.Nationality, context);
                }
            }
            if (context.ShouldSerialize("address")) {
                if (((_strong.Addresses == null) 
                            || (_strong.Addresses.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("address", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityAddress>(_strong, "Addresses"));
                        if ((_delay.Count > 0)) {
                            _strong.Addresses = _delay;
                            context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                        }
                        else {
                            context.RegisterMissTarget("address", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("creationActModel")) {
                if ((_strong.CreationAct == null)) {
                    if ((_strong.CreationActKey.HasValue && context.ShouldForceLoad("creationActModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "CreationAct");
                        if ((_delay != null)) {
                            _strong.CreationAct = _delay;
                            context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                        }
                        else {
                            context.RegisterMissTarget("creationActModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                }
            }
            if (context.ShouldSerialize("creationAct")) {
                if ((_strong.CreationActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationAct", _strong.CreationActKey, context);
                }
            }
            if (context.ShouldSerialize("determinerConceptModel")) {
                if ((_strong.DeterminerConcept == null)) {
                    if ((_strong.DeterminerConceptKey.HasValue && context.ShouldForceLoad("determinerConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DeterminerConcept");
                        if ((_delay != null)) {
                            _strong.DeterminerConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("determinerConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                }
            }
            if (context.ShouldSerialize("determinerConcept")) {
                if ((_strong.DeterminerConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConcept", _strong.DeterminerConceptKey, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.Names == null) 
                            || (_strong.Names.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityName>(_strong, "Names"));
                        if ((_delay.Count > 0)) {
                            _strong.Names = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("telecom")) {
                if (((_strong.Telecoms == null) 
                            || (_strong.Telecoms.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("telecom", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityTelecomAddress>(_strong, "Telecoms"));
                        if ((_delay.Count > 0)) {
                            _strong.Telecoms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                        }
                        else {
                            context.RegisterMissTarget("telecom", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                }
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.Person _retVal = new SanteDB.Core.Model.Entities.Person();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.Person))) {
                        return ((SanteDB.Core.Model.Entities.Person)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "genderConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("genderConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GenderConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "occupation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("occupation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.OccupationKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "maritalStatus":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("maritalStatus", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MaritalStatusKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "vipStatus":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("vipStatus", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VipStatusKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "nationality":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("nationality", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.NationalityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "dateOfBirthPrecision":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("dateOfBirthPrecision", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DateOfBirthPrecision = ((System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>)(_instance));
                    }
                    break;
case "genderConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("genderConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GenderConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "dateOfBirth":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("dateOfBirth", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DateOfBirthXml = ((string)(_instance));
                    }
                    break;
case "language":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.PersonLanguageCommunication>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("language", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LanguageCommunication = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.PersonLanguageCommunication>)(_instance));
                    }
                    break;
case "occupationModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("occupationModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Occupation = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "maritalStatusModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("maritalStatusModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MaritalStatus = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "deceasedDate":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("deceasedDate", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeceasedDateXml = ((string)(_instance));
                    }
                    break;
case "deceasedDatePrecision":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("deceasedDatePrecision", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeceasedDatePrecision = ((System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>)(_instance));
                    }
                    break;
case "vipStatusModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("vipStatusModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VipStatus = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "nationalityModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("nationalityModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Nationality = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "address":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("address", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Addresses = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationActModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationActModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationAct = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "creationAct":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationAct", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "determinerConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "determinerConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Names = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>)(_instance));
                    }
                    break;
case "telecom":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("telecom", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Telecoms = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.PersonLanguageCommunication"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class PersonLanguageCommunicationViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.PersonLanguageCommunication);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.PersonLanguageCommunication _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.PersonLanguageCommunication)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.PersonLanguageCommunication)), e);
            }
            if (context.ShouldSerialize("externId")) {
                if ((_strong.ExternalKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "externId", _strong.ExternalKey, context);
                }
            }
            if (context.ShouldSerialize("isPreferred")) {
                context.JsonContext.WritePropertyUtil(w, "isPreferred", _strong.IsPreferred, context);
            }
            if (context.ShouldSerialize("languageCode")) {
                if ((_strong.LanguageCode == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "languageCode", _strong.LanguageCode, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.PersonLanguageCommunication _retVal = new SanteDB.Core.Model.Entities.PersonLanguageCommunication();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.PersonLanguageCommunication))) {
                        return ((SanteDB.Core.Model.Entities.PersonLanguageCommunication)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "externId":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("externId", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalKey = ((string)(_instance));
                    }
                    break;
case "isPreferred":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isPreferred", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsPreferred = ((bool)(_instance));
                    }
                    break;
case "languageCode":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("languageCode", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LanguageCode = ((string)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.Place"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class PlaceViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.Place);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.Place _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.Place)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.Place)), e);
            }
            if (context.ShouldSerialize("isMobile")) {
                context.JsonContext.WritePropertyUtil(w, "isMobile", _strong.IsMobile, context);
            }
            if (context.ShouldSerialize("service")) {
                if (((_strong.Services == null) 
                            || (_strong.Services.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("service", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.PlaceService> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.PlaceService>(_strong, "Services"));
                        if ((_delay.Count > 0)) {
                            _strong.Services = _delay;
                            context.JsonContext.WritePropertyUtil(w, "service", _strong.Services, context);
                        }
                        else {
                            context.RegisterMissTarget("service", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "service", _strong.Services, context);
                }
            }
            if (context.ShouldSerialize("address")) {
                if (((_strong.Addresses == null) 
                            || (_strong.Addresses.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("address", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityAddress>(_strong, "Addresses"));
                        if ((_delay.Count > 0)) {
                            _strong.Addresses = _delay;
                            context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                        }
                        else {
                            context.RegisterMissTarget("address", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("creationActModel")) {
                if ((_strong.CreationAct == null)) {
                    if ((_strong.CreationActKey.HasValue && context.ShouldForceLoad("creationActModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "CreationAct");
                        if ((_delay != null)) {
                            _strong.CreationAct = _delay;
                            context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                        }
                        else {
                            context.RegisterMissTarget("creationActModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                }
            }
            if (context.ShouldSerialize("creationAct")) {
                if ((_strong.CreationActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationAct", _strong.CreationActKey, context);
                }
            }
            if (context.ShouldSerialize("determinerConceptModel")) {
                if ((_strong.DeterminerConcept == null)) {
                    if ((_strong.DeterminerConceptKey.HasValue && context.ShouldForceLoad("determinerConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DeterminerConcept");
                        if ((_delay != null)) {
                            _strong.DeterminerConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("determinerConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                }
            }
            if (context.ShouldSerialize("determinerConcept")) {
                if ((_strong.DeterminerConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConcept", _strong.DeterminerConceptKey, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.Names == null) 
                            || (_strong.Names.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityName>(_strong, "Names"));
                        if ((_delay.Count > 0)) {
                            _strong.Names = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("telecom")) {
                if (((_strong.Telecoms == null) 
                            || (_strong.Telecoms.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("telecom", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityTelecomAddress>(_strong, "Telecoms"));
                        if ((_delay.Count > 0)) {
                            _strong.Telecoms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                        }
                        else {
                            context.RegisterMissTarget("telecom", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                }
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.Place _retVal = new SanteDB.Core.Model.Entities.Place();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.Place))) {
                        return ((SanteDB.Core.Model.Entities.Place)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "isMobile":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isMobile", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsMobile = ((bool)(_instance));
                    }
                    break;
case "service":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.PlaceService>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("service", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Services = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.PlaceService>)(_instance));
                    }
                    break;
case "address":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("address", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Addresses = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationActModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationActModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationAct = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "creationAct":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationAct", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "determinerConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "determinerConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Names = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>)(_instance));
                    }
                    break;
case "telecom":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("telecom", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Telecoms = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.PlaceService"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class PlaceServiceViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.PlaceService);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.PlaceService _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.PlaceService)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.PlaceService)), e);
            }
            if (context.ShouldSerialize("serviceConceptModel")) {
                if ((_strong.ServiceConcept == null)) {
                    if ((_strong.ServiceConceptKey.HasValue && context.ShouldForceLoad("serviceConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ServiceConcept");
                        if ((_delay != null)) {
                            _strong.ServiceConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "serviceConceptModel", _strong.ServiceConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("serviceConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "serviceConceptModel", _strong.ServiceConcept, context);
                }
            }
            if (context.ShouldSerialize("externId")) {
                if ((_strong.ExternalKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "externId", _strong.ExternalKey, context);
                }
            }
            if (context.ShouldSerialize("serviceConcept")) {
                if ((_strong.ServiceConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "serviceConcept", _strong.ServiceConceptKey, context);
                }
            }
            if (context.ShouldSerialize("serviceSchedule")) {
                if ((_strong.ServiceSchedule == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "serviceSchedule", _strong.ServiceSchedule, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.PlaceService _retVal = new SanteDB.Core.Model.Entities.PlaceService();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.PlaceService))) {
                        return ((SanteDB.Core.Model.Entities.PlaceService)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "serviceConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("serviceConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ServiceConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "externId":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("externId", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalKey = ((string)(_instance));
                    }
                    break;
case "serviceConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("serviceConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ServiceConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "serviceSchedule":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("serviceSchedule", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ServiceSchedule = ((string)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Entities.UserEntity"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class UserEntityViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Entities.UserEntity);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Entities.UserEntity _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Entities.UserEntity)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Entities.UserEntity)), e);
            }
            if (context.ShouldSerialize("securityUserModel")) {
                if ((_strong.SecurityUser == null)) {
                    if ((_strong.SecurityUserKey.HasValue && context.ShouldForceLoad("securityUserModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityUser _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityUser>(_strong, "SecurityUser");
                        if ((_delay != null)) {
                            _strong.SecurityUser = _delay;
                            context.JsonContext.WritePropertyUtil(w, "securityUserModel", _strong.SecurityUser, context);
                        }
                        else {
                            context.RegisterMissTarget("securityUserModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "securityUserModel", _strong.SecurityUser, context);
                }
            }
            if (context.ShouldSerialize("securityUser")) {
                if ((_strong.SecurityUserKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "securityUser", _strong.SecurityUserKey, context);
                }
            }
            if (context.ShouldSerialize("dateOfBirthPrecision")) {
                if ((_strong.DateOfBirthPrecision == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "dateOfBirthPrecision", _strong.DateOfBirthPrecision, context);
                }
            }
            if (context.ShouldSerialize("genderConcept")) {
                if ((_strong.GenderConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "genderConcept", _strong.GenderConceptKey, context);
                }
            }
            if (context.ShouldSerialize("genderConceptModel")) {
                if ((_strong.GenderConcept == null)) {
                    if ((_strong.GenderConceptKey.HasValue && context.ShouldForceLoad("genderConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "GenderConcept");
                        if ((_delay != null)) {
                            _strong.GenderConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "genderConceptModel", _strong.GenderConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("genderConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "genderConceptModel", _strong.GenderConcept, context);
                }
            }
            if (context.ShouldSerialize("dateOfBirth")) {
                if ((_strong.DateOfBirthXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "dateOfBirth", _strong.DateOfBirthXml, context);
                }
            }
            if (context.ShouldSerialize("language")) {
                if (((_strong.LanguageCommunication == null) 
                            || (_strong.LanguageCommunication.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("language", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.PersonLanguageCommunication> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.PersonLanguageCommunication>(_strong, "LanguageCommunication"));
                        if ((_delay.Count > 0)) {
                            _strong.LanguageCommunication = _delay;
                            context.JsonContext.WritePropertyUtil(w, "language", _strong.LanguageCommunication, context);
                        }
                        else {
                            context.RegisterMissTarget("language", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "language", _strong.LanguageCommunication, context);
                }
            }
            if (context.ShouldSerialize("occupation")) {
                if ((_strong.OccupationKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "occupation", _strong.OccupationKey, context);
                }
            }
            if (context.ShouldSerialize("occupationModel")) {
                if ((_strong.Occupation == null)) {
                    if ((_strong.OccupationKey.HasValue && context.ShouldForceLoad("occupationModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Occupation");
                        if ((_delay != null)) {
                            _strong.Occupation = _delay;
                            context.JsonContext.WritePropertyUtil(w, "occupationModel", _strong.Occupation, context);
                        }
                        else {
                            context.RegisterMissTarget("occupationModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "occupationModel", _strong.Occupation, context);
                }
            }
            if (context.ShouldSerialize("maritalStatusModel")) {
                if ((_strong.MaritalStatus == null)) {
                    if ((_strong.MaritalStatusKey.HasValue && context.ShouldForceLoad("maritalStatusModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MaritalStatus");
                        if ((_delay != null)) {
                            _strong.MaritalStatus = _delay;
                            context.JsonContext.WritePropertyUtil(w, "maritalStatusModel", _strong.MaritalStatus, context);
                        }
                        else {
                            context.RegisterMissTarget("maritalStatusModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "maritalStatusModel", _strong.MaritalStatus, context);
                }
            }
            if (context.ShouldSerialize("maritalStatus")) {
                if ((_strong.MaritalStatusKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "maritalStatus", _strong.MaritalStatusKey, context);
                }
            }
            if (context.ShouldSerialize("deceasedDate")) {
                if ((_strong.DeceasedDateXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "deceasedDate", _strong.DeceasedDateXml, context);
                }
            }
            if (context.ShouldSerialize("deceasedDatePrecision")) {
                if ((_strong.DeceasedDatePrecision == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "deceasedDatePrecision", _strong.DeceasedDatePrecision, context);
                }
            }
            if (context.ShouldSerialize("vipStatus")) {
                if ((_strong.VipStatusKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "vipStatus", _strong.VipStatusKey, context);
                }
            }
            if (context.ShouldSerialize("vipStatusModel")) {
                if ((_strong.VipStatus == null)) {
                    if ((_strong.VipStatusKey.HasValue && context.ShouldForceLoad("vipStatusModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "VipStatus");
                        if ((_delay != null)) {
                            _strong.VipStatus = _delay;
                            context.JsonContext.WritePropertyUtil(w, "vipStatusModel", _strong.VipStatus, context);
                        }
                        else {
                            context.RegisterMissTarget("vipStatusModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "vipStatusModel", _strong.VipStatus, context);
                }
            }
            if (context.ShouldSerialize("nationality")) {
                if ((_strong.NationalityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "nationality", _strong.NationalityKey, context);
                }
            }
            if (context.ShouldSerialize("nationalityModel")) {
                if ((_strong.Nationality == null)) {
                    if ((_strong.NationalityKey.HasValue && context.ShouldForceLoad("nationalityModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Nationality");
                        if ((_delay != null)) {
                            _strong.Nationality = _delay;
                            context.JsonContext.WritePropertyUtil(w, "nationalityModel", _strong.Nationality, context);
                        }
                        else {
                            context.RegisterMissTarget("nationalityModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "nationalityModel", _strong.Nationality, context);
                }
            }
            if (context.ShouldSerialize("address")) {
                if (((_strong.Addresses == null) 
                            || (_strong.Addresses.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("address", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityAddress>(_strong, "Addresses"));
                        if ((_delay.Count > 0)) {
                            _strong.Addresses = _delay;
                            context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                        }
                        else {
                            context.RegisterMissTarget("address", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "address", _strong.Addresses, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("creationActModel")) {
                if ((_strong.CreationAct == null)) {
                    if ((_strong.CreationActKey.HasValue && context.ShouldForceLoad("creationActModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "CreationAct");
                        if ((_delay != null)) {
                            _strong.CreationAct = _delay;
                            context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                        }
                        else {
                            context.RegisterMissTarget("creationActModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationActModel", _strong.CreationAct, context);
                }
            }
            if (context.ShouldSerialize("creationAct")) {
                if ((_strong.CreationActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationAct", _strong.CreationActKey, context);
                }
            }
            if (context.ShouldSerialize("determinerConceptModel")) {
                if ((_strong.DeterminerConcept == null)) {
                    if ((_strong.DeterminerConceptKey.HasValue && context.ShouldForceLoad("determinerConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DeterminerConcept");
                        if ((_delay != null)) {
                            _strong.DeterminerConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("determinerConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConceptModel", _strong.DeterminerConcept, context);
                }
            }
            if (context.ShouldSerialize("determinerConcept")) {
                if ((_strong.DeterminerConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "determinerConcept", _strong.DeterminerConceptKey, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.Names == null) 
                            || (_strong.Names.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityName>(_strong, "Names"));
                        if ((_delay.Count > 0)) {
                            _strong.Names = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Names, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.EntityTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("telecom")) {
                if (((_strong.Telecoms == null) 
                            || (_strong.Telecoms.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("telecom", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Entities.EntityTelecomAddress>(_strong, "Telecoms"));
                        if ((_delay.Count > 0)) {
                            _strong.Telecoms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                        }
                        else {
                            context.RegisterMissTarget("telecom", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "telecom", _strong.Telecoms, context);
                }
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Entities.UserEntity _retVal = new SanteDB.Core.Model.Entities.UserEntity();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Entities.UserEntity))) {
                        return ((SanteDB.Core.Model.Entities.UserEntity)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "securityUserModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityUser), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("securityUserModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SecurityUser = ((SanteDB.Core.Model.Security.SecurityUser)(_instance));
                    }
                    break;
case "securityUser":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("securityUser", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SecurityUserKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "dateOfBirthPrecision":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("dateOfBirthPrecision", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DateOfBirthPrecision = ((System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>)(_instance));
                    }
                    break;
case "genderConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("genderConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GenderConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "genderConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("genderConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GenderConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "dateOfBirth":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("dateOfBirth", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DateOfBirthXml = ((string)(_instance));
                    }
                    break;
case "language":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.PersonLanguageCommunication>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("language", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LanguageCommunication = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.PersonLanguageCommunication>)(_instance));
                    }
                    break;
case "occupation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("occupation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.OccupationKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "occupationModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("occupationModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Occupation = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "maritalStatusModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("maritalStatusModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MaritalStatus = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "maritalStatus":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("maritalStatus", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MaritalStatusKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "deceasedDate":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("deceasedDate", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeceasedDateXml = ((string)(_instance));
                    }
                    break;
case "deceasedDatePrecision":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("deceasedDatePrecision", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeceasedDatePrecision = ((System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>)(_instance));
                    }
                    break;
case "vipStatus":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("vipStatus", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VipStatusKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "vipStatusModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("vipStatusModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VipStatus = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "nationality":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("nationality", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.NationalityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "nationalityModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("nationalityModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Nationality = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "address":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("address", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Addresses = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityAddress>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationActModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationActModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationAct = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "creationAct":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationAct", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "determinerConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "determinerConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("determinerConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DeterminerConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityExtension>)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityIdentifier>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Names = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityName>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityNote>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityRelationship>)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.EntityTag>)(_instance));
                    }
                    break;
case "telecom":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("telecom", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Telecoms = ((System.Collections.Generic.List<SanteDB.Core.Model.Entities.EntityTelecomAddress>)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.AssigningAuthority"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class AssigningAuthorityViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.AssigningAuthority);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.AssigningAuthority _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.AssigningAuthority)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.AssigningAuthority)), e);
            }
            if (context.ShouldSerialize("assigningApplication")) {
                if ((_strong.AssigningApplicationKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "assigningApplication", _strong.AssigningApplicationKey, context);
                }
            }
            if (context.ShouldSerialize("assigningApplicationModel")) {
                if ((_strong.AssigningApplication == null)) {
                    if ((_strong.AssigningApplicationKey.HasValue && context.ShouldForceLoad("assigningApplicationModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityApplication _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityApplication>(_strong, "AssigningApplication");
                        if ((_delay != null)) {
                            _strong.AssigningApplication = _delay;
                            context.JsonContext.WritePropertyUtil(w, "assigningApplicationModel", _strong.AssigningApplication, context);
                        }
                        else {
                            context.RegisterMissTarget("assigningApplicationModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "assigningApplicationModel", _strong.AssigningApplication, context);
                }
            }
            if (context.ShouldSerialize("reliability")) {
                context.JsonContext.WritePropertyUtil(w, "reliability", _strong.Reliability, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.IdentityDomain _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.IdentityDomain>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.AssigningAuthority _retVal = new SanteDB.Core.Model.DataTypes.AssigningAuthority();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.AssigningAuthority))) {
                        return ((SanteDB.Core.Model.DataTypes.AssigningAuthority)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "assigningApplication":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("assigningApplication", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AssigningApplicationKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "assigningApplicationModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityApplication), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("assigningApplicationModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AssigningApplication = ((SanteDB.Core.Model.Security.SecurityApplication)(_instance));
                    }
                    break;
case "reliability":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.IdentifierReliability), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reliability", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Reliability = ((SanteDB.Core.Model.DataTypes.IdentifierReliability)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.IdentityDomain), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.DataTypes.IdentityDomain)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.CodeSystem"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class CodeSystemViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.CodeSystem);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.CodeSystem _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.CodeSystem)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.CodeSystem)), e);
            }
            if (context.ShouldSerialize("name")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("oid")) {
                if ((_strong.Oid == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "oid", _strong.Oid, context);
                }
            }
            if (context.ShouldSerialize("authority")) {
                if ((_strong.Domain == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "authority", _strong.Domain, context);
                }
            }
            if (context.ShouldSerialize("url")) {
                if ((_strong.Url == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "url", _strong.Url, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionText == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionText, context);
                }
            }
            if (context.ShouldSerialize("description")) {
                if ((_strong.Description == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "description", _strong.Description, context);
                }
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.CodeSystem _retVal = new SanteDB.Core.Model.DataTypes.CodeSystem();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.CodeSystem))) {
                        return ((SanteDB.Core.Model.DataTypes.CodeSystem)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "oid":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("oid", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Oid = ((string)(_instance));
                    }
                    break;
case "authority":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("authority", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Domain = ((string)(_instance));
                    }
                    break;
case "url":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("url", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Url = ((string)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionText = ((string)(_instance));
                    }
                    break;
case "description":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("description", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Description = ((string)(_instance));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.Concept"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ConceptViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.Concept);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.Concept _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.Concept)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.Concept)), e);
            }
            if (context.ShouldSerialize("mnemonic")) {
                if ((_strong.Mnemonic == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "mnemonic", _strong.Mnemonic, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ConceptRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("conceptClass")) {
                if ((_strong.ClassKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "conceptClass", _strong.ClassKey, context);
                }
            }
            if (context.ShouldSerialize("conceptClassModel")) {
                if ((_strong.Class == null)) {
                    if ((_strong.ClassKey.HasValue && context.ShouldForceLoad("conceptClassModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.ConceptClass _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.ConceptClass>(_strong, "Class");
                        if ((_delay != null)) {
                            _strong.Class = _delay;
                            context.JsonContext.WritePropertyUtil(w, "conceptClassModel", _strong.Class, context);
                        }
                        else {
                            context.RegisterMissTarget("conceptClassModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "conceptClassModel", _strong.Class, context);
                }
            }
            if (context.ShouldSerialize("referenceTerm")) {
                if (((_strong.ReferenceTerms == null) 
                            || (_strong.ReferenceTerms.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("referenceTerm", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptReferenceTerm> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ConceptReferenceTerm>(_strong, "ReferenceTerms"));
                        if ((_delay.Count > 0)) {
                            _strong.ReferenceTerms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "referenceTerm", _strong.ReferenceTerms, context);
                        }
                        else {
                            context.RegisterMissTarget("referenceTerm", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "referenceTerm", _strong.ReferenceTerms, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.ConceptNames == null) 
                            || (_strong.ConceptNames.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ConceptName>(_strong, "ConceptNames"));
                        if ((_delay.Count > 0)) {
                            _strong.ConceptNames = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.ConceptNames, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.ConceptNames, context);
                }
            }
            if (context.ShouldSerialize("conceptSet")) {
                if (((_strong.ConceptSetsXml == null) 
                            || (_strong.ConceptSetsXml.Count == 0))) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "conceptSet", _strong.ConceptSetsXml, context);
                }
            }
            if (context.ShouldSerialize("conceptSetModel")) {
                if (((_strong.ConceptSets == null) 
                            || (_strong.ConceptSets.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("conceptSetModel", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptSet> _delay = null;
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "conceptSetModel", _strong.ConceptSets, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ConceptTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ConceptExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.Concept _retVal = new SanteDB.Core.Model.DataTypes.Concept();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.Concept))) {
                        return ((SanteDB.Core.Model.DataTypes.Concept)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "mnemonic":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("mnemonic", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Mnemonic = ((string)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptRelationship>)(_instance));
                    }
                    break;
case "conceptClass":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("conceptClass", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "conceptClassModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.ConceptClass), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("conceptClassModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Class = ((SanteDB.Core.Model.DataTypes.ConceptClass)(_instance));
                    }
                    break;
case "referenceTerm":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptReferenceTerm>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("referenceTerm", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReferenceTerms = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptReferenceTerm>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ConceptNames = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptName>)(_instance));
                    }
                    break;
case "conceptSet":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("conceptSet", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ConceptSetsXml = ((System.Collections.Generic.List<System.Guid>)(_instance));
                    }
                    break;
case "conceptSetModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptSet>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("conceptSetModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ConceptSets = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptSet>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptTag>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptExtension>)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ConceptClass"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ConceptClassViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ConceptClass);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ConceptClass _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ConceptClass)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ConceptClass)), e);
            }
            if (context.ShouldSerialize("name")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("mnemonic")) {
                if ((_strong.Mnemonic == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "mnemonic", _strong.Mnemonic, context);
                }
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ConceptClass _retVal = new SanteDB.Core.Model.DataTypes.ConceptClass();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ConceptClass))) {
                        return ((SanteDB.Core.Model.DataTypes.ConceptClass)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "mnemonic":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("mnemonic", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Mnemonic = ((string)(_instance));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ConceptName"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ConceptNameViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ConceptName);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ConceptName _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ConceptName)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ConceptName)), e);
            }
            if (context.ShouldSerialize("language")) {
                if ((_strong.Language == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "language", _strong.Language, context);
                }
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ConceptName _retVal = new SanteDB.Core.Model.DataTypes.ConceptName();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ConceptName))) {
                        return ((SanteDB.Core.Model.DataTypes.ConceptName)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "language":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("language", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Language = ((string)(_instance));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            string _strong = null;
            if ((o == null)) {
                return null;
            }
            try {
                _strong = o.ToString();
            }
            catch (System.Exception e) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.ConceptName _retVal = new SanteDB.Core.Model.DataTypes.ConceptName();
            _retVal.Name = _strong;
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            if ((o == null)) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.ConceptName _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ConceptName)(o));
            }
            catch (System.Exception e) {
                return null;
            }
            return _strong.Name;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ConceptReferenceTerm"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ConceptReferenceTermViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ConceptReferenceTerm);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ConceptReferenceTerm _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ConceptReferenceTerm)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ConceptReferenceTerm)), e);
            }
            if (context.ShouldSerialize("term")) {
                if ((_strong.ReferenceTermKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "term", _strong.ReferenceTermKey, context);
                }
            }
            if (context.ShouldSerialize("termModel")) {
                if ((_strong.ReferenceTerm == null)) {
                    if ((_strong.ReferenceTermKey.HasValue && context.ShouldForceLoad("termModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.ReferenceTerm _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.ReferenceTerm>(_strong, "ReferenceTerm");
                        if ((_delay != null)) {
                            _strong.ReferenceTerm = _delay;
                            context.JsonContext.WritePropertyUtil(w, "termModel", _strong.ReferenceTerm, context);
                        }
                        else {
                            context.RegisterMissTarget("termModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "termModel", _strong.ReferenceTerm, context);
                }
            }
            if (context.ShouldSerialize("relationshipType")) {
                if ((_strong.RelationshipTypeKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationshipType", _strong.RelationshipTypeKey, context);
                }
            }
            if (context.ShouldSerialize("relationshipTypeModel")) {
                if ((_strong.RelationshipType == null)) {
                    if ((_strong.RelationshipTypeKey.HasValue && context.ShouldForceLoad("relationshipTypeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.ConceptRelationshipType _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.ConceptRelationshipType>(_strong, "RelationshipType");
                        if ((_delay != null)) {
                            _strong.RelationshipType = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationshipTypeModel", _strong.RelationshipType, context);
                        }
                        else {
                            context.RegisterMissTarget("relationshipTypeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationshipTypeModel", _strong.RelationshipType, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ConceptReferenceTerm _retVal = new SanteDB.Core.Model.DataTypes.ConceptReferenceTerm();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ConceptReferenceTerm))) {
                        return ((SanteDB.Core.Model.DataTypes.ConceptReferenceTerm)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "term":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("term", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReferenceTermKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "termModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.ReferenceTerm), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("termModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReferenceTerm = ((SanteDB.Core.Model.DataTypes.ReferenceTerm)(_instance));
                    }
                    break;
case "relationshipType":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationshipType", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.RelationshipTypeKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "relationshipTypeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.ConceptRelationshipType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationshipTypeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.RelationshipType = ((SanteDB.Core.Model.DataTypes.ConceptRelationshipType)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ConceptRelationship"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ConceptRelationshipViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ConceptRelationship);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ConceptRelationship _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ConceptRelationship)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ConceptRelationship)), e);
            }
            if (context.ShouldSerialize("targetConcept")) {
                if ((_strong.TargetConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "targetConcept", _strong.TargetConceptKey, context);
                }
            }
            if (context.ShouldSerialize("targetConceptModel")) {
                if ((_strong.TargetConcept == null)) {
                    if ((_strong.TargetConceptKey.HasValue && context.ShouldForceLoad("targetConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TargetConcept");
                        if ((_delay != null)) {
                            _strong.TargetConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "targetConceptModel", _strong.TargetConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("targetConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "targetConceptModel", _strong.TargetConcept, context);
                }
            }
            if (context.ShouldSerialize("relationshipType")) {
                if ((_strong.RelationshipTypeKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationshipType", _strong.RelationshipTypeKey, context);
                }
            }
            if (context.ShouldSerialize("relationshipTypeModel")) {
                if ((_strong.RelationshipType == null)) {
                    if ((_strong.RelationshipTypeKey.HasValue && context.ShouldForceLoad("relationshipTypeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.ConceptRelationshipType _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.ConceptRelationshipType>(_strong, "RelationshipType");
                        if ((_delay != null)) {
                            _strong.RelationshipType = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationshipTypeModel", _strong.RelationshipType, context);
                        }
                        else {
                            context.RegisterMissTarget("relationshipTypeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationshipTypeModel", _strong.RelationshipType, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ConceptRelationship _retVal = new SanteDB.Core.Model.DataTypes.ConceptRelationship();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ConceptRelationship))) {
                        return ((SanteDB.Core.Model.DataTypes.ConceptRelationship)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "targetConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("targetConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TargetConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "targetConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("targetConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TargetConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "relationshipType":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationshipType", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.RelationshipTypeKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "relationshipTypeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.ConceptRelationshipType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationshipTypeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.RelationshipType = ((SanteDB.Core.Model.DataTypes.ConceptRelationshipType)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ConceptRelationshipType"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ConceptRelationshipTypeViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ConceptRelationshipType);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ConceptRelationshipType _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ConceptRelationshipType)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ConceptRelationshipType)), e);
            }
            if (context.ShouldSerialize("name")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("mnemonic")) {
                if ((_strong.Mnemonic == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "mnemonic", _strong.Mnemonic, context);
                }
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ConceptRelationshipType _retVal = new SanteDB.Core.Model.DataTypes.ConceptRelationshipType();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ConceptRelationshipType))) {
                        return ((SanteDB.Core.Model.DataTypes.ConceptRelationshipType)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "mnemonic":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("mnemonic", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Mnemonic = ((string)(_instance));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ConceptSet"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ConceptSetViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ConceptSet);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ConceptSet _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ConceptSet)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ConceptSet)), e);
            }
            if (context.ShouldSerialize("name")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("mnemonic")) {
                if ((_strong.Mnemonic == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "mnemonic", _strong.Mnemonic, context);
                }
            }
            if (context.ShouldSerialize("oid")) {
                if ((_strong.Oid == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "oid", _strong.Oid, context);
                }
            }
            if (context.ShouldSerialize("url")) {
                if ((_strong.Url == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "url", _strong.Url, context);
                }
            }
            if (context.ShouldSerialize("concept")) {
                if (((_strong.ConceptsXml == null) 
                            || (_strong.ConceptsXml.Count == 0))) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "concept", _strong.ConceptsXml, context);
                }
            }
            if (context.ShouldSerialize("compose")) {
                if (((_strong.Composition == null) 
                            || (_strong.Composition.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("compose", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptSetComposition> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ConceptSetComposition>(_strong, "Composition"));
                        if ((_delay.Count > 0)) {
                            _strong.Composition = _delay;
                            context.JsonContext.WritePropertyUtil(w, "compose", _strong.Composition, context);
                        }
                        else {
                            context.RegisterMissTarget("compose", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "compose", _strong.Composition, context);
                }
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ConceptSet _retVal = new SanteDB.Core.Model.DataTypes.ConceptSet();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ConceptSet))) {
                        return ((SanteDB.Core.Model.DataTypes.ConceptSet)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "mnemonic":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("mnemonic", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Mnemonic = ((string)(_instance));
                    }
                    break;
case "oid":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("oid", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Oid = ((string)(_instance));
                    }
                    break;
case "url":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("url", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Url = ((string)(_instance));
                    }
                    break;
case "concept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("concept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ConceptsXml = ((System.Collections.Generic.List<System.Guid>)(_instance));
                    }
                    break;
case "compose":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptSetComposition>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("compose", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Composition = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ConceptSetComposition>)(_instance));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ConceptSetComposition"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ConceptSetCompositionViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ConceptSetComposition);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ConceptSetComposition _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ConceptSetComposition)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ConceptSetComposition)), e);
            }
            if (context.ShouldSerialize("instruction")) {
                context.JsonContext.WritePropertyUtil(w, "instruction", _strong.Operation, context);
            }
            if (context.ShouldSerialize("target")) {
                if ((_strong.TargetKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "target", _strong.TargetKey, context);
                }
            }
            if (context.ShouldSerialize("targetModel")) {
                if ((_strong.Target == null)) {
                    if ((_strong.TargetKey.HasValue && context.ShouldForceLoad("targetModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.ConceptSet _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.ConceptSet>(_strong, "Target");
                        if ((_delay != null)) {
                            _strong.Target = _delay;
                            context.JsonContext.WritePropertyUtil(w, "targetModel", _strong.Target, context);
                        }
                        else {
                            context.RegisterMissTarget("targetModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "targetModel", _strong.Target, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.ConceptSet _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.ConceptSet>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ConceptSetComposition _retVal = new SanteDB.Core.Model.DataTypes.ConceptSetComposition();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ConceptSetComposition))) {
                        return ((SanteDB.Core.Model.DataTypes.ConceptSetComposition)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "instruction":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.ConceptSetCompositionOperation), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("instruction", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Operation = ((SanteDB.Core.Model.DataTypes.ConceptSetCompositionOperation)(_instance));
                    }
                    break;
case "target":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("target", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TargetKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "targetModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.ConceptSet), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("targetModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Target = ((SanteDB.Core.Model.DataTypes.ConceptSet)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.ConceptSet), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.DataTypes.ConceptSet)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ConceptExtension"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ConceptExtensionViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ConceptExtension);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ConceptExtension _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ConceptExtension)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ConceptExtension)), e);
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.ExtensionValueData == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.ExtensionValueData, context);
                }
            }
            if (context.ShouldSerialize("externId")) {
                if ((_strong.ExternalKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "externId", _strong.ExternalKey, context);
                }
            }
            if (context.ShouldSerialize("valueModel")) {
                if ((_strong.ExtensionValueString == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "valueModel", _strong.ExtensionValueString, context);
                }
            }
            if (context.ShouldSerialize("extensionTypeModel")) {
                if ((_strong.ExtensionType == null)) {
                    if ((_strong.ExtensionTypeKey.HasValue && context.ShouldForceLoad("extensionTypeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.ExtensionType _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.ExtensionType>(_strong, "ExtensionType");
                        if ((_delay != null)) {
                            _strong.ExtensionType = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extensionTypeModel", _strong.ExtensionType, context);
                        }
                        else {
                            context.RegisterMissTarget("extensionTypeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extensionTypeModel", _strong.ExtensionType, context);
                }
            }
            if (context.ShouldSerialize("extensionType")) {
                if ((_strong.ExtensionTypeKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extensionType", _strong.ExtensionTypeKey, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ConceptExtension _retVal = new SanteDB.Core.Model.DataTypes.ConceptExtension();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ConceptExtension))) {
                        return ((SanteDB.Core.Model.DataTypes.ConceptExtension)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(byte[]), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExtensionValueData = ((byte[])(_instance));
                    }
                    break;
case "externId":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("externId", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalKey = ((string)(_instance));
                    }
                    break;
case "valueModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("valueModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExtensionValueString = ((string)(_instance));
                    }
                    break;
case "extensionTypeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.ExtensionType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extensionTypeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExtensionType = ((SanteDB.Core.Model.DataTypes.ExtensionType)(_instance));
                    }
                    break;
case "extensionType":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extensionType", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExtensionTypeKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            byte[] _strong = null;
            if ((o == null)) {
                return null;
            }
            try {
                if ((o.GetType() == typeof(string))) {
                    string _str;
                    try {
                        _str = o.ToString();
                    }
                    catch (System.Exception e) {
                        return null;
                    }
                    _strong = System.Convert.FromBase64String(_str);
                }
                else {
                    _strong = ((byte[])(o));
                }
            }
            catch (System.Exception e) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.ConceptExtension _retVal = new SanteDB.Core.Model.DataTypes.ConceptExtension();
            _retVal.ExtensionValueData = _strong;
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            if ((o == null)) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.ConceptExtension _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ConceptExtension)(o));
            }
            catch (System.Exception e) {
                return null;
            }
            return _strong.ExtensionValueData;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.EntityExtension"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class EntityExtensionViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.EntityExtension);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.EntityExtension _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.EntityExtension)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.EntityExtension)), e);
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.ExtensionValueData == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.ExtensionValueData, context);
                }
            }
            if (context.ShouldSerialize("externId")) {
                if ((_strong.ExternalKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "externId", _strong.ExternalKey, context);
                }
            }
            if (context.ShouldSerialize("valueModel")) {
                if ((_strong.ExtensionValueString == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "valueModel", _strong.ExtensionValueString, context);
                }
            }
            if (context.ShouldSerialize("extensionTypeModel")) {
                if ((_strong.ExtensionType == null)) {
                    if ((_strong.ExtensionTypeKey.HasValue && context.ShouldForceLoad("extensionTypeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.ExtensionType _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.ExtensionType>(_strong, "ExtensionType");
                        if ((_delay != null)) {
                            _strong.ExtensionType = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extensionTypeModel", _strong.ExtensionType, context);
                        }
                        else {
                            context.RegisterMissTarget("extensionTypeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extensionTypeModel", _strong.ExtensionType, context);
                }
            }
            if (context.ShouldSerialize("extensionType")) {
                if ((_strong.ExtensionTypeKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extensionType", _strong.ExtensionTypeKey, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.EntityExtension _retVal = new SanteDB.Core.Model.DataTypes.EntityExtension();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.EntityExtension))) {
                        return ((SanteDB.Core.Model.DataTypes.EntityExtension)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(byte[]), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExtensionValueData = ((byte[])(_instance));
                    }
                    break;
case "externId":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("externId", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalKey = ((string)(_instance));
                    }
                    break;
case "valueModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("valueModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExtensionValueString = ((string)(_instance));
                    }
                    break;
case "extensionTypeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.ExtensionType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extensionTypeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExtensionType = ((SanteDB.Core.Model.DataTypes.ExtensionType)(_instance));
                    }
                    break;
case "extensionType":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extensionType", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExtensionTypeKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            byte[] _strong = null;
            if ((o == null)) {
                return null;
            }
            try {
                if ((o.GetType() == typeof(string))) {
                    string _str;
                    try {
                        _str = o.ToString();
                    }
                    catch (System.Exception e) {
                        return null;
                    }
                    _strong = System.Convert.FromBase64String(_str);
                }
                else {
                    _strong = ((byte[])(o));
                }
            }
            catch (System.Exception e) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.EntityExtension _retVal = new SanteDB.Core.Model.DataTypes.EntityExtension();
            _retVal.ExtensionValueData = _strong;
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            if ((o == null)) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.EntityExtension _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.EntityExtension)(o));
            }
            catch (System.Exception e) {
                return null;
            }
            return _strong.ExtensionValueData;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ActExtension"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ActExtensionViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ActExtension);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ActExtension _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ActExtension)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ActExtension)), e);
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.ExtensionValueData == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.ExtensionValueData, context);
                }
            }
            if (context.ShouldSerialize("externId")) {
                if ((_strong.ExternalKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "externId", _strong.ExternalKey, context);
                }
            }
            if (context.ShouldSerialize("valueModel")) {
                if ((_strong.ExtensionValueString == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "valueModel", _strong.ExtensionValueString, context);
                }
            }
            if (context.ShouldSerialize("extensionTypeModel")) {
                if ((_strong.ExtensionType == null)) {
                    if ((_strong.ExtensionTypeKey.HasValue && context.ShouldForceLoad("extensionTypeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.ExtensionType _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.ExtensionType>(_strong, "ExtensionType");
                        if ((_delay != null)) {
                            _strong.ExtensionType = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extensionTypeModel", _strong.ExtensionType, context);
                        }
                        else {
                            context.RegisterMissTarget("extensionTypeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extensionTypeModel", _strong.ExtensionType, context);
                }
            }
            if (context.ShouldSerialize("extensionType")) {
                if ((_strong.ExtensionTypeKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extensionType", _strong.ExtensionTypeKey, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ActExtension _retVal = new SanteDB.Core.Model.DataTypes.ActExtension();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ActExtension))) {
                        return ((SanteDB.Core.Model.DataTypes.ActExtension)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(byte[]), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExtensionValueData = ((byte[])(_instance));
                    }
                    break;
case "externId":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("externId", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalKey = ((string)(_instance));
                    }
                    break;
case "valueModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("valueModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExtensionValueString = ((string)(_instance));
                    }
                    break;
case "extensionTypeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.ExtensionType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extensionTypeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExtensionType = ((SanteDB.Core.Model.DataTypes.ExtensionType)(_instance));
                    }
                    break;
case "extensionType":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extensionType", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExtensionTypeKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            byte[] _strong = null;
            if ((o == null)) {
                return null;
            }
            try {
                if ((o.GetType() == typeof(string))) {
                    string _str;
                    try {
                        _str = o.ToString();
                    }
                    catch (System.Exception e) {
                        return null;
                    }
                    _strong = System.Convert.FromBase64String(_str);
                }
                else {
                    _strong = ((byte[])(o));
                }
            }
            catch (System.Exception e) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.ActExtension _retVal = new SanteDB.Core.Model.DataTypes.ActExtension();
            _retVal.ExtensionValueData = _strong;
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            if ((o == null)) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.ActExtension _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ActExtension)(o));
            }
            catch (System.Exception e) {
                return null;
            }
            return _strong.ExtensionValueData;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ExtensionType"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ExtensionTypeViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ExtensionType);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ExtensionType _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ExtensionType)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ExtensionType)), e);
            }
            if (context.ShouldSerialize("handlerClass")) {
                if ((_strong.ExtensionHandlerXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "handlerClass", _strong.ExtensionHandlerXml, context);
                }
            }
            if (context.ShouldSerialize("uri")) {
                if ((_strong.Uri == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "uri", _strong.Uri, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("scope")) {
                if (((_strong.ScopeXml == null) 
                            || (_strong.ScopeXml.Count == 0))) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "scope", _strong.ScopeXml, context);
                }
            }
            if (context.ShouldSerialize("scopeModel")) {
                if (((_strong.Scope == null) 
                            || (_strong.Scope.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("scopeModel", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.Concept> _delay = null;
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "scopeModel", _strong.Scope, context);
                }
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ExtensionType _retVal = new SanteDB.Core.Model.DataTypes.ExtensionType();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ExtensionType))) {
                        return ((SanteDB.Core.Model.DataTypes.ExtensionType)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "handlerClass":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("handlerClass", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExtensionHandlerXml = ((string)(_instance));
                    }
                    break;
case "uri":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("uri", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Uri = ((string)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "scope":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("scope", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ScopeXml = ((System.Collections.Generic.List<System.Guid>)(_instance));
                    }
                    break;
case "scopeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.Concept>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("scopeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Scope = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.Concept>)(_instance));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.GeoTag"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class GeoTagViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.GeoTag);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.GeoTag _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.GeoTag)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.GeoTag)), e);
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("lat")) {
                if ((_strong.Lat == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lat", _strong.Lat, context);
                }
            }
            if (context.ShouldSerialize("lng")) {
                if ((_strong.Lng == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "lng", _strong.Lng, context);
                }
            }
            if (context.ShouldSerialize("precise")) {
                if ((_strong.Precise == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "precise", _strong.Precise, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.GeoTag _retVal = new SanteDB.Core.Model.DataTypes.GeoTag();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.GeoTag))) {
                        return ((SanteDB.Core.Model.DataTypes.GeoTag)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "lat":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<double>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lat", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Lat = ((System.Nullable<double>)(_instance));
                    }
                    break;
case "lng":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<double>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("lng", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Lng = ((System.Nullable<double>)(_instance));
                    }
                    break;
case "precise":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<bool>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("precise", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Precise = ((System.Nullable<bool>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.IdentifiedDataReference"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ReferenceViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.IdentifiedDataReference);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.IdentifiedDataReference _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.IdentifiedDataReference)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.IdentifiedDataReference)), e);
            }
            if (context.ShouldSerialize("refType")) {
                if ((_strong.ReferencedTypeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "refType", _strong.ReferencedTypeXml, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.IdentifiedDataReference _retVal = new SanteDB.Core.Model.DataTypes.IdentifiedDataReference();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.IdentifiedDataReference))) {
                        return ((SanteDB.Core.Model.DataTypes.IdentifiedDataReference)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "refType":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("refType", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReferencedTypeXml = ((string)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.EntityIdentifier"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class EntityIdentifierViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.EntityIdentifier);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.EntityIdentifier _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.EntityIdentifier)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.EntityIdentifier)), e);
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.Value == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.Value, context);
                }
            }
            if (context.ShouldSerialize("externId")) {
                if ((_strong.ExternalKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "externId", _strong.ExternalKey, context);
                }
            }
            if (context.ShouldSerialize("issued")) {
                if ((_strong.IssueDateXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "issued", _strong.IssueDateXml, context);
                }
            }
            if (context.ShouldSerialize("expires")) {
                if ((_strong.ExpiryDateXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "expires", _strong.ExpiryDateXml, context);
                }
            }
            if (context.ShouldSerialize("checkDigit")) {
                if ((_strong.CheckDigit == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "checkDigit", _strong.CheckDigit, context);
                }
            }
            if (context.ShouldSerialize("domain")) {
                if ((_strong.IdentityDomainKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "domain", _strong.IdentityDomainKey, context);
                }
            }
            if (context.ShouldSerialize("type")) {
                if ((_strong.IdentifierTypeKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "type", _strong.IdentifierTypeKey, context);
                }
            }
            if (context.ShouldSerialize("typeModel")) {
                if ((_strong.IdentifierType == null)) {
                    if ((_strong.IdentifierTypeKey.HasValue && context.ShouldForceLoad("typeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "IdentifierType");
                        if ((_delay != null)) {
                            _strong.IdentifierType = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeModel", _strong.IdentifierType, context);
                        }
                        else {
                            context.RegisterMissTarget("typeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeModel", _strong.IdentifierType, context);
                }
            }
            if (context.ShouldSerialize("domainModel")) {
                if ((_strong.IdentityDomain == null)) {
                    if ((_strong.IdentityDomainKey.HasValue && context.ShouldForceLoad("domainModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.IdentityDomain _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.IdentityDomain>(_strong, "IdentityDomain");
                        if ((_delay != null)) {
                            _strong.IdentityDomain = _delay;
                            context.JsonContext.WritePropertyUtil(w, "domainModel", _strong.IdentityDomain, context);
                        }
                        else {
                            context.RegisterMissTarget("domainModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "domainModel", _strong.IdentityDomain, context);
                }
            }
            if (context.ShouldSerialize("reliability")) {
                context.JsonContext.WritePropertyUtil(w, "reliability", _strong.Reliability, context);
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.EntityIdentifier _retVal = new SanteDB.Core.Model.DataTypes.EntityIdentifier();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.EntityIdentifier))) {
                        return ((SanteDB.Core.Model.DataTypes.EntityIdentifier)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Value = ((string)(_instance));
                    }
                    break;
case "externId":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("externId", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalKey = ((string)(_instance));
                    }
                    break;
case "issued":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("issued", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IssueDateXml = ((string)(_instance));
                    }
                    break;
case "expires":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("expires", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExpiryDateXml = ((string)(_instance));
                    }
                    break;
case "checkDigit":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("checkDigit", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CheckDigit = ((string)(_instance));
                    }
                    break;
case "domain":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("domain", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IdentityDomainKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "type":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("type", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IdentifierTypeKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IdentifierType = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "domainModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.IdentityDomain), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("domainModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IdentityDomain = ((SanteDB.Core.Model.DataTypes.IdentityDomain)(_instance));
                    }
                    break;
case "reliability":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.IdentifierReliability), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reliability", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Reliability = ((SanteDB.Core.Model.DataTypes.IdentifierReliability)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ActIdentifier"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ActIdentifierViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ActIdentifier);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ActIdentifier _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ActIdentifier)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ActIdentifier)), e);
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.Value == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.Value, context);
                }
            }
            if (context.ShouldSerialize("externId")) {
                if ((_strong.ExternalKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "externId", _strong.ExternalKey, context);
                }
            }
            if (context.ShouldSerialize("issued")) {
                if ((_strong.IssueDateXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "issued", _strong.IssueDateXml, context);
                }
            }
            if (context.ShouldSerialize("expires")) {
                if ((_strong.ExpiryDateXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "expires", _strong.ExpiryDateXml, context);
                }
            }
            if (context.ShouldSerialize("checkDigit")) {
                if ((_strong.CheckDigit == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "checkDigit", _strong.CheckDigit, context);
                }
            }
            if (context.ShouldSerialize("domain")) {
                if ((_strong.IdentityDomainKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "domain", _strong.IdentityDomainKey, context);
                }
            }
            if (context.ShouldSerialize("type")) {
                if ((_strong.IdentifierTypeKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "type", _strong.IdentifierTypeKey, context);
                }
            }
            if (context.ShouldSerialize("typeModel")) {
                if ((_strong.IdentifierType == null)) {
                    if ((_strong.IdentifierTypeKey.HasValue && context.ShouldForceLoad("typeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "IdentifierType");
                        if ((_delay != null)) {
                            _strong.IdentifierType = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeModel", _strong.IdentifierType, context);
                        }
                        else {
                            context.RegisterMissTarget("typeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeModel", _strong.IdentifierType, context);
                }
            }
            if (context.ShouldSerialize("domainModel")) {
                if ((_strong.IdentityDomain == null)) {
                    if ((_strong.IdentityDomainKey.HasValue && context.ShouldForceLoad("domainModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.IdentityDomain _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.IdentityDomain>(_strong, "IdentityDomain");
                        if ((_delay != null)) {
                            _strong.IdentityDomain = _delay;
                            context.JsonContext.WritePropertyUtil(w, "domainModel", _strong.IdentityDomain, context);
                        }
                        else {
                            context.RegisterMissTarget("domainModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "domainModel", _strong.IdentityDomain, context);
                }
            }
            if (context.ShouldSerialize("reliability")) {
                context.JsonContext.WritePropertyUtil(w, "reliability", _strong.Reliability, context);
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ActIdentifier _retVal = new SanteDB.Core.Model.DataTypes.ActIdentifier();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ActIdentifier))) {
                        return ((SanteDB.Core.Model.DataTypes.ActIdentifier)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Value = ((string)(_instance));
                    }
                    break;
case "externId":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("externId", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalKey = ((string)(_instance));
                    }
                    break;
case "issued":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("issued", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IssueDateXml = ((string)(_instance));
                    }
                    break;
case "expires":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("expires", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExpiryDateXml = ((string)(_instance));
                    }
                    break;
case "checkDigit":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("checkDigit", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CheckDigit = ((string)(_instance));
                    }
                    break;
case "domain":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("domain", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IdentityDomainKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "type":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("type", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IdentifierTypeKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IdentifierType = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "domainModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.IdentityDomain), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("domainModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IdentityDomain = ((SanteDB.Core.Model.DataTypes.IdentityDomain)(_instance));
                    }
                    break;
case "reliability":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.IdentifierReliability), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reliability", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Reliability = ((SanteDB.Core.Model.DataTypes.IdentifierReliability)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.IdentityDomain"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class IdentityDomainViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.IdentityDomain);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.IdentityDomain _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.IdentityDomain)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.IdentityDomain)), e);
            }
            if (context.ShouldSerialize("name")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("domainName")) {
                if ((_strong.DomainName == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "domainName", _strong.DomainName, context);
                }
            }
            if (context.ShouldSerialize("description")) {
                if ((_strong.Description == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "description", _strong.Description, context);
                }
            }
            if (context.ShouldSerialize("oid")) {
                if ((_strong.Oid == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "oid", _strong.Oid, context);
                }
            }
            if (context.ShouldSerialize("url")) {
                if ((_strong.Url == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "url", _strong.Url, context);
                }
            }
            if (context.ShouldSerialize("assigningAuthority")) {
                if (((_strong.AssigningAuthority == null) 
                            || (_strong.AssigningAuthority.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("assigningAuthority", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.AssigningAuthority> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.AssigningAuthority>(_strong, "AssigningAuthority"));
                        if ((_delay.Count > 0)) {
                            _strong.AssigningAuthority = _delay;
                            context.JsonContext.WritePropertyUtil(w, "assigningAuthority", _strong.AssigningAuthority, context);
                        }
                        else {
                            context.RegisterMissTarget("assigningAuthority", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "assigningAuthority", _strong.AssigningAuthority, context);
                }
            }
            if (context.ShouldSerialize("policyModel")) {
                if ((_strong.Policy == null)) {
                    if ((_strong.PolicyKey.HasValue && context.ShouldForceLoad("policyModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityPolicy _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityPolicy>(_strong, "Policy");
                        if ((_delay != null)) {
                            _strong.Policy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policyModel", _strong.Policy, context);
                        }
                        else {
                            context.RegisterMissTarget("policyModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policyModel", _strong.Policy, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if ((_strong.PolicyKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.PolicyKey, context);
                }
            }
            if (context.ShouldSerialize("identifierClass")) {
                if ((_strong.IdentifierClassificationKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifierClass", _strong.IdentifierClassificationKey, context);
                }
            }
            if (context.ShouldSerialize("validation")) {
                if ((_strong.ValidationRegex == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "validation", _strong.ValidationRegex, context);
                }
            }
            if (context.ShouldSerialize("isUnique")) {
                context.JsonContext.WritePropertyUtil(w, "isUnique", _strong.IsUnique, context);
            }
            if (context.ShouldSerialize("customValidator")) {
                if ((_strong.CustomValidator == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "customValidator", _strong.CustomValidator, context);
                }
            }
            if (context.ShouldSerialize("checkDigitAlgorithm")) {
                if ((_strong.CheckDigitAlgorithm == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "checkDigitAlgorithm", _strong.CheckDigitAlgorithm, context);
                }
            }
            if (context.ShouldSerialize("scope")) {
                if (((_strong.AuthorityScopeXml == null) 
                            || (_strong.AuthorityScopeXml.Count == 0))) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "scope", _strong.AuthorityScopeXml, context);
                }
            }
            if (context.ShouldSerialize("scopeModel")) {
                if (((_strong.AuthorityScope == null) 
                            || (_strong.AuthorityScope.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("scopeModel", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.Concept> _delay = null;
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "scopeModel", _strong.AuthorityScope, context);
                }
            }
            if (context.ShouldSerialize("identifierClassModel")) {
                if ((_strong.IdentifierClassification == null)) {
                    if ((_strong.IdentifierClassificationKey.HasValue && context.ShouldForceLoad("identifierClassModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "IdentifierClassification");
                        if ((_delay != null)) {
                            _strong.IdentifierClassification = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifierClassModel", _strong.IdentifierClassification, context);
                        }
                        else {
                            context.RegisterMissTarget("identifierClassModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifierClassModel", _strong.IdentifierClassification, context);
                }
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.IdentityDomain _retVal = new SanteDB.Core.Model.DataTypes.IdentityDomain();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.IdentityDomain))) {
                        return ((SanteDB.Core.Model.DataTypes.IdentityDomain)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "domainName":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("domainName", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DomainName = ((string)(_instance));
                    }
                    break;
case "description":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("description", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Description = ((string)(_instance));
                    }
                    break;
case "oid":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("oid", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Oid = ((string)(_instance));
                    }
                    break;
case "url":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("url", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Url = ((string)(_instance));
                    }
                    break;
case "assigningAuthority":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.AssigningAuthority>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("assigningAuthority", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AssigningAuthority = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.AssigningAuthority>)(_instance));
                    }
                    break;
case "policyModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityPolicy), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policyModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policy = ((SanteDB.Core.Model.Security.SecurityPolicy)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PolicyKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "identifierClass":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifierClass", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IdentifierClassificationKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "validation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("validation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ValidationRegex = ((string)(_instance));
                    }
                    break;
case "isUnique":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isUnique", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsUnique = ((bool)(_instance));
                    }
                    break;
case "customValidator":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("customValidator", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CustomValidator = ((string)(_instance));
                    }
                    break;
case "checkDigitAlgorithm":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("checkDigitAlgorithm", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CheckDigitAlgorithm = ((string)(_instance));
                    }
                    break;
case "scope":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("scope", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AuthorityScopeXml = ((System.Collections.Generic.List<System.Guid>)(_instance));
                    }
                    break;
case "scopeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.Concept>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("scopeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AuthorityScope = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.Concept>)(_instance));
                    }
                    break;
case "identifierClassModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifierClassModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IdentifierClassification = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.EntityNote"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class EntityNoteViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.EntityNote);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.EntityNote _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.EntityNote)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.EntityNote)), e);
            }
            if (context.ShouldSerialize("text")) {
                if ((_strong.Text == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "text", _strong.Text, context);
                }
            }
            if (context.ShouldSerialize("author")) {
                if ((_strong.AuthorKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "author", _strong.AuthorKey, context);
                }
            }
            if (context.ShouldSerialize("authorModel")) {
                if ((_strong.Author == null)) {
                    if ((_strong.AuthorKey.HasValue && context.ShouldForceLoad("authorModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "Author");
                        if ((_delay != null)) {
                            _strong.Author = _delay;
                            context.JsonContext.WritePropertyUtil(w, "authorModel", _strong.Author, context);
                        }
                        else {
                            context.RegisterMissTarget("authorModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "authorModel", _strong.Author, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.EntityNote _retVal = new SanteDB.Core.Model.DataTypes.EntityNote();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.EntityNote))) {
                        return ((SanteDB.Core.Model.DataTypes.EntityNote)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "text":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("text", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Text = ((string)(_instance));
                    }
                    break;
case "author":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("author", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AuthorKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "authorModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("authorModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Author = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ActNote"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ActNoteViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ActNote);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ActNote _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ActNote)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ActNote)), e);
            }
            if (context.ShouldSerialize("text")) {
                if ((_strong.Text == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "text", _strong.Text, context);
                }
            }
            if (context.ShouldSerialize("author")) {
                if ((_strong.AuthorKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "author", _strong.AuthorKey, context);
                }
            }
            if (context.ShouldSerialize("authorModel")) {
                if ((_strong.Author == null)) {
                    if ((_strong.AuthorKey.HasValue && context.ShouldForceLoad("authorModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "Author");
                        if ((_delay != null)) {
                            _strong.Author = _delay;
                            context.JsonContext.WritePropertyUtil(w, "authorModel", _strong.Author, context);
                        }
                        else {
                            context.RegisterMissTarget("authorModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "authorModel", _strong.Author, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ActNote _retVal = new SanteDB.Core.Model.DataTypes.ActNote();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ActNote))) {
                        return ((SanteDB.Core.Model.DataTypes.ActNote)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "text":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("text", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Text = ((string)(_instance));
                    }
                    break;
case "author":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("author", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AuthorKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "authorModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("authorModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Author = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ReferenceTerm"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ReferenceTermViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ReferenceTerm);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ReferenceTerm _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ReferenceTerm)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ReferenceTerm)), e);
            }
            if (context.ShouldSerialize("mnemonic")) {
                if ((_strong.Mnemonic == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "mnemonic", _strong.Mnemonic, context);
                }
            }
            if (context.ShouldSerialize("codeSystemModel")) {
                if ((_strong.CodeSystem == null)) {
                    if ((_strong.CodeSystemKey.HasValue && context.ShouldForceLoad("codeSystemModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.CodeSystem _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.CodeSystem>(_strong, "CodeSystem");
                        if ((_delay != null)) {
                            _strong.CodeSystem = _delay;
                            context.JsonContext.WritePropertyUtil(w, "codeSystemModel", _strong.CodeSystem, context);
                        }
                        else {
                            context.RegisterMissTarget("codeSystemModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "codeSystemModel", _strong.CodeSystem, context);
                }
            }
            if (context.ShouldSerialize("codeSystem")) {
                if ((_strong.CodeSystemKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "codeSystem", _strong.CodeSystemKey, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if (((_strong.DisplayNames == null) 
                            || (_strong.DisplayNames.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("name", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ReferenceTermName> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ReferenceTermName>(_strong, "DisplayNames"));
                        if ((_delay.Count > 0)) {
                            _strong.DisplayNames = _delay;
                            context.JsonContext.WritePropertyUtil(w, "name", _strong.DisplayNames, context);
                        }
                        else {
                            context.RegisterMissTarget("name", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.DisplayNames, context);
                }
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ReferenceTerm _retVal = new SanteDB.Core.Model.DataTypes.ReferenceTerm();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ReferenceTerm))) {
                        return ((SanteDB.Core.Model.DataTypes.ReferenceTerm)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "mnemonic":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("mnemonic", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Mnemonic = ((string)(_instance));
                    }
                    break;
case "codeSystemModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.CodeSystem), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("codeSystemModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CodeSystem = ((SanteDB.Core.Model.DataTypes.CodeSystem)(_instance));
                    }
                    break;
case "codeSystem":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("codeSystem", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CodeSystemKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ReferenceTermName>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DisplayNames = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ReferenceTermName>)(_instance));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ReferenceTermName"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ReferenceTermNameViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ReferenceTermName);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ReferenceTermName _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ReferenceTermName)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ReferenceTermName)), e);
            }
            if (context.ShouldSerialize("language")) {
                if ((_strong.Language == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "language", _strong.Language, context);
                }
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ReferenceTermName _retVal = new SanteDB.Core.Model.DataTypes.ReferenceTermName();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ReferenceTermName))) {
                        return ((SanteDB.Core.Model.DataTypes.ReferenceTermName)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "language":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("language", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Language = ((string)(_instance));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            string _strong = null;
            if ((o == null)) {
                return null;
            }
            try {
                _strong = o.ToString();
            }
            catch (System.Exception e) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.ReferenceTermName _retVal = new SanteDB.Core.Model.DataTypes.ReferenceTermName();
            _retVal.Name = _strong;
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            if ((o == null)) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.ReferenceTermName _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ReferenceTermName)(o));
            }
            catch (System.Exception e) {
                return null;
            }
            return _strong.Name;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.RelationshipValidationRule"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class RelationshipValidationRuleViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.RelationshipValidationRule);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.RelationshipValidationRule _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.RelationshipValidationRule)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.RelationshipValidationRule)), e);
            }
            if (context.ShouldSerialize("sourceClass")) {
                if ((_strong.SourceClassKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceClass", _strong.SourceClassKey, context);
                }
            }
            if (context.ShouldSerialize("sourceClassModel")) {
                if ((_strong.SourceClass == null)) {
                    if ((_strong.SourceClassKey.HasValue && context.ShouldForceLoad("sourceClassModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "SourceClass");
                        if ((_delay != null)) {
                            _strong.SourceClass = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceClassModel", _strong.SourceClass, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceClassModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceClassModel", _strong.SourceClass, context);
                }
            }
            if (context.ShouldSerialize("targetClass")) {
                if ((_strong.TargetClassKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "targetClass", _strong.TargetClassKey, context);
                }
            }
            if (context.ShouldSerialize("targetClassModel")) {
                if ((_strong.TargetClass == null)) {
                    if ((_strong.TargetClassKey.HasValue && context.ShouldForceLoad("targetClassModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TargetClass");
                        if ((_delay != null)) {
                            _strong.TargetClass = _delay;
                            context.JsonContext.WritePropertyUtil(w, "targetClassModel", _strong.TargetClass, context);
                        }
                        else {
                            context.RegisterMissTarget("targetClassModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "targetClassModel", _strong.TargetClass, context);
                }
            }
            if (context.ShouldSerialize("relationshipType")) {
                context.JsonContext.WritePropertyUtil(w, "relationshipType", _strong.RelationshipTypeKey, context);
            }
            if (context.ShouldSerialize("relationshipTypeModel")) {
                if ((_strong.RelationshipType == null)) {
                    if ((_strong.RelationshipTypeKey != Guid.Empty && context.ShouldForceLoad("relationshipTypeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "RelationshipType");
                        if ((_delay != null)) {
                            _strong.RelationshipType = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationshipTypeModel", _strong.RelationshipType, context);
                        }
                        else {
                            context.RegisterMissTarget("relationshipTypeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationshipTypeModel", _strong.RelationshipType, context);
                }
            }
            if (context.ShouldSerialize("appliesTo")) {
                if ((_strong.AppliesToXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "appliesTo", _strong.AppliesToXml, context);
                }
            }
            if (context.ShouldSerialize("description")) {
                if ((_strong.Description == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "description", _strong.Description, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.RelationshipValidationRule _retVal = new SanteDB.Core.Model.DataTypes.RelationshipValidationRule();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.RelationshipValidationRule))) {
                        return ((SanteDB.Core.Model.DataTypes.RelationshipValidationRule)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "sourceClass":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceClass", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceClassKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceClassModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceClassModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceClass = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "targetClass":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("targetClass", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TargetClassKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "targetClassModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("targetClassModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TargetClass = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "relationshipType":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Guid), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationshipType", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.RelationshipTypeKey = ((System.Guid)(_instance));
                    }
                    break;
case "relationshipTypeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationshipTypeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.RelationshipType = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "appliesTo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("appliesTo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AppliesToXml = ((string)(_instance));
                    }
                    break;
case "description":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("description", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Description = ((string)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ConceptTag"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ConceptTagViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ConceptTag);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ConceptTag _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ConceptTag)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ConceptTag)), e);
            }
            if (context.ShouldSerialize("key")) {
                if ((_strong.TagKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "key", _strong.TagKey, context);
                }
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.Value == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.Value, context);
                }
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ConceptTag _retVal = new SanteDB.Core.Model.DataTypes.ConceptTag();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ConceptTag))) {
                        return ((SanteDB.Core.Model.DataTypes.ConceptTag)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "key":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("key", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TagKey = ((string)(_instance));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Value = ((string)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            string _strong = null;
            if ((o == null)) {
                return null;
            }
            try {
                _strong = o.ToString();
            }
            catch (System.Exception e) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.ConceptTag _retVal = new SanteDB.Core.Model.DataTypes.ConceptTag();
            _retVal.Value = _strong;
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            if ((o == null)) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.ConceptTag _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ConceptTag)(o));
            }
            catch (System.Exception e) {
                return null;
            }
            return _strong.Value;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.EntityTag"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class EntityTagViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.EntityTag);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.EntityTag _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.EntityTag)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.EntityTag)), e);
            }
            if (context.ShouldSerialize("key")) {
                if ((_strong.TagKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "key", _strong.TagKey, context);
                }
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.Value == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.Value, context);
                }
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.EntityTag _retVal = new SanteDB.Core.Model.DataTypes.EntityTag();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.EntityTag))) {
                        return ((SanteDB.Core.Model.DataTypes.EntityTag)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "key":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("key", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TagKey = ((string)(_instance));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Value = ((string)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            string _strong = null;
            if ((o == null)) {
                return null;
            }
            try {
                _strong = o.ToString();
            }
            catch (System.Exception e) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.EntityTag _retVal = new SanteDB.Core.Model.DataTypes.EntityTag();
            _retVal.Value = _strong;
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            if ((o == null)) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.EntityTag _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.EntityTag)(o));
            }
            catch (System.Exception e) {
                return null;
            }
            return _strong.Value;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.ActTag"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ActTagViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.ActTag);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.ActTag _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ActTag)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.ActTag)), e);
            }
            if (context.ShouldSerialize("key")) {
                if ((_strong.TagKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "key", _strong.TagKey, context);
                }
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.Value == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.Value, context);
                }
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.ActTag _retVal = new SanteDB.Core.Model.DataTypes.ActTag();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.ActTag))) {
                        return ((SanteDB.Core.Model.DataTypes.ActTag)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "key":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("key", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TagKey = ((string)(_instance));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Value = ((string)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            string _strong = null;
            if ((o == null)) {
                return null;
            }
            try {
                _strong = o.ToString();
            }
            catch (System.Exception e) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.ActTag _retVal = new SanteDB.Core.Model.DataTypes.ActTag();
            _retVal.Value = _strong;
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            if ((o == null)) {
                return null;
            }
            SanteDB.Core.Model.DataTypes.ActTag _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.ActTag)(o));
            }
            catch (System.Exception e) {
                return null;
            }
            return _strong.Value;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.DataTypes.TemplateDefinition"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class TemplateDefinitionViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.DataTypes.TemplateDefinition _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition)), e);
            }
            if (context.ShouldSerialize("mnemonic")) {
                if ((_strong.Mnemonic == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "mnemonic", _strong.Mnemonic, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("oid")) {
                if ((_strong.Oid == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "oid", _strong.Oid, context);
                }
            }
            if (context.ShouldSerialize("description")) {
                if ((_strong.Description == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "description", _strong.Description, context);
                }
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.DataTypes.TemplateDefinition _retVal = new SanteDB.Core.Model.DataTypes.TemplateDefinition();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition))) {
                        return ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "mnemonic":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("mnemonic", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Mnemonic = ((string)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "oid":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("oid", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Oid = ((string)(_instance));
                    }
                    break;
case "description":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("description", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Description = ((string)(_instance));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Collection.Bundle"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class BundleViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Collection.Bundle);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Collection.Bundle _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Collection.Bundle)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Collection.Bundle)), e);
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("correlationSeq")) {
                if ((_strong.CorrelationSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "correlationSeq", _strong.CorrelationSequence, context);
                }
            }
            if (context.ShouldSerialize("correlationId")) {
                if ((_strong.CorrelationKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "correlationId", _strong.CorrelationKey, context);
                }
            }
            if (context.ShouldSerialize("resource")) {
                if (((_strong.Item == null) 
                            || (_strong.Item.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("resource", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.IdentifiedData> _delay = null;
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "resource", _strong.Item, context);
                }
            }
            if (context.ShouldSerialize("focal")) {
                if (((_strong.FocalObjects == null) 
                            || (_strong.FocalObjects.Count == 0))) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "focal", _strong.FocalObjects, context);
                }
            }
            if (context.ShouldSerialize("offset")) {
                context.JsonContext.WritePropertyUtil(w, "offset", _strong.Offset, context);
            }
            if (context.ShouldSerialize("count")) {
                context.JsonContext.WritePropertyUtil(w, "count", _strong.Count, context);
            }
            if (context.ShouldSerialize("totalResults")) {
                if ((_strong.TotalResults == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "totalResults", _strong.TotalResults, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Collection.Bundle _retVal = new SanteDB.Core.Model.Collection.Bundle();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Collection.Bundle))) {
                        return ((SanteDB.Core.Model.Collection.Bundle)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "correlationSeq":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("correlationSeq", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CorrelationSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "correlationId":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("correlationId", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CorrelationKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "resource":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.IdentifiedData>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("resource", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Item = ((System.Collections.Generic.List<SanteDB.Core.Model.IdentifiedData>)(_instance));
                    }
                    break;
case "focal":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("focal", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.FocalObjects = ((System.Collections.Generic.List<System.Guid>)(_instance));
                    }
                    break;
case "offset":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(int), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("offset", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Offset = ((int)(_instance));
                    }
                    break;
case "count":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(int), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("count", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Count = ((int)(_instance));
                    }
                    break;
case "totalResults":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<int>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("totalResults", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TotalResults = ((System.Nullable<int>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Audit.AuditEventData"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class AuditEventDataViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Audit.AuditEventData);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Audit.AuditEventData _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Audit.AuditEventData)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Audit.AuditEventData)), e);
            }
            if (context.ShouldSerialize("action")) {
                context.JsonContext.WritePropertyUtil(w, "action", _strong.ActionCode, context);
            }
            if (context.ShouldSerialize("actor")) {
                if (((_strong.Actors == null) 
                            || (_strong.Actors.Count == 0))) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actor", _strong.Actors, context);
                }
            }
            if (context.ShouldSerialize("object")) {
                if (((_strong.AuditableObjects == null) 
                            || (_strong.AuditableObjects.Count == 0))) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "object", _strong.AuditableObjects, context);
                }
            }
            if (context.ShouldSerialize("event")) {
                context.JsonContext.WritePropertyUtil(w, "event", _strong.EventIdentifier, context);
            }
            if (context.ShouldSerialize("type")) {
                if ((_strong.EventTypeCode == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "type", _strong.EventTypeCode, context);
                }
            }
            if (context.ShouldSerialize("sensitivity")) {
                context.JsonContext.WritePropertyUtil(w, "sensitivity", _strong.Sensitivity, context);
            }
            if (context.ShouldSerialize("outcome")) {
                context.JsonContext.WritePropertyUtil(w, "outcome", _strong.Outcome, context);
            }
            if (context.ShouldSerialize("timestamp")) {
                if ((_strong.TimestampXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "timestamp", _strong.TimestampXml, context);
                }
            }
            if (context.ShouldSerialize("meta")) {
                if (((_strong.Metadata == null) 
                            || (_strong.Metadata.Count == 0))) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "meta", _strong.Metadata, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Audit.AuditEventData _retVal = new SanteDB.Core.Model.Audit.AuditEventData();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Audit.AuditEventData))) {
                        return ((SanteDB.Core.Model.Audit.AuditEventData)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "action":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Audit.ActionType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("action", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActionCode = ((SanteDB.Core.Model.Audit.ActionType)(_instance));
                    }
                    break;
case "actor":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Audit.AuditActorData>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actor", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Actors = ((System.Collections.Generic.List<SanteDB.Core.Model.Audit.AuditActorData>)(_instance));
                    }
                    break;
case "object":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Audit.AuditableObject>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("object", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AuditableObjects = ((System.Collections.Generic.List<SanteDB.Core.Model.Audit.AuditableObject>)(_instance));
                    }
                    break;
case "event":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Audit.EventIdentifierType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("event", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.EventIdentifier = ((SanteDB.Core.Model.Audit.EventIdentifierType)(_instance));
                    }
                    break;
case "type":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Audit.AuditCode), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("type", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.EventTypeCode = ((SanteDB.Core.Model.Audit.AuditCode)(_instance));
                    }
                    break;
case "sensitivity":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Attributes.ResourceSensitivityClassification), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sensitivity", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Sensitivity = ((SanteDB.Core.Model.Attributes.ResourceSensitivityClassification)(_instance));
                    }
                    break;
case "outcome":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Audit.OutcomeIndicator), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("outcome", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Outcome = ((SanteDB.Core.Model.Audit.OutcomeIndicator)(_instance));
                    }
                    break;
case "timestamp":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("timestamp", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TimestampXml = ((string)(_instance));
                    }
                    break;
case "meta":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Audit.AuditMetadata>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("meta", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Metadata = ((System.Collections.Generic.List<SanteDB.Core.Model.Audit.AuditMetadata>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.Account"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class AccountViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.Account);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.Account _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.Account)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.Account)), e);
            }
            if (context.ShouldSerialize("balance")) {
                context.JsonContext.WritePropertyUtil(w, "balance", _strong.Balance, context);
            }
            if (context.ShouldSerialize("currency")) {
                if ((_strong.CurrencyKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "currency", _strong.CurrencyKey, context);
                }
            }
            if (context.ShouldSerialize("currencyModel")) {
                if ((_strong.Currency == null)) {
                    if ((_strong.CurrencyKey.HasValue && context.ShouldForceLoad("currencyModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Currency");
                        if ((_delay != null)) {
                            _strong.Currency = _delay;
                            context.JsonContext.WritePropertyUtil(w, "currencyModel", _strong.Currency, context);
                        }
                        else {
                            context.RegisterMissTarget("currencyModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "currencyModel", _strong.Currency, context);
                }
            }
            if (context.ShouldSerialize("minBalance")) {
                if ((_strong.MinBalance == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "minBalance", _strong.MinBalance, context);
                }
            }
            if (context.ShouldSerialize("maxBalance")) {
                context.JsonContext.WritePropertyUtil(w, "maxBalance", _strong.MaxBalance, context);
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.Account _retVal = new SanteDB.Core.Model.Acts.Account();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.Account))) {
                        return ((SanteDB.Core.Model.Acts.Account)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "balance":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(decimal), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("balance", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Balance = ((decimal)(_instance));
                    }
                    break;
case "currency":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("currency", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CurrencyKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "currencyModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("currencyModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Currency = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "minBalance":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<decimal>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("minBalance", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MinBalance = ((System.Nullable<decimal>)(_instance));
                    }
                    break;
case "maxBalance":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(decimal), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("maxBalance", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MaxBalance = ((decimal)(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.Act"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ActViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.Act);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.Act _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.Act)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.Act)), e);
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.Act _retVal = new SanteDB.Core.Model.Acts.Act();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.Act))) {
                        return ((SanteDB.Core.Model.Acts.Act)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.ActParticipation"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ActParticipationViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.ActParticipation);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.ActParticipation _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.ActParticipation)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.ActParticipation)), e);
            }
            if (context.ShouldSerialize("classificationModel")) {
                if ((_strong.Classification == null)) {
                    if ((_strong.ClassificationKey.HasValue && context.ShouldForceLoad("classificationModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Classification");
                        if ((_delay != null)) {
                            _strong.Classification = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classificationModel", _strong.Classification, context);
                        }
                        else {
                            context.RegisterMissTarget("classificationModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classificationModel", _strong.Classification, context);
                }
            }
            if (context.ShouldSerialize("externId")) {
                if ((_strong.ExternalKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "externId", _strong.ExternalKey, context);
                }
            }
            if (context.ShouldSerialize("classification")) {
                if ((_strong.ClassificationKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classification", _strong.ClassificationKey, context);
                }
            }
            if (context.ShouldSerialize("player")) {
                if ((_strong.PlayerEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "player", _strong.PlayerEntityKey, context);
                }
            }
            if (context.ShouldSerialize("participationRole")) {
                if ((_strong.ParticipationRoleKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participationRole", _strong.ParticipationRoleKey, context);
                }
            }
            if (context.ShouldSerialize("playerModel")) {
                if ((_strong.PlayerEntity == null)) {
                    if ((_strong.PlayerEntityKey.HasValue && context.ShouldForceLoad("playerModel", _strong.Key))) {
                        SanteDB.Core.Model.Entities.Entity _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Entities.Entity>(_strong, "PlayerEntity");
                        if ((_delay != null)) {
                            _strong.PlayerEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "playerModel", _strong.PlayerEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("playerModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "playerModel", _strong.PlayerEntity, context);
                }
            }
            if (context.ShouldSerialize("participationRoleModel")) {
                if ((_strong.ParticipationRole == null)) {
                    if ((_strong.ParticipationRoleKey.HasValue && context.ShouldForceLoad("participationRoleModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ParticipationRole");
                        if ((_delay != null)) {
                            _strong.ParticipationRole = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participationRoleModel", _strong.ParticipationRole, context);
                        }
                        else {
                            context.RegisterMissTarget("participationRoleModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participationRoleModel", _strong.ParticipationRole, context);
                }
            }
            if (context.ShouldSerialize("act")) {
                if ((_strong.ActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "act", _strong.ActKey, context);
                }
            }
            if (context.ShouldSerialize("actModel")) {
                if ((_strong.Act == null)) {
                    if ((_strong.ActKey.HasValue && context.ShouldForceLoad("actModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "Act");
                        if ((_delay != null)) {
                            _strong.Act = _delay;
                            context.JsonContext.WritePropertyUtil(w, "actModel", _strong.Act, context);
                        }
                        else {
                            context.RegisterMissTarget("actModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actModel", _strong.Act, context);
                }
            }
            if (context.ShouldSerialize("quantity")) {
                if ((_strong.Quantity == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "quantity", _strong.Quantity, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.ActParticipation _retVal = new SanteDB.Core.Model.Acts.ActParticipation();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.ActParticipation))) {
                        return ((SanteDB.Core.Model.Acts.ActParticipation)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "classificationModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classificationModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Classification = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "externId":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("externId", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalKey = ((string)(_instance));
                    }
                    break;
case "classification":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classification", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassificationKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "player":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("player", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PlayerEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "participationRole":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participationRole", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ParticipationRoleKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "playerModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Entities.Entity), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("playerModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PlayerEntity = ((SanteDB.Core.Model.Entities.Entity)(_instance));
                    }
                    break;
case "participationRoleModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participationRoleModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ParticipationRole = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "act":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("act", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "actModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Act = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "quantity":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<int>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("quantity", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Quantity = ((System.Nullable<int>)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.ActProtocol"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ActProtocolViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.ActProtocol);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.ActProtocol _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.ActProtocol)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.ActProtocol)), e);
            }
            if (context.ShouldSerialize("protocol")) {
                if ((_strong.ProtocolKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.ProtocolKey, context);
                }
            }
            if (context.ShouldSerialize("protocolModel")) {
                if ((_strong.Protocol == null)) {
                    if ((_strong.ProtocolKey.HasValue && context.ShouldForceLoad("protocolModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Protocol _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Protocol>(_strong, "Protocol");
                        if ((_delay != null)) {
                            _strong.Protocol = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocolModel", _strong.Protocol, context);
                        }
                        else {
                            context.RegisterMissTarget("protocolModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocolModel", _strong.Protocol, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.Version == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.Version, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                context.JsonContext.WritePropertyUtil(w, "sequence", _strong.Sequence, context);
            }
            if (context.ShouldSerialize("state")) {
                if ((_strong.StateData == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "state", _strong.StateData, context);
                }
            }
            if (context.ShouldSerialize("notBefore")) {
                if ((_strong.NotBeforeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "notBefore", _strong.NotBeforeXml, context);
                }
            }
            if (context.ShouldSerialize("notAfter")) {
                if ((_strong.NotAfterXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "notAfter", _strong.NotAfterXml, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.ActProtocol _retVal = new SanteDB.Core.Model.Acts.ActProtocol();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.ActProtocol))) {
                        return ((SanteDB.Core.Model.Acts.ActProtocol)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ProtocolKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "protocolModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Protocol), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocolModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocol = ((SanteDB.Core.Model.Acts.Protocol)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Version = ((string)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(int), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Sequence = ((int)(_instance));
                    }
                    break;
case "state":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(byte[]), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("state", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StateData = ((byte[])(_instance));
                    }
                    break;
case "notBefore":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("notBefore", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.NotBeforeXml = ((string)(_instance));
                    }
                    break;
case "notAfter":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("notAfter", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.NotAfterXml = ((string)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.ActRelationship"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ActRelationshipViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.ActRelationship);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.ActRelationship _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.ActRelationship)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.ActRelationship)), e);
            }
            if (context.ShouldSerialize("classificationModel")) {
                if ((_strong.Classification == null)) {
                    if ((_strong.ClassificationKey.HasValue && context.ShouldForceLoad("classificationModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Classification");
                        if ((_delay != null)) {
                            _strong.Classification = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classificationModel", _strong.Classification, context);
                        }
                        else {
                            context.RegisterMissTarget("classificationModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classificationModel", _strong.Classification, context);
                }
            }
            if (context.ShouldSerialize("negationInd")) {
                if ((_strong.NegationIndicator == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "negationInd", _strong.NegationIndicator, context);
                }
            }
            if (context.ShouldSerialize("externId")) {
                if ((_strong.ExternalKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "externId", _strong.ExternalKey, context);
                }
            }
            if (context.ShouldSerialize("classification")) {
                if ((_strong.ClassificationKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classification", _strong.ClassificationKey, context);
                }
            }
            if (context.ShouldSerialize("target")) {
                if ((_strong.TargetActKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "target", _strong.TargetActKey, context);
                }
            }
            if (context.ShouldSerialize("targetModel")) {
                if ((_strong.TargetAct == null)) {
                    if ((_strong.TargetActKey.HasValue && context.ShouldForceLoad("targetModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "TargetAct");
                        if ((_delay != null)) {
                            _strong.TargetAct = _delay;
                            context.JsonContext.WritePropertyUtil(w, "targetModel", _strong.TargetAct, context);
                        }
                        else {
                            context.RegisterMissTarget("targetModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "targetModel", _strong.TargetAct, context);
                }
            }
            if (context.ShouldSerialize("relationshipType")) {
                if ((_strong.RelationshipTypeKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationshipType", _strong.RelationshipTypeKey, context);
                }
            }
            if (context.ShouldSerialize("relationshipTypeModel")) {
                if ((_strong.RelationshipType == null)) {
                    if ((_strong.RelationshipTypeKey.HasValue && context.ShouldForceLoad("relationshipTypeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "RelationshipType");
                        if ((_delay != null)) {
                            _strong.RelationshipType = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationshipTypeModel", _strong.RelationshipType, context);
                        }
                        else {
                            context.RegisterMissTarget("relationshipTypeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationshipTypeModel", _strong.RelationshipType, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.ActRelationship _retVal = new SanteDB.Core.Model.Acts.ActRelationship();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.ActRelationship))) {
                        return ((SanteDB.Core.Model.Acts.ActRelationship)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "classificationModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classificationModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Classification = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "negationInd":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<bool>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("negationInd", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.NegationIndicator = ((System.Nullable<bool>)(_instance));
                    }
                    break;
case "externId":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("externId", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ExternalKey = ((string)(_instance));
                    }
                    break;
case "classification":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classification", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassificationKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "target":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("target", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TargetActKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "targetModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("targetModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TargetAct = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "relationshipType":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationshipType", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.RelationshipTypeKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "relationshipTypeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationshipTypeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.RelationshipType = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.CarePathwayDefinition"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class CarePathwayDefinitionViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.CarePathwayDefinition);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.CarePathwayDefinition _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.CarePathwayDefinition)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.CarePathwayDefinition)), e);
            }
            if (context.ShouldSerialize("mnemonic")) {
                if ((_strong.Mnemonic == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "mnemonic", _strong.Mnemonic, context);
                }
            }
            if (context.ShouldSerialize("name")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("description")) {
                if ((_strong.Description == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "description", _strong.Description, context);
                }
            }
            if (context.ShouldSerialize("eligibility")) {
                if ((_strong.EligibilityCriteria == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "eligibility", _strong.EligibilityCriteria, context);
                }
            }
            if (context.ShouldSerialize("enrollment")) {
                context.JsonContext.WritePropertyUtil(w, "enrollment", _strong.EnrollmentMode, context);
            }
            if (context.ShouldSerialize("encounterTemplate")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "encounterTemplate", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("encounterTemplateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("encounterTemplateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "encounterTemplateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("encounterTemplateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "encounterTemplateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("updatedTime")) {
                if ((_strong.UpdatedTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedTime", _strong.UpdatedTimeXml, context);
                }
            }
            if (context.ShouldSerialize("updatedByModel")) {
                if ((_strong.UpdatedBy == null)) {
                    if ((_strong.UpdatedByKey.HasValue && context.ShouldForceLoad("updatedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "UpdatedBy");
                        if ((_delay != null)) {
                            _strong.UpdatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("updatedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedByModel", _strong.UpdatedBy, context);
                }
            }
            if (context.ShouldSerialize("updatedBy")) {
                if ((_strong.UpdatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "updatedBy", _strong.UpdatedByKey, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.CarePathwayDefinition _retVal = new SanteDB.Core.Model.Acts.CarePathwayDefinition();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.CarePathwayDefinition))) {
                        return ((SanteDB.Core.Model.Acts.CarePathwayDefinition)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "mnemonic":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("mnemonic", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Mnemonic = ((string)(_instance));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "description":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("description", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Description = ((string)(_instance));
                    }
                    break;
case "eligibility":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("eligibility", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.EligibilityCriteria = ((string)(_instance));
                    }
                    break;
case "enrollment":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.CarePathwayEnrollmentMode), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("enrollment", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.EnrollmentMode = ((SanteDB.Core.Model.Acts.CarePathwayEnrollmentMode)(_instance));
                    }
                    break;
case "encounterTemplate":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("encounterTemplate", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "encounterTemplateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("encounterTemplateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "updatedTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedTimeXml = ((string)(_instance));
                    }
                    break;
case "updatedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "updatedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("updatedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UpdatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.CarePlan"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class CarePlanViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.CarePlan);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.CarePlan _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.CarePlan)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.CarePlan)), e);
            }
            if (context.ShouldSerialize("title")) {
                if ((_strong.Title == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "title", _strong.Title, context);
                }
            }
            if (context.ShouldSerialize("pathway")) {
                if ((_strong.CarePathwayKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "pathway", _strong.CarePathwayKey, context);
                }
            }
            if (context.ShouldSerialize("pathwayModel")) {
                if ((_strong.CarePathway == null)) {
                    if ((_strong.CarePathwayKey.HasValue && context.ShouldForceLoad("pathwayModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.CarePathwayDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.CarePathwayDefinition>(_strong, "CarePathway");
                        if ((_delay != null)) {
                            _strong.CarePathway = _delay;
                            context.JsonContext.WritePropertyUtil(w, "pathwayModel", _strong.CarePathway, context);
                        }
                        else {
                            context.RegisterMissTarget("pathwayModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "pathwayModel", _strong.CarePathway, context);
                }
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.CarePlan _retVal = new SanteDB.Core.Model.Acts.CarePlan();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.CarePlan))) {
                        return ((SanteDB.Core.Model.Acts.CarePlan)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "title":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("title", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Title = ((string)(_instance));
                    }
                    break;
case "pathway":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("pathway", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CarePathwayKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "pathwayModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.CarePathwayDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("pathwayModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CarePathway = ((SanteDB.Core.Model.Acts.CarePathwayDefinition)(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.ControlAct"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ControlActViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.ControlAct);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.ControlAct _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.ControlAct)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.ControlAct)), e);
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.ControlAct _retVal = new SanteDB.Core.Model.Acts.ControlAct();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.ControlAct))) {
                        return ((SanteDB.Core.Model.Acts.ControlAct)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.FinancialContract"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class FinancialContractViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.FinancialContract);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.FinancialContract _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.FinancialContract)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.FinancialContract)), e);
            }
            if (context.ShouldSerialize("paymentTerms")) {
                if ((_strong.PaymentTermsKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "paymentTerms", _strong.PaymentTermsKey, context);
                }
            }
            if (context.ShouldSerialize("paymentTermsModel")) {
                if ((_strong.PaymentTerms == null)) {
                    if ((_strong.PaymentTermsKey.HasValue && context.ShouldForceLoad("paymentTermsModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "PaymentTerms");
                        if ((_delay != null)) {
                            _strong.PaymentTerms = _delay;
                            context.JsonContext.WritePropertyUtil(w, "paymentTermsModel", _strong.PaymentTerms, context);
                        }
                        else {
                            context.RegisterMissTarget("paymentTermsModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "paymentTermsModel", _strong.PaymentTerms, context);
                }
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.FinancialContract _retVal = new SanteDB.Core.Model.Acts.FinancialContract();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.FinancialContract))) {
                        return ((SanteDB.Core.Model.Acts.FinancialContract)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "paymentTerms":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("paymentTerms", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PaymentTermsKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "paymentTermsModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("paymentTermsModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PaymentTerms = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.FinancialTransaction"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class FinancialTransactionViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.FinancialTransaction);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.FinancialTransaction _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.FinancialTransaction)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.FinancialTransaction)), e);
            }
            if (context.ShouldSerialize("amount")) {
                if ((_strong.Amount == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "amount", _strong.Amount, context);
                }
            }
            if (context.ShouldSerialize("currency")) {
                if ((_strong.CurrencyKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "currency", _strong.CurrencyKey, context);
                }
            }
            if (context.ShouldSerialize("currencyModel")) {
                if ((_strong.Currency == null)) {
                    if ((_strong.CurrencyKey.HasValue && context.ShouldForceLoad("currencyModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Currency");
                        if ((_delay != null)) {
                            _strong.Currency = _delay;
                            context.JsonContext.WritePropertyUtil(w, "currencyModel", _strong.Currency, context);
                        }
                        else {
                            context.RegisterMissTarget("currencyModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "currencyModel", _strong.Currency, context);
                }
            }
            if (context.ShouldSerialize("creditExchange")) {
                context.JsonContext.WritePropertyUtil(w, "creditExchange", _strong.CreditExchangeRate, context);
            }
            if (context.ShouldSerialize("debitExchange")) {
                context.JsonContext.WritePropertyUtil(w, "debitExchange", _strong.DebitExchangeRate, context);
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.FinancialTransaction _retVal = new SanteDB.Core.Model.Acts.FinancialTransaction();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.FinancialTransaction))) {
                        return ((SanteDB.Core.Model.Acts.FinancialTransaction)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "amount":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<decimal>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("amount", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Amount = ((System.Nullable<decimal>)(_instance));
                    }
                    break;
case "currency":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("currency", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CurrencyKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "currencyModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("currencyModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Currency = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "creditExchange":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(float), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creditExchange", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreditExchangeRate = ((float)(_instance));
                    }
                    break;
case "debitExchange":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(float), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("debitExchange", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DebitExchangeRate = ((float)(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.InvoiceElement"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class InvoiceElementViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.InvoiceElement);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.InvoiceElement _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.InvoiceElement)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.InvoiceElement)), e);
            }
            if (context.ShouldSerialize("modifier")) {
                if ((_strong.ModifierKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "modifier", _strong.ModifierKey, context);
                }
            }
            if (context.ShouldSerialize("modifierModel")) {
                if ((_strong.Modifier == null)) {
                    if ((_strong.ModifierKey.HasValue && context.ShouldForceLoad("modifierModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Modifier");
                        if ((_delay != null)) {
                            _strong.Modifier = _delay;
                            context.JsonContext.WritePropertyUtil(w, "modifierModel", _strong.Modifier, context);
                        }
                        else {
                            context.RegisterMissTarget("modifierModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "modifierModel", _strong.Modifier, context);
                }
            }
            if (context.ShouldSerialize("unitQty")) {
                if ((_strong.UnitQuantity == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "unitQty", _strong.UnitQuantity, context);
                }
            }
            if (context.ShouldSerialize("unitPrice")) {
                if ((_strong.UnitPrice == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "unitPrice", _strong.UnitPrice, context);
                }
            }
            if (context.ShouldSerialize("netPrice")) {
                if ((_strong.NetPrice == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "netPrice", _strong.NetPrice, context);
                }
            }
            if (context.ShouldSerialize("currency")) {
                if ((_strong.CurrencyKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "currency", _strong.CurrencyKey, context);
                }
            }
            if (context.ShouldSerialize("currencyModel")) {
                if ((_strong.Currency == null)) {
                    if ((_strong.CurrencyKey.HasValue && context.ShouldForceLoad("currencyModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Currency");
                        if ((_delay != null)) {
                            _strong.Currency = _delay;
                            context.JsonContext.WritePropertyUtil(w, "currencyModel", _strong.Currency, context);
                        }
                        else {
                            context.RegisterMissTarget("currencyModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "currencyModel", _strong.Currency, context);
                }
            }
            if (context.ShouldSerialize("factor")) {
                if ((_strong.Factor == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "factor", _strong.Factor, context);
                }
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.InvoiceElement _retVal = new SanteDB.Core.Model.Acts.InvoiceElement();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.InvoiceElement))) {
                        return ((SanteDB.Core.Model.Acts.InvoiceElement)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "modifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("modifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ModifierKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "modifierModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("modifierModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Modifier = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "unitQty":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<decimal>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("unitQty", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UnitQuantity = ((System.Nullable<decimal>)(_instance));
                    }
                    break;
case "unitPrice":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<decimal>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("unitPrice", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UnitPrice = ((System.Nullable<decimal>)(_instance));
                    }
                    break;
case "netPrice":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<decimal>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("netPrice", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.NetPrice = ((System.Nullable<decimal>)(_instance));
                    }
                    break;
case "currency":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("currency", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CurrencyKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "currencyModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("currencyModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Currency = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "factor":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<float>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("factor", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Factor = ((System.Nullable<float>)(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.Narrative"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class NarrativeViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.Narrative);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.Narrative _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.Narrative)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.Narrative)), e);
            }
            if (context.ShouldSerialize("versionCode")) {
                if ((_strong.VersionNumber == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "versionCode", _strong.VersionNumber, context);
                }
            }
            if (context.ShouldSerialize("language")) {
                if ((_strong.LanguageCode == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "language", _strong.LanguageCode, context);
                }
            }
            if (context.ShouldSerialize("mime")) {
                if ((_strong.MimeType == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "mime", _strong.MimeType, context);
                }
            }
            if (context.ShouldSerialize("title")) {
                if ((_strong.Title == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "title", _strong.Title, context);
                }
            }
            if (context.ShouldSerialize("text")) {
                if ((_strong.Text == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "text", _strong.Text, context);
                }
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.Narrative _retVal = new SanteDB.Core.Model.Acts.Narrative();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.Narrative))) {
                        return ((SanteDB.Core.Model.Acts.Narrative)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "versionCode":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("versionCode", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionNumber = ((string)(_instance));
                    }
                    break;
case "language":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("language", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.LanguageCode = ((string)(_instance));
                    }
                    break;
case "mime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("mime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MimeType = ((string)(_instance));
                    }
                    break;
case "title":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("title", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Title = ((string)(_instance));
                    }
                    break;
case "text":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(byte[]), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("text", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Text = ((byte[])(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.Observation"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ObservationViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.Observation);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.Observation _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.Observation)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.Observation)), e);
            }
            if (context.ShouldSerialize("interpretationConcept")) {
                if ((_strong.InterpretationConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "interpretationConcept", _strong.InterpretationConceptKey, context);
                }
            }
            if (context.ShouldSerialize("valueType")) {
                if ((_strong.ValueType == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "valueType", _strong.ValueType, context);
                }
            }
            if (context.ShouldSerialize("interpretationConceptModel")) {
                if ((_strong.InterpretationConcept == null)) {
                    if ((_strong.InterpretationConceptKey.HasValue && context.ShouldForceLoad("interpretationConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "InterpretationConcept");
                        if ((_delay != null)) {
                            _strong.InterpretationConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "interpretationConceptModel", _strong.InterpretationConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("interpretationConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "interpretationConceptModel", _strong.InterpretationConcept, context);
                }
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.Observation _retVal = new SanteDB.Core.Model.Acts.Observation();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.Observation))) {
                        return ((SanteDB.Core.Model.Acts.Observation)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "interpretationConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("interpretationConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.InterpretationConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "valueType":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("valueType", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ValueType = ((string)(_instance));
                    }
                    break;
case "interpretationConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("interpretationConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.InterpretationConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.QuantityObservation"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class QuantityObservationViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.QuantityObservation);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.QuantityObservation _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.QuantityObservation)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.QuantityObservation)), e);
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.Value == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.Value, context);
                }
            }
            if (context.ShouldSerialize("valueType")) {
                if ((_strong.ValueType == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "valueType", _strong.ValueType, context);
                }
            }
            if (context.ShouldSerialize("unitOfMeasure")) {
                if ((_strong.UnitOfMeasureKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "unitOfMeasure", _strong.UnitOfMeasureKey, context);
                }
            }
            if (context.ShouldSerialize("unitOfMeasureModel")) {
                if ((_strong.UnitOfMeasure == null)) {
                    if ((_strong.UnitOfMeasureKey.HasValue && context.ShouldForceLoad("unitOfMeasureModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "UnitOfMeasure");
                        if ((_delay != null)) {
                            _strong.UnitOfMeasure = _delay;
                            context.JsonContext.WritePropertyUtil(w, "unitOfMeasureModel", _strong.UnitOfMeasure, context);
                        }
                        else {
                            context.RegisterMissTarget("unitOfMeasureModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "unitOfMeasureModel", _strong.UnitOfMeasure, context);
                }
            }
            if (context.ShouldSerialize("interpretationConcept")) {
                if ((_strong.InterpretationConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "interpretationConcept", _strong.InterpretationConceptKey, context);
                }
            }
            if (context.ShouldSerialize("interpretationConceptModel")) {
                if ((_strong.InterpretationConcept == null)) {
                    if ((_strong.InterpretationConceptKey.HasValue && context.ShouldForceLoad("interpretationConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "InterpretationConcept");
                        if ((_delay != null)) {
                            _strong.InterpretationConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "interpretationConceptModel", _strong.InterpretationConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("interpretationConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "interpretationConceptModel", _strong.InterpretationConcept, context);
                }
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.QuantityObservation _retVal = new SanteDB.Core.Model.Acts.QuantityObservation();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.QuantityObservation))) {
                        return ((SanteDB.Core.Model.Acts.QuantityObservation)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<decimal>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Value = ((System.Nullable<decimal>)(_instance));
                    }
                    break;
case "valueType":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("valueType", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ValueType = ((string)(_instance));
                    }
                    break;
case "unitOfMeasure":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("unitOfMeasure", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UnitOfMeasureKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "unitOfMeasureModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("unitOfMeasureModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.UnitOfMeasure = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "interpretationConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("interpretationConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.InterpretationConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "interpretationConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("interpretationConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.InterpretationConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.TextObservation"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class TextObservationViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.TextObservation);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.TextObservation _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.TextObservation)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.TextObservation)), e);
            }
            if (context.ShouldSerialize("valueType")) {
                if ((_strong.ValueType == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "valueType", _strong.ValueType, context);
                }
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.Value == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.Value, context);
                }
            }
            if (context.ShouldSerialize("interpretationConcept")) {
                if ((_strong.InterpretationConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "interpretationConcept", _strong.InterpretationConceptKey, context);
                }
            }
            if (context.ShouldSerialize("interpretationConceptModel")) {
                if ((_strong.InterpretationConcept == null)) {
                    if ((_strong.InterpretationConceptKey.HasValue && context.ShouldForceLoad("interpretationConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "InterpretationConcept");
                        if ((_delay != null)) {
                            _strong.InterpretationConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "interpretationConceptModel", _strong.InterpretationConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("interpretationConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "interpretationConceptModel", _strong.InterpretationConcept, context);
                }
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.TextObservation _retVal = new SanteDB.Core.Model.Acts.TextObservation();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.TextObservation))) {
                        return ((SanteDB.Core.Model.Acts.TextObservation)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "valueType":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("valueType", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ValueType = ((string)(_instance));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Value = ((string)(_instance));
                    }
                    break;
case "interpretationConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("interpretationConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.InterpretationConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "interpretationConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("interpretationConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.InterpretationConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.CodedObservation"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class CodedObservationViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.CodedObservation);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.CodedObservation _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.CodedObservation)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.CodedObservation)), e);
            }
            if (context.ShouldSerialize("valueType")) {
                if ((_strong.ValueType == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "valueType", _strong.ValueType, context);
                }
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.ValueKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.ValueKey, context);
                }
            }
            if (context.ShouldSerialize("valueModel")) {
                if ((_strong.Value == null)) {
                    if ((_strong.ValueKey.HasValue && context.ShouldForceLoad("valueModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Value");
                        if ((_delay != null)) {
                            _strong.Value = _delay;
                            context.JsonContext.WritePropertyUtil(w, "valueModel", _strong.Value, context);
                        }
                        else {
                            context.RegisterMissTarget("valueModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "valueModel", _strong.Value, context);
                }
            }
            if (context.ShouldSerialize("interpretationConcept")) {
                if ((_strong.InterpretationConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "interpretationConcept", _strong.InterpretationConceptKey, context);
                }
            }
            if (context.ShouldSerialize("interpretationConceptModel")) {
                if ((_strong.InterpretationConcept == null)) {
                    if ((_strong.InterpretationConceptKey.HasValue && context.ShouldForceLoad("interpretationConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "InterpretationConcept");
                        if ((_delay != null)) {
                            _strong.InterpretationConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "interpretationConceptModel", _strong.InterpretationConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("interpretationConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "interpretationConceptModel", _strong.InterpretationConcept, context);
                }
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.CodedObservation _retVal = new SanteDB.Core.Model.Acts.CodedObservation();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.CodedObservation))) {
                        return ((SanteDB.Core.Model.Acts.CodedObservation)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "valueType":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("valueType", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ValueType = ((string)(_instance));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ValueKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "valueModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("valueModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Value = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "interpretationConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("interpretationConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.InterpretationConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "interpretationConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("interpretationConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.InterpretationConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.DateObservation"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class DateObservationViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.DateObservation);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.DateObservation _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.DateObservation)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.DateObservation)), e);
            }
            if (context.ShouldSerialize("valueType")) {
                if ((_strong.ValueType == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "valueType", _strong.ValueType, context);
                }
            }
            if (context.ShouldSerialize("value")) {
                if ((_strong.ValueXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "value", _strong.ValueXml, context);
                }
            }
            if (context.ShouldSerialize("valuePrecision")) {
                if ((_strong.ValuePrecision == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "valuePrecision", _strong.ValuePrecision, context);
                }
            }
            if (context.ShouldSerialize("interpretationConcept")) {
                if ((_strong.InterpretationConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "interpretationConcept", _strong.InterpretationConceptKey, context);
                }
            }
            if (context.ShouldSerialize("interpretationConceptModel")) {
                if ((_strong.InterpretationConcept == null)) {
                    if ((_strong.InterpretationConceptKey.HasValue && context.ShouldForceLoad("interpretationConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "InterpretationConcept");
                        if ((_delay != null)) {
                            _strong.InterpretationConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "interpretationConceptModel", _strong.InterpretationConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("interpretationConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "interpretationConceptModel", _strong.InterpretationConcept, context);
                }
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.DateObservation _retVal = new SanteDB.Core.Model.Acts.DateObservation();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.DateObservation))) {
                        return ((SanteDB.Core.Model.Acts.DateObservation)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "valueType":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("valueType", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ValueType = ((string)(_instance));
                    }
                    break;
case "value":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("value", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ValueXml = ((string)(_instance));
                    }
                    break;
case "valuePrecision":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("valuePrecision", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ValuePrecision = ((System.Nullable<SanteDB.Core.Model.DataTypes.DatePrecision>)(_instance));
                    }
                    break;
case "interpretationConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("interpretationConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.InterpretationConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "interpretationConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("interpretationConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.InterpretationConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.PatientEncounter"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class PatientEncounterViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.PatientEncounter);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.PatientEncounter _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.PatientEncounter)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.PatientEncounter)), e);
            }
            if (context.ShouldSerialize("dischargeDisposition")) {
                if ((_strong.DischargeDispositionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "dischargeDisposition", _strong.DischargeDispositionKey, context);
                }
            }
            if (context.ShouldSerialize("admissionSource")) {
                if ((_strong.AdmissionSourceTypeKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "admissionSource", _strong.AdmissionSourceTypeKey, context);
                }
            }
            if (context.ShouldSerialize("dischargeDispositionModel")) {
                if ((_strong.DischargeDisposition == null)) {
                    if ((_strong.DischargeDispositionKey.HasValue && context.ShouldForceLoad("dischargeDispositionModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DischargeDisposition");
                        if ((_delay != null)) {
                            _strong.DischargeDisposition = _delay;
                            context.JsonContext.WritePropertyUtil(w, "dischargeDispositionModel", _strong.DischargeDisposition, context);
                        }
                        else {
                            context.RegisterMissTarget("dischargeDispositionModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "dischargeDispositionModel", _strong.DischargeDisposition, context);
                }
            }
            if (context.ShouldSerialize("admissionSourceModel")) {
                if ((_strong.AdmissionSourceType == null)) {
                    if ((_strong.AdmissionSourceTypeKey.HasValue && context.ShouldForceLoad("admissionSourceModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "AdmissionSourceType");
                        if ((_delay != null)) {
                            _strong.AdmissionSourceType = _delay;
                            context.JsonContext.WritePropertyUtil(w, "admissionSourceModel", _strong.AdmissionSourceType, context);
                        }
                        else {
                            context.RegisterMissTarget("admissionSourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "admissionSourceModel", _strong.AdmissionSourceType, context);
                }
            }
            if (context.ShouldSerialize("specialArrangement")) {
                if (((_strong.SpecialArrangements == null) 
                            || (_strong.SpecialArrangements.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("specialArrangement", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.PatientEncounterArrangement> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.PatientEncounterArrangement>(_strong, "SpecialArrangements"));
                        if ((_delay.Count > 0)) {
                            _strong.SpecialArrangements = _delay;
                            context.JsonContext.WritePropertyUtil(w, "specialArrangement", _strong.SpecialArrangements, context);
                        }
                        else {
                            context.RegisterMissTarget("specialArrangement", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "specialArrangement", _strong.SpecialArrangements, context);
                }
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.PatientEncounter _retVal = new SanteDB.Core.Model.Acts.PatientEncounter();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.PatientEncounter))) {
                        return ((SanteDB.Core.Model.Acts.PatientEncounter)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "dischargeDisposition":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("dischargeDisposition", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DischargeDispositionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "admissionSource":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("admissionSource", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AdmissionSourceTypeKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "dischargeDispositionModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("dischargeDispositionModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DischargeDisposition = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "admissionSourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("admissionSourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.AdmissionSourceType = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "specialArrangement":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.PatientEncounterArrangement>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("specialArrangement", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SpecialArrangements = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.PatientEncounterArrangement>)(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.PatientEncounterArrangement"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class PatientEncounterArrangementViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.PatientEncounterArrangement);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.PatientEncounterArrangement _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.PatientEncounterArrangement)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.PatientEncounterArrangement)), e);
            }
            if (context.ShouldSerialize("type")) {
                if ((_strong.ArrangementTypeKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "type", _strong.ArrangementTypeKey, context);
                }
            }
            if (context.ShouldSerialize("typeModel")) {
                if ((_strong.ArrangementType == null)) {
                    if ((_strong.ArrangementTypeKey.HasValue && context.ShouldForceLoad("typeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ArrangementType");
                        if ((_delay != null)) {
                            _strong.ArrangementType = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeModel", _strong.ArrangementType, context);
                        }
                        else {
                            context.RegisterMissTarget("typeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeModel", _strong.ArrangementType, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("modifiedOn")) {
                context.JsonContext.WritePropertyUtil(w, "modifiedOn", _strong.ModifiedOn, context);
            }
            if (context.ShouldSerialize("source")) {
                if ((_strong.SourceEntityKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "source", _strong.SourceEntityKey, context);
                }
            }
            if (context.ShouldSerialize("sourceModel")) {
                if ((_strong.SourceEntity == null)) {
                    if ((_strong.SourceEntityKey.HasValue && context.ShouldForceLoad("sourceModel", _strong.Key))) {
                        SanteDB.Core.Model.Acts.Act _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Acts.Act>(_strong, "SourceEntity");
                        if ((_delay != null)) {
                            _strong.SourceEntity = _delay;
                            context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                        }
                        else {
                            context.RegisterMissTarget("sourceModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sourceModel", _strong.SourceEntity, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.PatientEncounterArrangement _retVal = new SanteDB.Core.Model.Acts.PatientEncounterArrangement();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.PatientEncounterArrangement))) {
                        return ((SanteDB.Core.Model.Acts.PatientEncounterArrangement)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "type":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("type", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ArrangementTypeKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ArrangementType = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "source":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("source", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntityKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sourceModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Acts.Act), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sourceModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SourceEntity = ((SanteDB.Core.Model.Acts.Act)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.Procedure"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ProcedureViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.Procedure);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.Procedure _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.Procedure)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.Procedure)), e);
            }
            if (context.ShouldSerialize("method")) {
                if ((_strong.MethodKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "method", _strong.MethodKey, context);
                }
            }
            if (context.ShouldSerialize("approachSite")) {
                if ((_strong.ApproachSiteKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "approachSite", _strong.ApproachSiteKey, context);
                }
            }
            if (context.ShouldSerialize("targetSite")) {
                if ((_strong.TargetSiteKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "targetSite", _strong.TargetSiteKey, context);
                }
            }
            if (context.ShouldSerialize("methodModel")) {
                if ((_strong.Method == null)) {
                    if ((_strong.MethodKey.HasValue && context.ShouldForceLoad("methodModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Method");
                        if ((_delay != null)) {
                            _strong.Method = _delay;
                            context.JsonContext.WritePropertyUtil(w, "methodModel", _strong.Method, context);
                        }
                        else {
                            context.RegisterMissTarget("methodModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "methodModel", _strong.Method, context);
                }
            }
            if (context.ShouldSerialize("approachSiteModel")) {
                if ((_strong.ApproachSite == null)) {
                    if ((_strong.ApproachSiteKey.HasValue && context.ShouldForceLoad("approachSiteModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ApproachSite");
                        if ((_delay != null)) {
                            _strong.ApproachSite = _delay;
                            context.JsonContext.WritePropertyUtil(w, "approachSiteModel", _strong.ApproachSite, context);
                        }
                        else {
                            context.RegisterMissTarget("approachSiteModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "approachSiteModel", _strong.ApproachSite, context);
                }
            }
            if (context.ShouldSerialize("targetSiteModel")) {
                if ((_strong.TargetSite == null)) {
                    if ((_strong.TargetSiteKey.HasValue && context.ShouldForceLoad("targetSiteModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TargetSite");
                        if ((_delay != null)) {
                            _strong.TargetSite = _delay;
                            context.JsonContext.WritePropertyUtil(w, "targetSiteModel", _strong.TargetSite, context);
                        }
                        else {
                            context.RegisterMissTarget("targetSiteModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "targetSiteModel", _strong.TargetSite, context);
                }
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.Procedure _retVal = new SanteDB.Core.Model.Acts.Procedure();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.Procedure))) {
                        return ((SanteDB.Core.Model.Acts.Procedure)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "method":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("method", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MethodKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "approachSite":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("approachSite", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ApproachSiteKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "targetSite":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("targetSite", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TargetSiteKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "methodModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("methodModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Method = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "approachSiteModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("approachSiteModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ApproachSite = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "targetSiteModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("targetSiteModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TargetSite = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.Protocol"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class ProtocolViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.Protocol);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.Protocol _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.Protocol)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.Protocol)), e);
            }
            if (context.ShouldSerialize("name")) {
                if ((_strong.Name == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "name", _strong.Name, context);
                }
            }
            if (context.ShouldSerialize("oid")) {
                if ((_strong.Oid == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "oid", _strong.Oid, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.Protocol _retVal = new SanteDB.Core.Model.Acts.Protocol();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.Protocol))) {
                        return ((SanteDB.Core.Model.Acts.Protocol)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "name":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("name", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Name = ((string)(_instance));
                    }
                    break;
case "oid":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("oid", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Oid = ((string)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
    
    /// <summary>Serializes <see cref="SanteDB.Core.Model.Acts.SubstanceAdministration"/> to or from JSON View Model Format</summary>
    [System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute()]
    public class SubstanceAdministrationViewModelSerializer : SanteDB.Core.ViewModel.Json.IJsonViewModelTypeFormatter {
        
        /// <inheritdoc/>
        private SanteDB.Core.Model.Serialization.ModelSerializationBinder m_binder = new SanteDB.Core.Model.Serialization.ModelSerializationBinder();
        
        /// <inheritdoc/>
        public System.Type HandlesType {
            get {
                return typeof(SanteDB.Core.Model.Acts.SubstanceAdministration);
            }
        }
        
        /// <inheritdoc/>
        public void Serialize(Newtonsoft.Json.JsonWriter w, object o, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            if ((o == null)) {
                throw new System.ArgumentNullException("o");
            }
            SanteDB.Core.Model.Acts.SubstanceAdministration _strong = null;
            try {
                _strong = ((SanteDB.Core.Model.Acts.SubstanceAdministration)(o));
            }
            catch (System.Exception e) {
                throw new System.ArgumentException(string.Format("Invalid type {0} provided, expected {1}", o.GetType(), typeof(SanteDB.Core.Model.Acts.SubstanceAdministration)), e);
            }
            if (context.ShouldSerialize("route")) {
                if ((_strong.RouteKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "route", _strong.RouteKey, context);
                }
            }
            if (context.ShouldSerialize("doseUnit")) {
                if ((_strong.DoseUnitKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "doseUnit", _strong.DoseUnitKey, context);
                }
            }
            if (context.ShouldSerialize("routeModel")) {
                if ((_strong.Route == null)) {
                    if ((_strong.RouteKey.HasValue && context.ShouldForceLoad("routeModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Route");
                        if ((_delay != null)) {
                            _strong.Route = _delay;
                            context.JsonContext.WritePropertyUtil(w, "routeModel", _strong.Route, context);
                        }
                        else {
                            context.RegisterMissTarget("routeModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "routeModel", _strong.Route, context);
                }
            }
            if (context.ShouldSerialize("doseUnitModel")) {
                if ((_strong.DoseUnit == null)) {
                    if ((_strong.DoseUnitKey.HasValue && context.ShouldForceLoad("doseUnitModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "DoseUnit");
                        if ((_delay != null)) {
                            _strong.DoseUnit = _delay;
                            context.JsonContext.WritePropertyUtil(w, "doseUnitModel", _strong.DoseUnit, context);
                        }
                        else {
                            context.RegisterMissTarget("doseUnitModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "doseUnitModel", _strong.DoseUnit, context);
                }
            }
            if (context.ShouldSerialize("doseQuantity")) {
                context.JsonContext.WritePropertyUtil(w, "doseQuantity", _strong.DoseQuantity, context);
            }
            if (context.ShouldSerialize("doseSequence")) {
                if ((_strong.SequenceId == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "doseSequence", _strong.SequenceId, context);
                }
            }
            if (context.ShouldSerialize("site")) {
                if ((_strong.SiteKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "site", _strong.SiteKey, context);
                }
            }
            if (context.ShouldSerialize("siteModel")) {
                if ((_strong.Site == null)) {
                    if ((_strong.SiteKey.HasValue && context.ShouldForceLoad("siteModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "Site");
                        if ((_delay != null)) {
                            _strong.Site = _delay;
                            context.JsonContext.WritePropertyUtil(w, "siteModel", _strong.Site, context);
                        }
                        else {
                            context.RegisterMissTarget("siteModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "siteModel", _strong.Site, context);
                }
            }
            if (context.ShouldSerialize("isNegated")) {
                context.JsonContext.WritePropertyUtil(w, "isNegated", _strong.IsNegated, context);
            }
            if (context.ShouldSerialize("template")) {
                if ((_strong.TemplateKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "template", _strong.TemplateKey, context);
                }
            }
            if (context.ShouldSerialize("templateModel")) {
                if ((_strong.Template == null)) {
                    if ((_strong.TemplateKey.HasValue && context.ShouldForceLoad("templateModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.TemplateDefinition _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.TemplateDefinition>(_strong, "Template");
                        if ((_delay != null)) {
                            _strong.Template = _delay;
                            context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                        }
                        else {
                            context.RegisterMissTarget("templateModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "templateModel", _strong.Template, context);
                }
            }
            if (context.ShouldSerialize("actTime")) {
                if ((_strong.ActTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "actTime", _strong.ActTimeXml, context);
                }
            }
            if (context.ShouldSerialize("startTime")) {
                if ((_strong.StartTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "startTime", _strong.StartTimeXml, context);
                }
            }
            if (context.ShouldSerialize("stopTime")) {
                if ((_strong.StopTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "stopTime", _strong.StopTimeXml, context);
                }
            }
            if (context.ShouldSerialize("classConcept")) {
                if ((_strong.ClassConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConcept", _strong.ClassConceptKey, context);
                }
            }
            if (context.ShouldSerialize("moodConcept")) {
                if ((_strong.MoodConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConcept", _strong.MoodConceptKey, context);
                }
            }
            if (context.ShouldSerialize("reasonConcept")) {
                if ((_strong.ReasonConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConcept", _strong.ReasonConceptKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReason")) {
                if ((_strong.ObsoletionReasonKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReason", _strong.ObsoletionReasonKey, context);
                }
            }
            if (context.ShouldSerialize("statusConcept")) {
                if ((_strong.StatusConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConcept", _strong.StatusConceptKey, context);
                }
            }
            if (context.ShouldSerialize("typeConcept")) {
                if ((_strong.TypeConceptKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConcept", _strong.TypeConceptKey, context);
                }
            }
            if (context.ShouldSerialize("classConceptModel")) {
                if ((_strong.ClassConcept == null)) {
                    if ((_strong.ClassConceptKey.HasValue && context.ShouldForceLoad("classConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ClassConcept");
                        if ((_delay != null)) {
                            _strong.ClassConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("classConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "classConceptModel", _strong.ClassConcept, context);
                }
            }
            if (context.ShouldSerialize("moodConceptModel")) {
                if ((_strong.MoodConcept == null)) {
                    if ((_strong.MoodConceptKey.HasValue && context.ShouldForceLoad("moodConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "MoodConcept");
                        if ((_delay != null)) {
                            _strong.MoodConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("moodConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "moodConceptModel", _strong.MoodConcept, context);
                }
            }
            if (context.ShouldSerialize("reasonConceptModel")) {
                if ((_strong.ReasonConcept == null)) {
                    if ((_strong.ReasonConceptKey.HasValue && context.ShouldForceLoad("reasonConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ReasonConcept");
                        if ((_delay != null)) {
                            _strong.ReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("reasonConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "reasonConceptModel", _strong.ReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("obsoletionReasonModel")) {
                if ((_strong.ObsoletionReasonConcept == null)) {
                    if ((_strong.ObsoletionReasonKey.HasValue && context.ShouldForceLoad("obsoletionReasonModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "ObsoletionReasonConcept");
                        if ((_delay != null)) {
                            _strong.ObsoletionReasonConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletionReasonModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionReasonModel", _strong.ObsoletionReasonConcept, context);
                }
            }
            if (context.ShouldSerialize("statusConceptModel")) {
                if ((_strong.StatusConcept == null)) {
                    if ((_strong.StatusConceptKey.HasValue && context.ShouldForceLoad("statusConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "StatusConcept");
                        if ((_delay != null)) {
                            _strong.StatusConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("statusConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "statusConceptModel", _strong.StatusConcept, context);
                }
            }
            if (context.ShouldSerialize("typeConceptModel")) {
                if ((_strong.TypeConcept == null)) {
                    if ((_strong.TypeConceptKey.HasValue && context.ShouldForceLoad("typeConceptModel", _strong.Key))) {
                        SanteDB.Core.Model.DataTypes.Concept _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.DataTypes.Concept>(_strong, "TypeConcept");
                        if ((_delay != null)) {
                            _strong.TypeConcept = _delay;
                            context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                        }
                        else {
                            context.RegisterMissTarget("typeConceptModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "typeConceptModel", _strong.TypeConcept, context);
                }
            }
            if (context.ShouldSerialize("identifier")) {
                if (((_strong.Identifiers == null) 
                            || (_strong.Identifiers.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("identifier", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActIdentifier>(_strong, "Identifiers"));
                        if ((_delay.Count > 0)) {
                            _strong.Identifiers = _delay;
                            context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                        }
                        else {
                            context.RegisterMissTarget("identifier", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "identifier", _strong.Identifiers, context);
                }
            }
            if (context.ShouldSerialize("relationship")) {
                if (((_strong.Relationships == null) 
                            || (_strong.Relationships.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("relationship", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActRelationship>(_strong, "Relationships"));
                        if ((_delay.Count > 0)) {
                            _strong.Relationships = _delay;
                            context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                        }
                        else {
                            context.RegisterMissTarget("relationship", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "relationship", _strong.Relationships, context);
                }
            }
            if (context.ShouldSerialize("policy")) {
                if (((_strong.Policies == null) 
                            || (_strong.Policies.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("policy", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Security.SecurityPolicyInstance>(_strong, "Policies"));
                        if ((_delay.Count > 0)) {
                            _strong.Policies = _delay;
                            context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                        }
                        else {
                            context.RegisterMissTarget("policy", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "policy", _strong.Policies, context);
                }
            }
            if (context.ShouldSerialize("extension")) {
                if (((_strong.Extensions == null) 
                            || (_strong.Extensions.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("extension", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActExtension>(_strong, "Extensions"));
                        if ((_delay.Count > 0)) {
                            _strong.Extensions = _delay;
                            context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                        }
                        else {
                            context.RegisterMissTarget("extension", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "extension", _strong.Extensions, context);
                }
            }
            if (context.ShouldSerialize("note")) {
                if (((_strong.Notes == null) 
                            || (_strong.Notes.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("note", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActNote>(_strong, "Notes"));
                        if ((_delay.Count > 0)) {
                            _strong.Notes = _delay;
                            context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                        }
                        else {
                            context.RegisterMissTarget("note", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "note", _strong.Notes, context);
                }
            }
            if (context.ShouldSerialize("tag")) {
                if (((_strong.Tags == null) 
                            || (_strong.Tags.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("tag", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.DataTypes.ActTag>(_strong, "Tags"));
                        if ((_delay.Count > 0)) {
                            _strong.Tags = _delay;
                            context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                        }
                        else {
                            context.RegisterMissTarget("tag", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "tag", _strong.Tags, context);
                }
            }
            if (context.ShouldSerialize("protocol")) {
                if (((_strong.Protocols == null) 
                            || (_strong.Protocols.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("protocol", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActProtocol>(_strong, "Protocols"));
                        if ((_delay.Count > 0)) {
                            _strong.Protocols = _delay;
                            context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                        }
                        else {
                            context.RegisterMissTarget("protocol", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "protocol", _strong.Protocols, context);
                }
            }
            if (context.ShouldSerialize("participation")) {
                if (((_strong.Participations == null) 
                            || (_strong.Participations.Count == 0))) {
                    if ((_strong.Key.HasValue && context.ShouldForceLoad("participation", _strong.Key.Value))) {
                        System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation> _delay = null;
                        _delay = System.Linq.Enumerable.ToList(SanteDB.ExtensionMethods.LoadCollection<SanteDB.Core.Model.Acts.ActParticipation>(_strong, "Participations"));
                        if ((_delay.Count > 0)) {
                            _strong.Participations = _delay;
                            context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                        }
                        else {
                            context.RegisterMissTarget("participation", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "participation", _strong.Participations, context);
                }
            }
            if (context.ShouldSerialize("geo")) {
                if ((_strong.GeoTag == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "geo", _strong.GeoTag, context);
                }
            }
            if (context.ShouldSerialize("previousVersion")) {
                if ((_strong.PreviousVersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "previousVersion", _strong.PreviousVersionKey, context);
                }
            }
            if (context.ShouldSerialize("version")) {
                if ((_strong.VersionKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "version", _strong.VersionKey, context);
                }
            }
            if (context.ShouldSerialize("sequence")) {
                if ((_strong.VersionSequence == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "sequence", _strong.VersionSequence, context);
                }
            }
            if (context.ShouldSerialize("creationTimeModel")) {
                context.JsonContext.WritePropertyUtil(w, "creationTimeModel", _strong.CreationTime, context);
            }
            if (context.ShouldSerialize("creationTime")) {
                if ((_strong.CreationTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "creationTime", _strong.CreationTimeXml, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTimeModel")) {
                if ((_strong.ObsoletionTime == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTimeModel", _strong.ObsoletionTime, context);
                }
            }
            if (context.ShouldSerialize("obsoletionTime")) {
                if ((_strong.ObsoletionTimeXml == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletionTime", _strong.ObsoletionTimeXml, context);
                }
            }
            if (context.ShouldSerialize("createdByModel")) {
                if ((_strong.CreatedBy == null)) {
                    if ((_strong.CreatedByKey.HasValue && context.ShouldForceLoad("createdByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "CreatedBy");
                        if ((_delay != null)) {
                            _strong.CreatedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("createdByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdByModel", _strong.CreatedBy, context);
                }
            }
            if (context.ShouldSerialize("obsoletedByModel")) {
                if ((_strong.ObsoletedBy == null)) {
                    if ((_strong.ObsoletedByKey.HasValue && context.ShouldForceLoad("obsoletedByModel", _strong.Key))) {
                        SanteDB.Core.Model.Security.SecurityProvenance _delay = null;
                        _delay = SanteDB.ExtensionMethods.LoadProperty<SanteDB.Core.Model.Security.SecurityProvenance>(_strong, "ObsoletedBy");
                        if ((_delay != null)) {
                            _strong.ObsoletedBy = _delay;
                            context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                        }
                        else {
                            context.RegisterMissTarget("obsoletedByModel", _strong.Key.GetValueOrDefault());
                        }
                    }
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedByModel", _strong.ObsoletedBy, context);
                }
            }
            if (context.ShouldSerialize("createdBy")) {
                if ((_strong.CreatedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "createdBy", _strong.CreatedByKey, context);
                }
            }
            if (context.ShouldSerialize("obsoletedBy")) {
                if ((_strong.ObsoletedByKey == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "obsoletedBy", _strong.ObsoletedByKey, context);
                }
            }
            if (context.ShouldSerialize("id")) {
                if ((_strong.Key == null)) {
                }
                else {
                    context.JsonContext.WritePropertyUtil(w, "id", _strong.Key, context);
                }
            }
            if (context.ShouldSerialize("operation")) {
                context.JsonContext.WritePropertyUtil(w, "operation", _strong.BatchOperation, context);
            }
        }
        
        /// <inheritdoc/>
        public object Deserialize(Newtonsoft.Json.JsonReader r, System.Type asType, SanteDB.Core.ViewModel.Json.JsonSerializationContext context) {
            SanteDB.Core.Model.Acts.SubstanceAdministration _retVal = new SanteDB.Core.Model.Acts.SubstanceAdministration();
            int _depth = r.Depth;
            if ((r.TokenType != Newtonsoft.Json.JsonToken.StartObject)) {
                _depth = (_depth - 1);
            }
            object _instance = null;
            for (
            ; r.Read(); 
            ) {
                if ((r.TokenType == Newtonsoft.Json.JsonToken.PropertyName)) {
switch (r.Value) {
case "$type":
                    System.Type _type = this.m_binder.BindToType("SanteDB.Core.Model, Version=3.0.2035.0, Culture=neutral, PublicKeyToken=null", r.ReadAsString());
                    if ((_type != typeof(SanteDB.Core.Model.Acts.SubstanceAdministration))) {
                        return ((SanteDB.Core.Model.Acts.SubstanceAdministration)(context.JsonContext.GetFormatter(_type).Deserialize(r, _type, context)));
                    }
                    break;
case "route":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("route", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.RouteKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "doseUnit":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("doseUnit", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DoseUnitKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "routeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("routeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Route = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "doseUnitModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("doseUnitModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DoseUnit = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "doseQuantity":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(decimal), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("doseQuantity", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.DoseQuantity = ((decimal)(_instance));
                    }
                    break;
case "doseSequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<int>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("doseSequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SequenceId = ((System.Nullable<int>)(_instance));
                    }
                    break;
case "site":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("site", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.SiteKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "siteModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("siteModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Site = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "isNegated":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(bool), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("isNegated", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.IsNegated = ((bool)(_instance));
                    }
                    break;
case "template":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("template", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TemplateKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "templateModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.TemplateDefinition), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("templateModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Template = ((SanteDB.Core.Model.DataTypes.TemplateDefinition)(_instance));
                    }
                    break;
case "actTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("actTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ActTimeXml = ((string)(_instance));
                    }
                    break;
case "startTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("startTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StartTimeXml = ((string)(_instance));
                    }
                    break;
case "stopTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("stopTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StopTimeXml = ((string)(_instance));
                    }
                    break;
case "classConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "moodConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "reasonConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletionReason":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReason", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "statusConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "typeConcept":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConcept", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConceptKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "classConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("classConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ClassConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "moodConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("moodConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.MoodConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "reasonConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("reasonConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "obsoletionReasonModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionReasonModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionReasonConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "statusConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("statusConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.StatusConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "typeConceptModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.Concept), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("typeConceptModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.TypeConcept = ((SanteDB.Core.Model.DataTypes.Concept)(_instance));
                    }
                    break;
case "identifier":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("identifier", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Identifiers = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActIdentifier>)(_instance));
                    }
                    break;
case "relationship":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("relationship", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Relationships = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActRelationship>)(_instance));
                    }
                    break;
case "policy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("policy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Policies = ((System.Collections.Generic.List<SanteDB.Core.Model.Security.SecurityPolicyInstance>)(_instance));
                    }
                    break;
case "extension":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("extension", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Extensions = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActExtension>)(_instance));
                    }
                    break;
case "note":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("note", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Notes = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActNote>)(_instance));
                    }
                    break;
case "tag":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("tag", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Tags = ((System.Collections.Generic.List<SanteDB.Core.Model.DataTypes.ActTag>)(_instance));
                    }
                    break;
case "protocol":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("protocol", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Protocols = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActProtocol>)(_instance));
                    }
                    break;
case "participation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("participation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Participations = ((System.Collections.Generic.List<SanteDB.Core.Model.Acts.ActParticipation>)(_instance));
                    }
                    break;
case "geo":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.GeoTag), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("geo", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.GeoTag = ((SanteDB.Core.Model.DataTypes.GeoTag)(_instance));
                    }
                    break;
case "previousVersion":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("previousVersion", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.PreviousVersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "version":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("version", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "sequence":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<long>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("sequence", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.VersionSequence = ((System.Nullable<long>)(_instance));
                    }
                    break;
case "creationTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.DateTimeOffset), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTime = ((System.DateTimeOffset)(_instance));
                    }
                    break;
case "creationTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("creationTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreationTimeXml = ((string)(_instance));
                    }
                    break;
case "obsoletionTimeModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.DateTimeOffset>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTimeModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTime = ((System.Nullable<System.DateTimeOffset>)(_instance));
                    }
                    break;
case "obsoletionTime":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(string), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletionTime", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletionTimeXml = ((string)(_instance));
                    }
                    break;
case "createdByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "obsoletedByModel":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.Security.SecurityProvenance), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedByModel", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedBy = ((SanteDB.Core.Model.Security.SecurityProvenance)(_instance));
                    }
                    break;
case "createdBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("createdBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.CreatedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "obsoletedBy":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("obsoletedBy", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.ObsoletedByKey = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "id":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(System.Nullable<System.Guid>), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("id", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.Key = ((System.Nullable<System.Guid>)(_instance));
                    }
                    break;
case "operation":
                    r.Read();
                    _instance = context.JsonContext.ReadElementUtil(r, typeof(SanteDB.Core.Model.DataTypes.BatchOperationType), new SanteDB.Core.ViewModel.Json.JsonSerializationContext("operation", context.JsonContext, _retVal, context));
                    if ((_instance != null)) {
                        _retVal.BatchOperation = ((SanteDB.Core.Model.DataTypes.BatchOperationType)(_instance));
                    }
                    break;
default:
                    r.Skip();
                    break;
}
                }
                else {
                    if (((r.TokenType == Newtonsoft.Json.JsonToken.EndObject) 
                                && (r.Depth == _depth))) {
                        return _retVal;
                    }
                    else {
                        throw new Newtonsoft.Json.JsonSerializationException("JSON in invalid state");
                    }
                }
            }
            return _retVal;
        }
        
        /// <inheritdoc/>
        public object FromSimpleValue(object o) {
            return null;
        }
        
        /// <inheritdoc/>
        public object GetSimpleValue(object o) {
            return null;
        }
    }
}
